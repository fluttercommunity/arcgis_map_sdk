"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[7519],{7505:(e,t,i)=>{i.d(t,{G6:()=>V,Ie:()=>v,J9:()=>b,RF:()=>g,U1:()=>x,vY:()=>o,ym:()=>y});var n=i(61681),s=i(53736);const a=(e,t,i)=>[t,i],r=(e,t,i)=>[t,i,e[2]],l=(e,t,i)=>[t,i,e[2],e[3]];function o(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,n.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function u({scale:e,translate:t},i){return Math.round((i-t[0])/e[0])}function c({scale:e,translate:t},i){return Math.round((t[1]-i)/e[1])}function d(e,t,i){const n=[];let s,a,r,l;for(let o=0;o<i.length;o++){const d=i[o];o>0?(r=u(e,d[0]),l=c(e,d[1]),r===s&&l===a||(n.push(t(d,r-s,l-a)),s=r,a=l)):(s=u(e,d[0]),a=c(e,d[1]),n.push(t(d,s,a)))}return n.length>0?n:null}function f({scale:e,translate:t},i){return i*e[0]+t[0]}function h({scale:e,translate:t},i){return t[1]-i*e[1]}function m(e,t,i){const n=new Array(i.length);if(!i.length)return n;const[s,a]=e.scale;let r=f(e,i[0][0]),l=h(e,i[0][1]);n[0]=t(i[0],r,l);for(let e=1;e<i.length;e++){const o=i[e];r+=o[0]*s,l-=o[1]*a,n[e]=t(o,r,l)}return n}function p(e,t,i){const n=new Array(i.length);for(let s=0;s<i.length;s++)n[s]=m(e,t,i[s]);return n}function g(e,t,i,n,s){return t.x=u(e,i.x),t.y=c(e,i.y),t!==i&&(n&&(t.z=i.z),s&&(t.m=i.m)),t}function y(e,t){return e&&t?(0,s.wp)(t)?g(e,{},t,!1,!1):(0,s.l9)(t)?function(e,t,i,n,s){const o=function(e,t,i,n){const s=[],o=i?n?l:r:n?r:a;for(let i=0;i<t.length;i++){const n=d(e,o,t[i]);n&&n.length>=2&&s.push(n)}return s.length?s:null}(e,i.paths,n,s);return o?(t.paths=o,t):null}(e,{},t,!1,!1):(0,s.oU)(t)?function(e,t,i,n,s){const o=function(e,t,i,n){const s=[],o=i?n?l:r:n?r:a;for(let i=0;i<t.length;i++){const n=d(e,o,t[i]);n&&n.length>=3&&s.push(n)}return s.length?s:null}(e,i.rings,n,s);return o?(t.rings=o,t):null}(e,{},t,!1,!1):(0,s.aW)(t)?function(e,t,i,n,s){return t.points=function(e,t,i,n){return d(e,i?n?l:r:n?r:a,t)}(e,i.points,n,s),t}(e,{},t,!1,!1):(0,s.YX)(t)?function(e,t,i,n,s){return t.xmin=u(e,i.xmin),t.ymin=c(e,i.ymin),t.xmax=u(e,i.xmax),t.ymax=c(e,i.ymax),t}(e,{},t):null:null}function b(e,t,i,s,o){return(0,n.pC)(i)&&(t.points=function(e,t,i,n){return m(e,i?n?l:r:n?r:a,t)}(e,i.points,s,o)),t}function x(e,t,i,s,a){return(0,n.Wi)(i)||(t.x=f(e,i.x),t.y=h(e,i.y),t!==i&&(s&&(t.z=i.z),a&&(t.m=i.m))),t}function v(e,t,i,s,o){return(0,n.pC)(i)&&(t.rings=function(e,t,i,n){return p(e,i?n?l:r:n?r:a,t)}(e,i.rings,s,o)),t}function V(e,t,i,s,o){return(0,n.pC)(i)&&(t.paths=function(e,t,i,n){return p(e,i?n?l:r:n?r:a,t)}(e,i.paths,s,o)),t}},17519:(e,t,i)=>{i.d(t,{y:()=>y,r:()=>d});var n=i(61681),s=i(18449),a=i(50842),r=i(7505),l=i(35925),o=i(95574),u=i(46479);class c{constructor(e,t,i){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=i,this.featureAdapter=t;const n=e.outFields;if(n&&!n.includes("*")){this.outFields=n;let e=0;for(const t of n){const n=(0,o.hr)(t),s=this.fieldsIndex.get(n),a=s?null:(0,o.Jc)(n,i),r=s?s.name:(0,o.nu)(t)||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:r,clause:a})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach((e=>this.getAttributes(e))),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,i){const n=i?i.name:t;let s=null;return this._fieldDataCache.has(n)?s=this._fieldDataCache.get(n).clause:i||(s=(0,o.Jc)(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:s})),i?this.featureAdapter.getAttribute(e,n):s.calculateValue(e,this.featureAdapter)}getNormalizedValue(e,t){const i=t.normalizationType,n=t.normalizationTotal;let s=this.getFieldValue(e,t.field,t.fieldInfo);if(i&&Number.isFinite(s)){const a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);s=(0,u.fk)(s,i,a,n)}return s}getExpressionValue(e,t,i,n){const s={attributes:this.featureAdapter.getAttributes(e),layer:{fields:this.fieldsIndex.fields}},a=n.createExecContext(s,i);return n.executeFunction(t,a)}getExpressionValues(e,t,i,n){const s={fields:this.fieldsIndex.fields};return e.map((e=>{const a={attributes:this.featureAdapter.getAttributes(e),layer:s},r=n.createExecContext(a,i);return n.executeFunction(t,r)}))}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:(0,o.Jc)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:(0,o.Jc)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const i={};for(const n of t){const{alias:t,clause:s}=this._fieldDataCache.get(n);i[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return i}_processAttributesForDistinctValues(e){if((0,n.Wi)(e)||!this.returnDistinctValues)return e;const t=this.outFields,i=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);i.push(e[t])}else for(const t in e)i.push(e[t]);const s=`${(t||["*"]).join(",")}=${i.join(",")}`;let a=this._returnDistinctMap.get(s)||0;return this._returnDistinctMap.set(s,++a),a>1?null:e}}var d,f,h=i(66069),m=i(34398),p=i(17095),g=i(30879);class y{constructor(e,t,i){this.items=e,this.query=t,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.fieldsIndex=i.fieldsIndex,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.featureAdapter=i.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new c(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:i,outStatistics:n}=this.query,s=t?.length;if(!s)return 1;const a=new Map,r=new Map,l=new Set;for(const s of n){const{statisticType:n}=s,o="exceedslimit"!==n?s.onStatisticField:void 0;if(!r.has(o)){const i=[];for(const n of t){const t=this._getAttributeValues(e,n,a);i.push(t)}r.set(o,this._calculateUniqueValues(i,e.returnDistinctValues))}const u=r.get(o);for(const t in u){const{data:n,items:s}=u[t],a=n.join(",");i&&!e.validateItems(s,i)||l.add(a)}}return l.size}async createQueryResponse(){let e;return e=this.query.outStatistics?this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query),this.query.returnQueryGeometry&&((0,l.JY)(this.query.outSR)&&!(0,l.fS)(this.query.geometry.spatialReference,this.query.outSR)?e.queryGeometry=(0,m.S2)({spatialReference:this.query.outSR,...(0,h.iV)(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR)}):e.queryGeometry=(0,m.S2)({spatialReference:this.query.outSR,...this.query.geometry})),e}createSnappingResponse(e,t){const i=this.featureAdapter,s=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:a,y:r}=e.point,l="number"==typeof e.distance?e.distance:e.distance.x,o="number"==typeof e.distance?e.distance:e.distance.y,u={candidates:[]},c="esriGeometryPolygon"===this.geometryType,f=this._getPointCreator(e.point,this.spatialReference,t);for(const t of this.items){const h=i.getGeometry(t);if((0,n.Wi)(h))continue;const{coords:m,lengths:p}=h;if(e.types&d.EDGE){let e=0;for(let n=0;n<p.length;n++){const c=p[n];for(let n=0;n<c;n++,e+=s){const d=m[e],h=m[e+1];if(n!==c-1){const n=m[e+s],c=m[e+s+1],{x:p,y:g}=b(a,r,d,h,n,c),y=(a-p)/l,x=(r-g)/o,v=y*y+x*x;v<=1&&u.candidates.push({type:"edge",objectId:i.getObjectId(t),distance:Math.sqrt(v),target:f(p,g),start:f(d,h),end:f(n,c)})}}}}if(e.types&d.VERTEX){const e=c?m.length-s:m.length;for(let n=0;n<e;n+=s){const e=m[n],s=m[n+1],c=(a-e)/l,d=(r-s)/o,h=c*c+d*d;h<=1&&u.candidates.push({type:"vertex",objectId:i.getObjectId(t),distance:Math.sqrt(h),target:f(e,s)})}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}_getPointCreator(e,t,i){const s=(0,n.pC)(i)&&!(0,l.fS)(t,i)?e=>(0,h.iV)(e,t,i):e=>e;return null!=e.z&&null!=e.m?(t,i)=>s({x:t,y:i,z:e.z,m:e.m}):null!=e.z?(t,i)=>s({x:t,y:i,z:e.z}):null!=e.m?(t,i)=>s({x:t,y:i,m:e.m}):(e,t)=>s({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:a,minValue:r,maxValue:l,scale:o}=e,c=this.fieldsIndex.isDateField(t),d=await this._getDataValues({field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:a,scale:o}),f=(0,u.S5)({normalizationType:s,normalizationField:n,minValue:r,maxValue:l}),h=this.fieldsIndex.get(t),m={value:.5,fieldType:h?.type},g=(0,p.qN)(h)?(0,u.H0)({values:d,supportsNullCount:f,percentileParams:m}):(0,u.i5)({values:d,minValue:r,maxValue:l,useSampleStdDev:!s,supportsNullCount:f,percentileParams:m});return(0,u.F_)(g,c)}async createUniqueValuesResponse(e){const{field:t,valueExpression:i,domain:n,returnAllCodedValues:s,scale:a}=e,r=await this._getDataValues({field:t,valueExpression:i,scale:a}),l=(0,u.eT)(r);return(0,u.Qm)(l,n,s)}async createClassBreaksResponse(e){const{field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:l,minValue:o,maxValue:c,numClasses:d,scale:f}=e,h=await this._getDataValues({field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:a,scale:f}),m=(0,u.G2)(h,{field:t,normalizationField:n,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:l,minValue:o,maxValue:c,numClasses:d});return(0,u.DL)(m,r)}async createHistogramResponse(e){const{field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:l,minValue:o,maxValue:c,numBins:d,scale:f}=e,h=await this._getDataValues({field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:a,scale:f});return(0,u.oF)(h,{field:t,normalizationField:n,normalizationType:s,normalizationTotal:a,classificationMethod:r,standardDeviationInterval:l,minValue:o,maxValue:c,numBins:d})}_sortFeatures(e,t,i){if(e.length>1&&t&&t.length)for(const n of t.reverse()){const t=n.split(" "),s=t[0],a=this.fieldsIndex.get(s),r=t[1]&&"desc"===t[1].toLowerCase(),l=(0,u.Lq)(a?.type,r);e.sort(((e,t)=>{const n=i(e,s,a),r=i(t,s,a);return l(n,r)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:i,hasM:n,hasZ:s,objectIdField:a,spatialReference:l}=this,{outFields:o,outSR:u,quantizationParameters:c,resultRecordCount:d,resultOffset:f,returnZ:h,returnM:p}=e,g=null!=d&&t.length>(f||0)+d,y=o&&(o.includes("*")?[...this.fieldsIndex.fields]:o.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:g,features:this._createFeatures(e,t),fields:y,geometryType:i,hasM:n&&p,hasZ:s&&h,objectIdFieldName:a,spatialReference:(0,m.S2)(u||l),transform:c&&(0,r.vY)(c)||null}}_createFeatures(e,t){const i=new c(e,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:s}=this,{orderByFields:a,quantizationParameters:l,returnGeometry:o,returnCentroid:u,maxAllowableOffset:d,resultOffset:f,resultRecordCount:h,returnZ:p=!1,returnM:g=!1}=e,y=s&&p,b=n&&g;let x=[],v=0;const V=[...t];if(this._sortFeatures(V,a,((e,t,n)=>i.getFieldValue(e,t,n))),o||u){const e=(0,r.vY)(l);if(o&&!u)for(const t of V)x[v++]={attributes:i.getAttributes(t),geometry:(0,m.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),d,e,y,b)};else if(!o&&u)for(const t of V)x[v++]={attributes:i.getAttributes(t),centroid:(0,m.EG)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of V)x[v++]={attributes:i.getAttributes(t),centroid:(0,m.EG)(this,this.featureAdapter.getCentroid(t,this),e),geometry:(0,m.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),d,e,y,b)}}else for(const e of V){const t=i.getAttributes(e);t&&(x[v++]={attributes:t})}const F=f||0;if(null!=h){const e=F+h;x=x.slice(F,Math.min(x.length,e))}return x}_createExceedsLimitQueryResponse(e){let t=!1,i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;for(const t of e.outStatistics)if("exceedslimit"===t.statisticType){i=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,s=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,a=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>i;else if(this.items.length>s)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,i=this.featureAdapter;t=this.items.reduce(((e,t)=>{const s=i.getGeometry(t);return e+((0,n.pC)(s)&&s.coords.length||0)}),0)/e>a}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},i=[],n=new Map,s=new Map,a=new Map,r=new Map,l=new c(e,this.featureAdapter,this.fieldsIndex),o=e.outStatistics,{groupByFieldsForStatistics:u,having:d,orderByFields:f}=e,h=u&&u.length,m=!!h,p=m&&u[0],g=m&&!this.fieldsIndex.get(p);for(const e of o){const{outStatisticFieldName:o,statisticType:c}=e,f=e,y="exceedslimit"!==c?e.onStatisticField:void 0,b="percentile_disc"===c||"percentile_cont"===c,x="EnvelopeAggregate"===c||"CentroidAggregate"===c||"ConvexHullAggregate"===c,v=m&&1===h&&(y===p||g)&&"count"===c;if(m){if(!a.has(y)){const e=[];for(const t of u){const i=this._getAttributeValues(l,t,n);e.push(i)}a.set(y,this._calculateUniqueValues(e,l.returnDistinctValues))}const e=a.get(y);for(const t in e){const{count:i,data:s,items:a,itemPositions:c}=e[t],h=s.join(",");if(!d||l.validateItems(a,d)){const e=r.get(h)||{attributes:{}};if(x){e.aggregateGeometries||(e.aggregateGeometries={});const{aggregateGeometries:t,outStatisticFieldName:i}=await this._getAggregateGeometry(f,a);e.aggregateGeometries[i]=t}else{let t=null;if(v)t=i;else{const e=this._getAttributeValues(l,y,n),i=c.map((t=>e[t]));t=b&&"statisticParameters"in f?this._getPercentileValue(f,i):this._getStatisticValue(f,i,null,l.returnDistinctValues)}e.attributes[o]=t}u.forEach(((t,i)=>e.attributes[this.fieldsIndex.get(t)?t:`EXPR_${i+1}`]=s[i])),r.set(h,e)}}}else if(x){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:i}=await this._getAggregateGeometry(f,this.items);t.aggregateGeometries[i]=e}else{const e=this._getAttributeValues(l,y,n);t.attributes[o]=b&&"statisticParameters"in f?this._getPercentileValue(f,e):this._getStatisticValue(f,e,s,l.returnDistinctValues)}i.push({name:o,alias:o,type:"esriFieldTypeDouble"})}const y=m?Array.from(r.values()):[t];return this._sortFeatures(y,f,((e,t)=>e.attributes[t])),{fields:i,features:y}}async _getAggregateGeometry(e,t){const n=await Promise.all([i.e(9067),i.e(8923)]).then(i.bind(i,8923)),{statisticType:r,outStatisticFieldName:l}=e,{featureAdapter:o,spatialReference:u,geometryType:c,hasZ:d,hasM:f}=this,h=t.map((e=>(0,m.Op)(c,d,f,o.getGeometry(e)))),p=n.convexHull(u,h,!0)[0],g={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===r){const e=p?(0,a._w)(p):(0,a.aO)(n.union(u,h));g.aggregateGeometries={...e,spatialReference:u},g.outStatisticFieldName=l||"extent"}else if("CentroidAggregate"===r){const e=p?(0,s.tO)(p):(0,s.$G)((0,a.aO)(n.union(u,h)));g.aggregateGeometries={x:e[0],y:e[1],spatialReference:u},g.outStatisticFieldName=l||"centroid"}else"ConvexHullAggregate"===r&&(g.aggregateGeometries=p,g.outStatisticFieldName=l||"convexHull");return g}_getStatisticValue(e,t,i,n){const{onStatisticField:s,statisticType:a}=e;let r=null;return r=i?.has(s)?i.get(s):(0,p.qN)(this.fieldsIndex.get(s))?(0,u.H0)({values:t,returnDistinct:n}):(0,u.i5)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(s,r),r["var"===a?"variance":a]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:n,statisticType:s}=e,{value:a,orderBy:r}=n,l=this.fieldsIndex.get(i);return(0,u.XL)(t,{value:a,orderBy:r,fieldType:l?.type,isDiscrete:"percentile_disc"===s})}_getAttributeValues(e,t,i){if(i.has(t))return i.get(t);const n=this.fieldsIndex.get(t),s=this.items.map((i=>e.getFieldValue(i,t,n)));return i.set(t,s),s}_getAttributeNormalizedValues(e,t){return this.items.map((i=>e.getNormalizedValue(i,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,i){const{arcadeUtils:n}=await(0,g.LC)(),s=n.createFunction(t),a=i&&n.getViewInfo(i);return e.getExpressionValues(this.items,s,a,n)}_calculateUniqueValues(e,t){const i={},n=this.items,s=n.length;for(let a=0;a<s;a++){const s=n[a],r=[];for(const t of e)r.push(t[a]);const l=r.join(",");t?null==i[l]&&(i[l]={count:1,data:r,items:[s],itemPositions:[a]}):null==i[l]?i[l]={count:1,data:r,items:[s],itemPositions:[a]}:(i[l].count++,i[l].items.push(s),i[l].itemPositions.push(a))}return i}async _getDataValues(e){const t=new c(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:i,field:n,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:l}=e,o=i?{viewingMode:"map",scale:l,spatialReference:this.query.outSR||this.spatialReference}:null;return i?this._getAttributeExpressionValues(t,i,o):this._getAttributeNormalizedValues(t,{field:n,normalizationField:s,normalizationType:a,normalizationTotal:r})}}function b(e,t,i,n,s,a){const r=s-i,l=a-n,o=r*r+l*l,u=(e-i)*r+(t-n)*l,c=Math.min(1,Math.max(0,u/o));return{x:i+r*c,y:n+l*c}}(f=d||(d={}))[f.NONE=0]="NONE",f[f.EDGE=1]="EDGE",f[f.VERTEX=2]="VERTEX"},95574:(e,t,i)=>{i.d(t,{nu:()=>p,hr:()=>m,Jc:()=>f,G3:()=>g,Of:()=>h,z4:()=>d,hO:()=>c});var n=i(70375),s=i(77234),a=i(3362);const r=new class{constructor(e,t){this._cache=new s.Z(e),this._invalidCache=new s.Z(t)}get(e,t){const i=`${t.uid}:${e}`,n=this._cache.get(i);if(n)return n;if(void 0!==this._invalidCache.get(i))return null;try{const n=a.WhereClause.create(e,t);return this._cache.put(i,n),n}catch{return this._invalidCache.put(i,null),null}}}(50,500),l="feature-store:unsupported-query",o=" as ",u=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function c(e,t){if(!t)return!0;const i=r.get(t,e);if(!i)throw new n.Z(l,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new n.Z(l,"where clause is not standard",{where:t});return h(e,i.fieldNames,"where clause contains missing fields"),!0}function d(e,t,i){if(!t)return!0;const s=r.get(t,e);if(!s)throw new n.Z(l,"invalid SQL expression",{having:t});if(!s.isAggregate)throw new n.Z(l,"having does not contain a valid aggregate function",{having:t});const a=s.fieldNames;if(h(e,a,"having contains missing fields"),!s.getExpressions().every((t=>{const{aggregateType:n,field:s}=t,a=e.has(s)&&e.get(s).name;return i.some((t=>{const{onStatisticField:i,statisticType:s}=t;return(e.has(i)&&e.get(i).name)===a&&s.toLowerCase().trim()===n}))})))throw new n.Z(l,"expressions in having should also exist in outStatistics",{having:t});return!0}function f(e,t){return e?r.get(e,t):null}function h(e,t,i,s=!0){const a=[];for(const i of t)if("*"!==i&&!e.has(i))if(s){const t=m(i);try{const i=f(t,e);if(!i)throw new n.Z(l,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new n.Z(l,"expression is not standard",{clause:i});h(e,i.fieldNames,"expression contains missing fields")}catch(e){const t=e&&e.details;if(t&&(t.clause||t.where))throw e;t&&t.missingFields?a.push(...t.missingFields):a.push(i)}}else a.push(i);if(a.length)throw new n.Z(l,i,{missingFields:a})}function m(e){return e.split(o)[0]}function p(e){return e.split(o)[1]}function g(e,t){const i=t.get(e);return!!i&&!u.has(i.type)}},34398:(e,t,i)=>{i.d(t,{EG:()=>x,Op:()=>v,S2:()=>I,Up:()=>V,j6:()=>F,vF:()=>m});var n=i(25709),s=i(61681),a=i(17321),r=i(50842),l=i(53736),o=i(49756),u=i(35925),c=i(12065),d=i(15540),f=i(66069);const h=new n.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),m=Object.freeze({}),p=new d.Z,g=new d.Z,y=new d.Z,b={esriGeometryPoint:c.fQ,esriGeometryPolyline:c.J6,esriGeometryPolygon:c.eG,esriGeometryMultipoint:c.Iv};function x(e,t,i,n=e.hasZ,a=e.hasM){if((0,s.Wi)(t))return null;const r=e.hasZ&&n,l=e.hasM&&a;if(i){const s=(0,c.Nh)(y,t,e.hasZ,e.hasM,"esriGeometryPoint",i,n,a);return(0,c.fQ)(s,r,l)}return(0,c.fQ)(t,r,l)}function v(e,t,i,n,a,r,l=t,o=i){const u=t&&l,d=i&&o,f=(0,s.pC)(n)?"coords"in n?n:n.geometry:null;if((0,s.Wi)(f))return null;if(a){let n=(0,c.zj)(g,f,t,i,e,a,l,o);return r&&(n=(0,c.Nh)(y,n,u,d,e,r)),b[e](n,u,d)}if(r){const n=(0,c.Nh)(y,f,t,i,e,r,l,o);return b[e](n,u,d)}return(0,c.hY)(p,f,t,i,l,o),b[e](p,u,d)}async function V(e,t,i){const{outFields:n,orderByFields:s,groupByFieldsForStatistics:a,outStatistics:r}=e;if(n)for(let e=0;e<n.length;e++)n[e]=n[e].trim();if(s)for(let e=0;e<s.length;e++)s[e]=s[e].trim();if(a)for(let e=0;e<a.length;e++)a[e]=a[e].trim();if(r)for(let e=0;e<r.length;e++)r[e].onStatisticField&&(r[e].onStatisticField=r[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),F(e,t,i)}async function F(e,t,n){if(!e)return null;let{where:c}=e;if(e.where=c=c&&c.trim(),(!c||/^1 *= *1$/.test(c)||t&&t===c)&&(e.where=null),!e.geometry)return e;let d=await async function(e){const{geometry:t,distance:n,units:s}=e;if(null==n||"vertexAttributes"in t)return t;const r=t.spatialReference,l=s?h.fromJSON(s):(0,a.qE)(r),o=r&&((0,u.sT)(r)||(0,u.sS)(r))?t:await(0,f._W)(r,u.Zn).then((()=>(0,f.iV)(t,u.Zn)));return(await async function(){return(await Promise.all([i.e(9067),i.e(8923)]).then(i.bind(i,8923))).geodesicBuffer}())(o.spatialReference,o,n,l)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;d=(0,r.aO)(d),d.spatialReference=t}e.geometry=d,await(0,f._W)(d.spatialReference,n);const p=(await(0,o.aX)((0,l.im)(d)))[0];if((0,s.Wi)(p))throw m;const g=p.toJSON(),y=await(0,f.iV)(g,g.spatialReference,n);if(!y)throw m;return y.spatialReference=n,e.geometry=y,e}function I(e){return e&&T in e?JSON.parse(JSON.stringify(e,S)):e}const T="_geVersion",S=(e,t)=>e!==T?t:void 0},23230:(e,t,i)=>{i.d(t,{Z:()=>g});var n=i(36663),s=i(25709),a=i(81977),r=(i(7753),i(39994),i(7283),i(40266)),l=i(82064),o=i(81657),u=i(18251);const c=new s.X({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});let d=class extends l.wq{constructor(){super(...arguments),this.baseSymbol=null,this.colorRamp=null,this.type=null}};(0,n._)([(0,a.Cb)({type:u.Z,json:{write:!0}})],d.prototype,"baseSymbol",void 0),(0,n._)([(0,a.Cb)({types:o.V,json:{read:{reader:o.i},write:!0}})],d.prototype,"colorRamp",void 0),(0,n._)([(0,a.Cb)({json:{read:c.read,write:c.write}})],d.prototype,"type",void 0),d=(0,n._)([(0,r.j)("esri.rest.support.ClassificationDefinition")],d);const f=d,h=new s.X({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),m=new s.X({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let p=class extends f{constructor(){super(...arguments),this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null,this.type="class-breaks-definition"}set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}};(0,n._)([(0,a.Cb)({json:{write:!0}})],p.prototype,"breakCount",void 0),(0,n._)([(0,a.Cb)({json:{write:!0}})],p.prototype,"classificationField",void 0),(0,n._)([(0,a.Cb)({type:String,json:{read:h.read,write:h.write}})],p.prototype,"classificationMethod",void 0),(0,n._)([(0,a.Cb)({json:{write:!0}})],p.prototype,"normalizationField",void 0),(0,n._)([(0,a.Cb)({json:{read:m.read,write:m.write}})],p.prototype,"normalizationType",void 0),(0,n._)([(0,a.Cb)({value:null,json:{write:!0}})],p.prototype,"standardDeviationInterval",null),(0,n._)([(0,a.Cb)({value:null,json:{write:!0}})],p.prototype,"definedInterval",null),(0,n._)([(0,a.Cb)()],p.prototype,"type",void 0),p=(0,n._)([(0,r.j)("esri.rest.support.ClassBreaksDefinition")],p);const g=p},46479:(e,t,i)=>{i.d(t,{G2:()=>T,oF:()=>_,XL:()=>g,i5:()=>p,H0:()=>m,eT:()=>V,Qm:()=>F,Lq:()=>y,fk:()=>I,S5:()=>h,F_:()=>v,DL:()=>S});var n=i(23230);function s(e,t){return Number(e.toFixed(t))}function a(e){const t=e.definition,{classificationMethod:i,breakCount:n,normalizationType:a,definedInterval:o}=t,u=[];let c=e.values;if(0===c.length)return[];c=c.sort(((e,t)=>e-t));const d=c[0],f=c[c.length-1];if("equal-interval"===i)if(c.length>=n){const e=(f-d)/n;let t=d;for(let i=1;i<n;i++){const n=s(d+i*e,6);u.push({minValue:t,maxValue:n,label:r(t,n,a)}),t=n}u.push({minValue:t,maxValue:f,label:r(t,f,a)})}else c.forEach((e=>{u.push({minValue:e,maxValue:e,label:r(e,e,a)})}));else if("natural-breaks"===i){const t=function(e){const t=[],i=[];let n=Number.MIN_VALUE,s=1,a=-1;for(let r=0;r<e.length;r++){const l=e[r];l===n?(s++,i[a]=s):null!==l&&(t.push(l),n=l,s=1,i.push(s),a++)}return{uniqueValues:t,valueFrequency:i}}(c),i=e.valueFrequency||t.valueFrequency,o=l(t.uniqueValues,i,n);let h=d;for(let e=1;e<n;e++)if(t.uniqueValues.length>e){const i=s(t.uniqueValues[o[e]],6);u.push({minValue:h,maxValue:i,label:r(h,i,a)}),h=i}u.push({minValue:h,maxValue:f,label:r(h,f,a)})}else if("quantile"===i)if(c.length>=n&&d!==f){let e=d,t=Math.ceil(c.length/n),i=0;for(let s=1;s<n;s++){let l=t+i-1;l>c.length&&(l=c.length-1),l<0&&(l=0),u.push({minValue:e,maxValue:c[l],label:r(e,c[l],a)}),e=c[l],i+=t,t=Math.ceil((c.length-i)/(n-s))}u.push({minValue:e,maxValue:f,label:r(e,f,a)})}else{let e=-1;for(let t=0;t<c.length;t++){const i=c[t];i!==e&&(e=i,u.push({minValue:e,maxValue:i,label:r(e,i,a)}),e=i)}}else if("standard-deviation"===i){const e=function(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t/=e.length,t}(c),t=function(e,t){let i=0;for(let n=0;n<e.length;n++){const s=e[n];i+=(s-t)*(s-t)}return i/=e.length,Math.sqrt(i)}(c,e);if(0===t)u.push({minValue:c[0],maxValue:c[0],label:r(c[0],c[0],a)});else{const i=function(e,t,i,n,s){let a=Math.max(n-e,t-n)/s/i;return a=a>=1?1:a>=.5?.5:.25,a}(d,f,n,e,t)*t;let l=0,o=d;for(let t=n;t>=1;t--){const n=s(e-(t-.5)*i,6);u.push({minValue:o,maxValue:n,label:r(o,n,a)}),o=n,l++}let c=s(e+.5*i,6);u.push({minValue:o,maxValue:c,label:r(o,c,a)}),o=c,l++;for(let t=1;t<=n;t++)c=l===2*n?f:s(e+(t+.5)*i,6),u.push({minValue:o,maxValue:c,label:r(o,c,a)}),o=c,l++}}else if("defined-interval"===i){if(!o)return u;const e=c[0],t=c[c.length-1],i=Math.ceil((t-e)/o);let n=e;for(let t=1;t<i;t++){const i=s(e+t*o,6);u.push({minValue:n,maxValue:i,label:r(n,i,a)}),n=i}u.push({minValue:n,maxValue:t,label:r(n,t,a)})}return u}function r(e,t,i){let n=null;return n=e===t?i&&"percent-of-total"===i?e+"%":e.toString():i&&"percent-of-total"===i?e+"% - "+t+"%":e+" - "+t,n}function l(e,t,i){const n=e.length,s=[];i>n&&(i=n);for(let e=0;e<i;e++)s.push(Math.round(e*n/i-1));s.push(n-1);let a=o(s,e,t,i);return function(e,t,i,n,s,a){let r=0,l=0,o=0,c=0,d=!0;for(let f=0;f<2&&d;f++){0===f&&(d=!1);for(let f=0;f<a-1;f++)for(;i[f+1]+1!==i[f+2];){i[f+1]=i[f+1]+1;const a=u(f,i,n,s);o=a.sbMean,r=a.sbSdcm;const h=u(f+1,i,n,s);if(c=h.sbMean,l=h.sbSdcm,!(r+l<t[f]+t[f+1])){i[f+1]=i[f+1]-1;break}t[f]=r,t[f+1]=l,e[f]=o,e[f+1]=c,d=!0}for(let f=a-1;f>0;f--)for(;i[f]!==i[f-1]+1;){i[f]=i[f]-1;const a=u(f-1,i,n,s);o=a.sbMean,r=a.sbSdcm;const h=u(f,i,n,s);if(c=h.sbMean,l=h.sbSdcm,!(r+l<t[f-1]+t[f])){i[f]=i[f]+1;break}t[f-1]=r,t[f]=l,e[f-1]=o,e[f]=c,d=!0}}return d}(a.mean,a.sdcm,s,e,t,i)&&(a=o(s,e,t,i)),s}function o(e,t,i,n){let s=[],a=[],r=[],l=0;const o=[],c=[];for(let s=0;s<n;s++){const n=u(s,e,t,i);o.push(n.sbMean),c.push(n.sbSdcm),l+=c[s]}let d,f=l,h=!0;for(;h||l<f;){h=!1,s=[];for(let t=0;t<n;t++)s.push(e[t]);for(let i=0;i<n;i++)for(let s=e[i]+1;s<=e[i+1];s++)if(d=t[s],i>0&&s!==e[i+1]&&Math.abs(d-o[i])>Math.abs(d-o[i-1]))e[i]=s;else if(i<n-1&&e[i]!==s-1&&Math.abs(d-o[i])>Math.abs(d-o[i+1])){e[i+1]=s-1;break}f=l,l=0,a=[],r=[];for(let s=0;s<n;s++){a.push(o[s]),r.push(c[s]);const n=u(s,e,t,i);o[s]=n.sbMean,c[s]=n.sbSdcm,l+=c[s]}}if(l>f){for(let t=0;t<n;t++)e[t]=s[t],o[t]=a[t],c[t]=r[t];l=f}return{mean:o,sdcm:c}}function u(e,t,i,n){let s=0,a=0;for(let r=t[e]+1;r<=t[e+1];r++){const e=n[r];s+=i[r]*e,a+=e}a<=0&&console.log("Exception in Natural Breaks calculation");const r=s/a;let l=0;for(let s=t[e]+1;s<=t[e+1];s++)l+=n[s]*(i[s]-r)**2;return{sbMean:r,sbSdcm:l}}const c=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,d=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),f=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function h(e){const t=null!=e.normalizationField||null!=e.normalizationType,i=null!=e.minValue||null!=e.maxValue,n=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!i&&!n}function m(e){const t=e.returnDistinct?[...new Set(e.values)]:e.values,i=t.filter((e=>null!=e)).length,n={count:i};return e.supportsNullCount&&(n.nullcount=t.length-i),e.percentileParams&&(n.median=g(t,e.percentileParams)),n}function p(e){const{values:t,useSampleStdDev:i,supportsNullCount:n}=e;let s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,r=null,l=null,o=null,u=null,c=0;const d=null==e.minValue?-1/0:e.minValue,f=null==e.maxValue?1/0:e.maxValue;for(const e of t)Number.isFinite(e)?e>=d&&e<=f&&(r+=e,s=Math.min(s,e),a=Math.max(a,e),c++):"string"==typeof e&&c++;if(c&&null!=r){l=r/c;let e=0;for(const i of t)Number.isFinite(i)&&i>=d&&i<=f&&(e+=(i-l)**2);u=i?c>1?e/(c-1):0:c>0?e/c:0,o=Math.sqrt(u)}else s=null,a=null;const h={avg:l,count:c,max:a,min:s,stddev:o,sum:r,variance:u};return n&&(h.nullcount=t.length-c),e.percentileParams&&(h.median=g(t,e.percentileParams)),h}function g(e,t){const{fieldType:i,value:n,orderBy:s,isDiscrete:a}=t,r=y(i,"desc"===s);if(0===(e=[...e].filter((e=>null!=e)).sort(((e,t)=>r(e,t)))).length)return null;if(n<=0)return e[0];if(n>=1)return e[e.length-1];const l=(e.length-1)*n,o=Math.floor(l),u=o+1,c=l%1,d=e[o],f=e[u];return u>=e.length||a||"string"==typeof d||"string"==typeof f?d:d*(1-c)+f*c}function y(e,t){const i=t?1:-1,n=function(e){return e?(e,t)=>t-e:(e,t)=>e-t}(t),s=b(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...d].includes(e))return(e,t)=>"number"==typeof e&&"number"==typeof t?n(e,t):"string"==typeof e&&"string"==typeof t?s(e,t):i;if("esriFieldTypeDate"===e)return(e,t)=>{const s=new Date(e).getTime(),a=new Date(t).getTime();return isNaN(s)||isNaN(a)?i:n(s,a)};if(d.has(e))return(e,t)=>n(e,t);if("esriFieldTypeString"===e)return(e,t)=>s(e,t);if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){const e=b(t);return(t,i)=>e(x(t),x(i))}return t?(e,t)=>1:(e,t)=>-1}function b(e){return e?(e,t)=>(e=e?.toUpperCase(),t=t?.toUpperCase(),e>t?-1:e<t?1:0):(e,t)=>(e=e?.toUpperCase(),t=t?.toUpperCase(),e<t?-1:e>t?1:0)}function x(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function v(e,t){let i;for(i in e)f.includes(i)&&(Number.isFinite(e[i])||(e[i]=null));return t?(["avg","stddev","variance"].forEach((t=>{null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function V(e){const t={};for(let i of e)(null==i||"string"==typeof i&&""===i.trim())&&(i=null),null==t[i]?t[i]={count:1,data:i}:t[i].count++;return{count:t}}function F(e,t,i){const n=e.count,s=[];i&&t&&"coded-value"===t.type&&t.codedValues.forEach((e=>{const t=e.code;n.hasOwnProperty(t)||(n[t]={data:t,count:0})}));for(const e in n){const t=n[e];s.push({value:t.data,count:t.count,label:t.label})}return{uniqueValueInfos:s}}function I(e,t,i,n){let s=null;switch(t){case"log":0!==e&&(s=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(n)&&0!==n&&(s=e/n*100);break;case"field":Number.isFinite(i)&&0!==i&&(s=e/i);break;case"natural-log":e>0&&(s=Math.log(e));break;case"square-root":e>0&&(s=e**.5)}return s}function T(e,t){const i=function(e){const t=e.field,i=e.classificationMethod||"equal-interval",s=e.normalizationType,a=e.normalizationField,r=new n.Z;return r.classificationField=t,r.breakCount=e.breakCount,r.classificationMethod=i,r.standardDeviationInterval="standard-deviation"===i?e.standardDeviationInterval||1:void 0,r.normalizationType=s,r.normalizationField="field"===s?a:void 0,r}({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});return e=function(e,t,i){return t=null==t?-1/0:t,i=null==i?1/0:i,e.filter((e=>Number.isFinite(e)&&e>=t&&e<=i))}(e,t.minValue,t.maxValue),function(e){const{normalizationTotal:t}=e;return{classBreaks:a(e),normalizationTotal:t}}({definition:i,values:e,normalizationTotal:t.normalizationTotal})}function S(e,t){let i=e.classBreaks;const n=i.length,s=i[0].minValue,a=i[n-1].maxValue,r="standard-deviation"===t,l=c;return i=i.map((e=>{const t=e.label,i={minValue:e.minValue,maxValue:e.maxValue,label:t};if(r&&t){const e=t.match(l).map((e=>+e.trim()));2===e.length?(i.minStdDev=e[0],i.maxStdDev=e[1],e[0]<0&&e[1]>0&&(i.hasAvg=!0)):1===e.length&&(t.includes("<")?(i.minStdDev=null,i.maxStdDev=e[0]):t.includes(">")&&(i.minStdDev=e[0],i.maxStdDev=null))}return i})),{minValue:s,maxValue:a,classBreakInfos:i,normalizationTotal:e.normalizationTotal}}function _(e,t){const{min:i,max:n,intervals:s}=function(e,t){const{field:i,classificationMethod:n,standardDeviationInterval:s,normalizationType:a,normalizationField:r,normalizationTotal:l,minValue:o,maxValue:u}=t,c=t.numBins||10;let d=null,f=null,m=null;if(n&&"equal-interval"!==n||a){const{classBreaks:t}=T(e,{field:i,normalizationType:a,normalizationField:r,normalizationTotal:l,classificationMethod:n,standardDeviationInterval:s,minValue:o,maxValue:u,numClasses:c});d=t[0].minValue,f=t[t.length-1].maxValue,m=t.map((e=>[e.minValue,e.maxValue]))}else{if(null!=o&&null!=u)d=o,f=u;else{const t=p({values:e,minValue:o,maxValue:u,useSampleStdDev:!a,supportsNullCount:h({normalizationType:a,normalizationField:r,minValue:o,maxValue:u})});d=t.min,f=t.max}m=function(e,t,i){const n=(t-e)/i,s=[];let a,r=e;for(let e=1;e<=i;e++)a=r+n,a=Number(a.toFixed(16)),s.push([r,e===i?t:a]),r=a;return s}(d,f,c)}return{min:d,max:f,intervals:m}}(e,t),a=s.map(((e,t)=>({minValue:s[t][0],maxValue:s[t][1],count:0})));for(const t of e)if(null!=t&&t>=i&&t<=n){const e=w(s,t);e>-1&&a[e].count++}return{bins:a,minValue:i,maxValue:n,normalizationTotal:t.normalizationTotal}}function w(e,t){let i=-1;for(let n=e.length-1;n>=0;n--)if(t>=e[n][0]){i=n;break}return i}}}]);
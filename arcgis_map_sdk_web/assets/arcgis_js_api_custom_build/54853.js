"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[54853,8060],{8060:(e,t,r)=>{r.r(t),r.d(t,{getGeometryServiceURL:()=>l,projectGeometry:()=>d});var i=r(51366),s=r(70375),n=r(93968),o=r(94466),a=r(41268);async function l(e=null,t){if(i.Z.geometryServiceUrl)return i.Z.geometryServiceUrl;if(!e)throw new s.Z("internal:geometry-service-url-not-configured");let r;r="portal"in e?e.portal||n.Z.getDefault():e,await r.load({signal:t});const o=r.helperServices?.geometry?.url;if(!o)throw new s.Z("internal:geometry-service-url-not-configured");return o}async function d(e,t,r=null,i){const n=await l(r,i),d=new a.Z({geometries:[e],outSpatialReference:t}),h=await(0,o.i)(n,d,{signal:i});if(h&&Array.isArray(h)&&1===h.length)return h[0];throw new s.Z("internal:geometry-service-projection-failed")}},94466:(e,t,r)=>{r.d(t,{i:()=>h});var i=r(66341),s=r(7283),n=r(53736),o=r(84238),a=r(5167),l=r(41268);const d=(0,s.se)(l.Z);async function h(e,t,r){t=d(t);const s=(0,o.en)(e),l={...s.query,f:"json",...t.toJSON()},h=t.outSpatialReference,u=(0,n.Ji)(t.geometries[0]),p=(0,o.lA)(l,r);return(0,i.Z)(s.path+"/project",p).then((({data:{geometries:e}})=>(0,a.o)(e,u,h)))}},41268:(e,t,r)=>{r.d(t,{Z:()=>u});var i=r(36663),s=r(82064),n=r(81977),o=(r(39994),r(13802),r(4157),r(40266)),a=r(14685),l=r(53736),d=r(35925);let h=class extends s.Z{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map((e=>e.toJSON())),t=this.geometries[0],r={};return r.outSR=(0,d.B9)(this.outSpatialReference),r.inSR=(0,d.B9)(t.spatialReference),r.geometries=JSON.stringify({geometryType:(0,l.Ji)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}};(0,i._)([(0,n.Cb)()],h.prototype,"geometries",void 0),(0,i._)([(0,n.Cb)({type:a.Z,json:{read:{source:"outSR"}}})],h.prototype,"outSpatialReference",void 0),(0,i._)([(0,n.Cb)()],h.prototype,"transformation",void 0),(0,i._)([(0,n.Cb)()],h.prototype,"transformForward",void 0),h=(0,i._)([(0,o.j)("esri.rest.support.ProjectParameters")],h);const u=h},28800:(e,t,r)=>{r.d(t,{A:()=>h});var i=r(36663),s=r(23148),n=r(78668),o=r(76868),a=r(81977),l=(r(39994),r(13802),r(4157),r(40266)),d=r(64862);const h=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,d.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,s.kB)((()=>e.abort()))),await(0,o.N1)((()=>this.view.defaultsFromMap?.heightModelInfoReady),t),(0,n.k_)(t);const r=(0,d.Wt)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(r)throw r}};return(0,i._)([(0,a.Cb)()],t.prototype,"view",void 0),(0,i._)([(0,a.Cb)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,i._)([(0,l.j)("esri.views.3d.layers.LayerView3D")],t),t}},54853:(e,t,r)=>{r.r(t),r.d(t,{default:()=>I});var i=r(36663),s=r(41831),n=r(81739),o=r(61681),a=r(76868),l=r(81977),d=(r(39994),r(13802),r(4157),r(40266)),h=r(51801),u=r(45340),p=r(6199),c=r(52182),y=r(79259),g=r(92524),f=r(76045),m=r(28800),v=r(95484),b=r(70633),_=r(53986),w=r(3659),C=r(53448),S=r(26216),E=r(67235);let O=class extends((0,m.A)(S.Z)){constructor(){super(...arguments),this.type="route-3d",this.loadedGraphics=new w.g,this._byObjectID=new Map,this.slicePlaneEnabled=!1,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set("processor",new v.D({owner:this,scaleVisibilityEnabled:!0,frustumVisibilityEnabled:!0})),this.addResolvingPromise(this.processor.initializePromise),this._updatingHandles.addOnCollectionChange((()=>this._routeItems),(e=>this._routeItemsChanged(e)),a.nn),this.addResolvingPromise((0,_.E)(this).then((e=>this.fullExtentInLocalViewSpatialReference=e))),this.addHandles((0,a.gx)((()=>this.view?.basemapTerrain?.ready),(()=>()=>this.notifyChange("updating")),{once:!0}))}destroy(){this._updatingHandles.removeAll(),this._set("processor",(0,o.SC)(this.processor)),this._get("_routeItems")?.destroy()}get _routeItems(){return new n.Z({getCollections:()=>[this.layer.pointBarriers,this.layer.polygonBarriers,this.layer.polylineBarriers,this.layer.stops,this.layer.directionLines,this.layer.directionPoints,null!=this.layer.routeInfo?new s.Z([this.layer.routeInfo]):null]})}_routeItemsChanged(e){if(e.removed.length){this.loadedGraphics.removeMany(e.removed.map((e=>{const t=this._byObjectID.get(e);return this._byObjectID.delete(e),t})));for(const t of e.removed)this.removeHandles(t)}if(e.added.length){this.loadedGraphics.addMany(e.added.map((e=>{const t=e.toGraphic();return this._byObjectID.set(e,t),t})));for(const t of e.added)this.addHandles([(0,a.YP)((()=>t.geometry),((e,r)=>{this._updateGraphic(t,"geometry",e,r)})),(0,a.YP)((()=>t.symbol),((e,r)=>{this._updateGraphic(t,"symbol",e,r)}))],t)}}get legendEnabled(){return this.canResume()&&!this.processor?.frustumVisibilitySuspended}get visibleAtCurrentScale(){return!this.processor?.scaleVisibilitySuspended}getSuspendInfo(){const e=super.getSuspendInfo();return e.outsideOfView=this.processor?.frustumVisibilitySuspended??!1,e}getHit(e){return this.processor.getHit(e)}whenGraphicBounds(e,t){return this.processor.whenGraphicBounds(e,t)}computeAttachmentOrigin(e,t){return this.processor?.computeAttachmentOrigin(e,t)}getSymbolLayerSize(e,t){return this.processor.getSymbolLayerSize(e,t)}async queryGraphics(){return new s.Z(this.loadedGraphics.toArray())}maskOccludee(e){return this.processor.maskOccludee(e)}highlight(e,t){return function(e){return e instanceof h.Z||e instanceof u.Z||e instanceof p.Z||e instanceof c.Z||e instanceof y.Z||e instanceof g.Z||e instanceof f.Z}(e)&&(e=this._byObjectID.get(e)),this.processor.highlight(e,t?.name??E.b)}get updatePolicy(){return this.processor?.graphicsCore.effectiveUpdatePolicy||C.j.SYNC}isUpdating(){return!(!this.processor?.updating&&this.view?.basemapTerrain?.ready)}get performanceInfo(){return new b.W(this.processor?.graphicsCore.usedMemory??0,this.loadedGraphics.length,-1,-1,0,this.processor?.graphicsCore.performanceInfo??null)}_updateGraphic(e,t,r,i){const s=this._byObjectID.get(e);s[t]=r,R.graphic=s,R.property=t,R.oldValue=i,R.newValue=r,this.processor?.graphicsCore.graphicUpdateHandler(R)}};(0,i._)([(0,l.Cb)()],O.prototype,"_routeItems",null),(0,i._)([(0,l.Cb)()],O.prototype,"loadedGraphics",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],O.prototype,"legendEnabled",null),(0,i._)([(0,l.Cb)({readOnly:!0})],O.prototype,"visibleAtCurrentScale",null),(0,i._)([(0,l.Cb)()],O.prototype,"layer",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],O.prototype,"processor",void 0),(0,i._)([(0,l.Cb)({type:Boolean})],O.prototype,"slicePlaneEnabled",void 0),O=(0,i._)([(0,d.j)("esri.views.3d.layers.RouteLayerView3D")],O);const R={graphic:null,property:null,oldValue:null,newValue:null},I=O},53986:(e,t,r)=>{r.d(t,{E:()=>n});var i=r(39536),s=r(8060);async function n(e){const t=e.view.spatialReference,r=e.layer.fullExtent,n=null!=r&&r.spatialReference;if(null==r||!n)return null;if(n.equals(t))return r.clone();const o=(0,i.iV)(r,t);if(null!=o)return o;if(e.view.state.isLocal)try{const i=await(0,s.projectGeometry)(r,t,e.layer.portalItem);return e.destroyed||null==i?null:i}catch{return null}return null}},3659:(e,t,r)=>{r.d(t,{g:()=>o});var i=r(31355),s=r(98722),n=r(18809);class o extends i.Z{constructor(){super(...arguments),this._set=new Set,this._length=(0,n.t)(0)}clear(){if(this._set.size>0){const e=this.toArray();this._set.clear(),this.emit("after-changes",{type:s.y.REMOVE}),this.emit("change",{added:[],removed:e})}}get length(){return this._length.value}addMany(e){if(0!==e.length){for(const t of e)this._set.add(t);this._length.value=this._set.size,this.emit("after-changes",{type:s.y.ADD}),this.emit("change",{added:e,removed:[]})}}remove(e){this._set.delete(e)&&(this._length.value=this._set.size,this.emit("after-changes",{type:s.y.REMOVE}),this.emit("change",{added:[],removed:[e]}))}removeMany(e){const t=[];for(const r of e)this._set.delete(r)&&t.push(r);t.length>0&&(this._length.value=this._set.size,this.emit("after-changes",{type:s.y.REMOVE}),this.emit("change",{added:[],removed:t}))}toArray(){return Array.from(this._set.values())}find(e){for(const t of this._set.values())if(e(t))return t}some(e){for(const t of this._set.values())if(e(t))return!0;return!1}forEach(e){this._set.forEach((t=>e(t)))}}},26216:(e,t,r)=>{r.d(t,{Z:()=>g});var i=r(36663),s=r(74396),n=r(31355),o=r(86618),a=r(13802),l=r(61681),d=r(64189),h=r(81977),u=(r(39994),r(4157),r(40266)),p=r(98940),c=r(42780);let y=class extends(o.Z.IdentifiableMixin(d.Z.EsriPromiseMixin(n.Z.EventedMixin(s.Z)))){get spatialReferenceSupported(){return!0}constructor(e){super(e),this._updatingHandles=new p.R,this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",r=this.layer?.title||"no title";a.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${r}', id: '${t}')`,e)}}))}destroy(){this._updatingHandles=(0,l.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const e=this.view.timeExtent,t=this.layer?.visibilityTimeExtent;return!e||!t||!e.intersection(t).isEmpty}canResume(){const e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&this.parent&&!this.parent.suspended&&this.view?.ready&&(0,c.Cy)(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const e=this.parent?.suspended?this.parent.suspendInfo:{};this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0);const t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,c.Cy)(t)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,i._)([(0,h.Cb)({readOnly:!0})],y.prototype,"spatialReferenceSupported",null),(0,i._)([(0,h.Cb)()],y.prototype,"view",void 0),(0,i._)([(0,h.Cb)()],y.prototype,"fullOpacity",null),(0,i._)([(0,h.Cb)()],y.prototype,"layer",void 0),(0,i._)([(0,h.Cb)()],y.prototype,"parent",void 0),(0,i._)([(0,h.Cb)({readOnly:!0})],y.prototype,"suspended",null),(0,i._)([(0,h.Cb)({readOnly:!0})],y.prototype,"suspendInfo",null),(0,i._)([(0,h.Cb)({readOnly:!0})],y.prototype,"legendEnabled",null),(0,i._)([(0,h.Cb)({type:Boolean,readOnly:!0})],y.prototype,"updating",null),(0,i._)([(0,h.Cb)({readOnly:!0})],y.prototype,"updatingProgress",null),(0,i._)([(0,h.Cb)()],y.prototype,"updateSuspended",null),(0,i._)([(0,h.Cb)()],y.prototype,"visible",null),(0,i._)([(0,h.Cb)({readOnly:!0})],y.prototype,"visibleAtCurrentScale",null),(0,i._)([(0,h.Cb)({readOnly:!0})],y.prototype,"visibleAtCurrentTimeExtent",null),y=(0,i._)([(0,u.j)("esri.views.layers.LayerView")],y);const g=y}}]);
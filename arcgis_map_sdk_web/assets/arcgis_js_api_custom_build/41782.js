"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[41782],{18486:(e,t,n)=>{n.d(t,{Fi:()=>K,Hq:()=>Y,Mk:()=>p,P_:()=>q,Qp:()=>D,VO:()=>P,Wt:()=>B,_D:()=>b,af:()=>G,kr:()=>H,lK:()=>Q,nF:()=>N,tB:()=>Z,ut:()=>U,vF:()=>$,zD:()=>_});var i,o,r=n(7753),a=n(70375),s=n(17321),l=n(91772),c=n(96926),f=n(10186),u=n(89542),m=n(90472),h=n(14685),x=n(35925);function p(e,t,n){return!(0,m.canProjectWithoutEngine)(e,t,n)}function g(e,t,n){const i=p(e,t,n);if(i&&!(0,m.isLoaded)())throw new a.Z("rasterprojectionhelper-project","projection engine is not loaded");return i}(o=i||(i={}))[o.None=0]="None",o[o.North=1]="North",o[o.South=2]="South",o[o.Both=3]="Both";const d=(e,t,n,i=0)=>{if(1===n[0])return[0,0];let o=1,r=-1,a=1,s=-1;for(let t=0;t<e.length;t+=2)isNaN(e[t])||(o=o>e[t]?e[t]:o,r=r>e[t]?r:e[t],a=a>e[t+1]?e[t+1]:a,s=s>e[t+1]?s:e[t+1]);const{cols:l,rows:c}=t,f=(r-o)/l/n[0],u=(s-a)/c/n[1],m=2*i;let h=0,x=!1,p=[0,0];for(let t=0;t<l-3;t++){for(let n=0;n<c-3;n++){const i=t*c*2+2*n,o=(e[i]+e[i+4]+e[i+4*c]+e[i+4*c+4])/4,r=(e[i+1]+e[i+5]+e[i+4*c+1]+e[i+4*c+5])/4,a=Math.abs((o-e[i+2*c+2])/f),s=Math.abs((r-e[i+2*c+3])/u);if(a+s>h&&(h=a+s,p=[a,s]),m&&h>m){x=!0;break}}if(x)break}return p},y={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},w=new Map,M=new Map,R=500;let S=null;async function _(){S&&(0,m.isLoaded)()||((0,m.isLoaded)()||await(0,m.load)(),S=await Promise.all([n.e(89067),n.e(16233)]).then(n.bind(n,17700)))}function b(e,t,n){return g(e.spatialReference,t),n?(0,m.getTransformation)(t,e.spatialReference,e):(0,m.getTransformation)(e.spatialReference,t,e)}function P(e,t,n,i=null){const o=e.spatialReference;if(!o||!t||o.equals(t))return e;g(o,t,i);const r=n.center,a=new l.Z({xmin:r.x-e.x/2,xmax:r.x+e.x/2,ymin:r.y-e.y/2,ymax:r.y+e.y/2,spatialReference:o}),s=(0,m.project)(a,t,i),c=U(t);return null==s||null!=c&&s.width>=c?E(e,o,t):{x:s.width,y:s.height}}function E(e,t,n){const i=(0,s.c9)(t)/(0,s.c9)(n);return{x:e.x*i,y:e.y*i}}function T(e,t,n){const{spatialReference:i}=n;if(!i||!t||i.equals(t))return e;if(i.isGeographic&&t.isGeographic)return E(e,i,t);if(g(i,t),!S)throw new a.Z("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let{x:o,y:r}=e;const l=(o+r)/2*(0,s.c9)(i);let c=1;l>30&&(c=30/l,o*=c,r*=c);const f=256,h=o*f/2,x=r*f/2,{x:p,y:d}=n.center,y=[];for(let e=0;e<=f;e++)y.push([p-h,d-x+e*r]);for(let e=1;e<=f;e++)y.push([p-h+e*o,d+x]);for(let e=1;e<=f;e++)y.push([p+h,d+x-e*r]);for(let e=1;e<f;e++)y.push([p+h-e*o,d-x]);y.push(y[0]);const w=new u.Z({rings:[y],spatialReference:i}),M=(0,m.project)(w,t);if(!M)return E(e,i,t);const R=M.extent,_=U(t);if(null==R||null!=_&&R.width>=_)return E(e,i,t);const b=S.planarArea(M),P=o*r*f*f,T=Math.sqrt(b/P)/c,k={x:R.width/c/f,y:R.height/c/f},G={x:o*T,y:r*T},C=k.x*k.y;return Math.abs(C-G.x*G.y)/C<.1?k:G}function k(e,t){return("number"==typeof e?e:(e.x+e.y)/2)*(0,s.c9)(t)*96*39.37}function G(e,t){const{pixelSize:n,extent:i}=e;return k(T(n,t,i),t)}function C(e,t=.01){return(0,s.c9)(e)?t/(0,s.c9)(e):0}function N(e,t,n=null,i=!0){const o=e.spatialReference;if(o.equals(t))return e;g(o,t,n);const r=(0,m.project)(e,t,n);return i&&r?(A([e],[r],o,t),r):r}function A(e,t,n,i){const o=W(n,!0),r=W(i,!0),a=C(n,R),s=C(i,R);if(a&&null!=o&&null!=r)for(let n=0;n<e.length;n++){const i=t[n];if(!i)continue;const{x:l}=e[n],{x:c}=i;c>=r[1]-s&&Math.abs(l-o[0])<a?i.x-=r[1]-r[0]:c<=r[0]+s&&Math.abs(l-o[1])<a&&(i.x+=r[1]-r[0])}}function O(e){const{inSR:t,outSR:n,datumTransformation:i,preferPE:o}=e;if(t.equals(n)){const{points:t}=z(e,null);return t}if(t.isWebMercator&&n.isWGS84||t.isWGS84&&n.isWebMercator)return function(e){const{cols:t,rows:n,xres:i,yres:o,usePixelCenter:r,inSR:a,outSR:s}=e;let{xmin:l,ymax:c}=e;r&&(l+=i/2,c-=o/2);const u=[],h=[],x=Math.max(t,n);for(let e=0;e<x;e++){const r=l+i*Math.min(t,e),x=c-o*Math.min(n,e),p=(0,m.project)(new f.Z({x:r,y:x,spatialReference:a}),s);e<=t&&u.push(p.x),e<=n&&h.push(p.y)}const p=[];for(let e=0;e<t;e++)for(let t=0;t<n;t++)p.push([u[e],h[t]]);return p}(e);if(g(t,n,i)&&o){if(t.isGeographic)return v(e);if(null!=L(t))return v(e)}return function(e){const{points:t}=z(e,null),{inSR:n,outSR:i,datumTransformation:o}=e,r=t.map((e=>new f.Z(e[0],e[1],n))),a=(0,m.project)(r,i,o);return o&&A(r,a,n,i),a.map((e=>e?[e.x,e.y]:[NaN,NaN]))}(e)}function v(e){const{inSR:t,outSR:n,datumTransformation:i}=e,o=L(t),{points:r,mask:a}=z(e,o);if(!t.isGeographic){const e=t.wkid?c.P.coordsys(t.wkid):c.P.fromString(t.isGeographic?c.a.PE_TYPE_GEOGCS:c.a.PE_TYPE_PROJCS,t.wkt2||t.wkt);c.g.projToGeog(e,r.length,r)}if(null!=i&&i.steps.length){let e;const t=179.9955;if(n.isGeographic&&(e=r.map((([e])=>e>t?1:e<-179.9955?-1:0))),i.steps.forEach((e=>{const t=e.wkid?c.P.geogtran(e.wkid):c.P.fromString(c.a.PE_TYPE_GEOGTRAN,e.wkt);c.h.geogToGeog(t,r.length,r,null,e.isInverse?c.a.PE_TRANSFORM_2_TO_1:c.a.PE_TRANSFORM_1_TO_2)})),e)for(let n=0;n<r.length;n++){const i=e[n],o=r[n][0],a=o>t?1:o<-179.9955?-1:0;i&&a&&i!==a&&(r[n][0]=i>0?o+360:o-360)}}if(!n.isGeographic){const e=L(n,!0),t=null!=e&&e.isEnvelope?[e.bbox[1],e.bbox[3]]:[-90,90];!function(e,t){const[n,i]=t;for(let t=0;t<e.length;t++){const o=e[t][1];(o<n||o>i)&&(e[t]=[NaN,NaN])}}(r,t);const i=n.wkid?c.P.coordsys(n.wkid):c.P.fromString(n.isGeographic?c.a.PE_TYPE_GEOGCS:c.a.PE_TYPE_PROJCS,n.wkt2||n.wkt);c.g.geogToProj(i,r.length,r)}let s=r;if(a&&r.length!==a.length){s=[];for(let e=0,t=0;e<a.length;e++)a[e]?s.push(r[t++]):s.push([NaN,NaN])}return s}function L(e,t=!1){let n=e.wkid||e.wkt2||e.wkt;if(!n||e.isGeographic)return null;if(n=String(n),w.has(n)){const e=w.get(n);return t?e?.gcs:e?.pcs}const i=e.wkid?c.P.coordsys(e.wkid):c.P.fromString(e.isGeographic?c.a.PE_TYPE_GEOGCS:c.a.PE_TYPE_PROJCS,e.wkt2||e.wkt),o=F(i,C(e,1e-4)),r=F(i,0,!0);return w.set(n,{pcs:o,gcs:r}),t?r:o}function F(e,t=0,n=!1){const i=c.j.generate(e),o=n?e.horizonGcsGenerate():e.horizonPcsGenerate();if(!i||!o?.length)return null;let r=!1,a=o.find((e=>1===e.getInclusive()&&1===e.getKind()));if(!a){if(a=o.find((e=>1===e.getInclusive()&&0===e.getKind())),!a)return null;r=!0}const s=n?0:(2===i.getNorthPoleLocation()?1:0)|(2===i.getSouthPoleLocation()?2:0),l=i.isPannableRectangle(),f=a.getCoord();if(r)return{isEnvelope:r,isPannable:l,vertices:f,coef:null,bbox:[f[0][0]-t,f[0][1]-t,f[1][0]+t,f[1][1]+t],poleLocation:s};let u=0;const m=[];let[h,x]=f[0],[p,g]=f[0];for(let e=0,t=f.length;e<t;e++){u++,u===t&&(u=0);const[n,i]=f[e],[o,r]=f[u];if(r===i)m.push([n,o,i,r,2]);else{const e=(o-n)/(r-i||1e-4),t=n-e*i;i<r?m.push([e,t,i,r,0]):m.push([e,t,r,i,1])}h=h<n?h:n,x=x<i?x:i,p=p>n?p:n,g=g>i?g:i}return{isEnvelope:!1,isPannable:l,vertices:f,coef:m,bbox:[h,x,p,g],poleLocation:s}}function z(e,t){const n=[],{cols:i,rows:o,xres:r,yres:a,usePixelCenter:s}=e;let{xmin:l,ymax:c}=e;if(s&&(l+=r/2,c-=a/2),null==t){for(let e=0;e<i;e++)for(let t=0;t<o;t++)n.push([l+r*e,c-a*t]);return{points:n}}const f=new Uint8Array(i*o);if(t.isEnvelope){const{bbox:[e,s,u,m]}=t;for(let h=0,x=0;h<i;h++){const i=l+r*h,p=t.isPannable||i>=e&&i<=u;for(let e=0;e<o;e++,x++){const t=c-a*e;p&&t>=s&&t<=m&&(n.push([i,t]),f[x]=1)}}return{points:n,mask:f}}const u=t.coef,m=[];for(let e=0;e<o;e++){const t=c-a*e,n=[],i=[];for(let e=0;e<u.length;e++){const[o,r,a,s,l]=u[e];if(t===a&&a===s)n.push(o),n.push(r),i.push(2),i.push(2);else if(t>=a&&t<=s){const e=o*t+r;n.push(e),i.push(l)}}let o=n;if(n.length>2){let e=2===i[0]?0:i[0],t=n[0];o=[];for(let r=1;r<i.length;r++)2===i[r]&&r!==i.length-1||(i[r]!==e&&(o.push(0===e?Math.min(t,n[r-1]):Math.max(t,n[r-1])),e=i[r],t=n[r]),r===i.length-1&&o.push(0===i[r]?Math.min(t,n[r]):Math.max(t,n[r])));o.sort(((e,t)=>e-t))}else n[0]>n[1]&&(o=[n[1],n[0]]);m.push(o)}for(let e=0,t=0;e<i;e++){const i=l+r*e;for(let e=0;e<o;e++,t++){const o=c-a*e,r=m[e];if(2===r.length)i>=r[0]&&i<=r[1]&&(n.push([i,o]),f[t]=1);else if(r.length>2){let e=!1;for(let t=0;t<r.length;t+=2)if(i>=r[t]&&i<=r[t+1]){e=!0;break}e&&(n.push([i,o]),f[t]=1)}}}return{points:n,mask:f}}function I(e,t){const n=U(e[0].spatialReference);if(e.length<2||null==n)return e[0];if(t=t??C(e[0].spatialReference),1===(e=e.filter((e=>e.width>t))).length)return e[0];let{xmin:i,xmax:o,ymin:r,ymax:a}=e[0];for(let t=1;t<e.length;t++){const i=e[t];o=i.xmax+n*t,r=Math.min(r,i.ymin),a=Math.max(a,i.ymax)}return new l.Z({xmin:i,xmax:o,ymin:r,ymax:a,spatialReference:e[0].spatialReference})}function Z(e,t,n=null,o=!0){const a=e.spatialReference;if(a.equals(t))return e;const s=Y(e),c=U(a,!0),f=U(t);if(0===s||null==c||null==f){const r=j(e,t,n,o);if(null==c&&null!=f&&Math.abs(r.width-f)<C(t)&&(0,m.isLoaded)()){const n=L(a);if(null!=n&&n.poleLocation===i.None&&e.width<(n.bbox[2]-n.bbox[0])/2)return function(e,t){const n=U(t);if(null==n)return null;let{xmin:i,ymin:o,xmax:r,ymax:a}=e;const s=e.spatialReference,c=new u.Z({spatialReference:s,rings:[[[i,o],[r,o],[r,a],[i,a],[i,o]]]}),f=(0,m.project)(c,t);if(2!==f.rings.length||!f.rings[0].length||!f.rings[1].length)return null;const{rings:h}=f,x=C(s),p=new l.Z({spatialReference:t});for(let e=0;e<2;e++){i=r=h[e][0][0],o=a=h[e][0][1];for(let t=0;t<h[e].length;t++)i=i>h[e][t][0]?h[e][t][0]:i,r=r<h[e][t][0]?h[e][t][0]:r,o=o>h[e][t][1]?h[e][t][1]:o,a=a<h[e][t][1]?h[e][t][1]:a;if(0===e)p.ymin=o,p.ymax=a,p.xmin=i,p.xmax=r;else if(p.ymin=Math.min(p.ymin,o),p.ymax=Math.max(p.ymax,a),Math.abs(r-n/2)<x)p.xmin=i,p.xmax=p.xmax+n;else{if(!(Math.abs(i+n/2)<x))return null;p.xmax=r+n}}return p}(e,t)||r}return r}const h=e.clone().normalize();if(1===h.length&&e.xmax<c&&e.xmax-c/2>C(a)){const{xmin:t,xmax:n}=e;for(let i=0;i<=s;i++){const o=0===i?t:-c/2,r=i===s?n-c*i:c/2;h[i]=new l.Z({xmin:o,xmax:r,ymin:e.ymin,ymax:e.ymax,spatialReference:a})}}return I(h.map((e=>j(e,t,n,o))).filter(r.pC))}function B(e,t,n){if("extent"===e.type){const{xmin:t,ymin:n,xmax:i,ymax:o,spatialReference:r}=e;e=new u.Z({rings:[[[t,o],[i,o],[i,n],[t,n],[t,o]]],spatialReference:r})}return e.spatialReference.equals(t)?e:(g(e.spatialReference,t,n),(0,m.project)(e,t,n))}function j(e,t,n=null,i=!0,o=!0){const r=e.spatialReference;if(r.equals(t)||!t)return e;g(r,t,n);const a=(0,m.project)(e,t,n);if(o&&t.isWebMercator&&a&&(a.ymax=Math.min(20037508.342787,a.ymax),a.ymin=Math.max(-20037508.342787,a.ymin),a.ymin>=a.ymax))return null;if(!i||!a)return a;const s=W(r,!0),l=W(t,!0);if(null==s||null==l)return a;const c=C(r,.001),u=C(r,R),h=C(t,.001);if(Math.abs(a.xmin-l[0])<h&&Math.abs(a.xmax-l[1])<h){const i=Math.abs(e.xmin-s[0]),o=Math.abs(s[1]-e.xmax);if(i<c&&o>u){a.xmin=l[0];const i=[];i.push(new f.Z(e.xmax,e.ymin,r)),i.push(new f.Z(e.xmax,(e.ymin+e.ymax)/2,r)),i.push(new f.Z(e.xmax,e.ymax,r));const o=i.map((e=>N(e,t,n))).filter((e=>!isNaN(e?.x))).map((e=>e.x));a.xmax=Math.max.apply(null,o)}if(o<c&&i>u){a.xmax=l[1];const i=[];i.push(new f.Z(e.xmin,e.ymin,r)),i.push(new f.Z(e.xmin,(e.ymin+e.ymax)/2,r)),i.push(new f.Z(e.xmin,e.ymax,r));const o=i.map((e=>N(e,t,n))).filter((e=>!isNaN(e?.x))).map((e=>e.x));a.xmin=Math.min.apply(null,o)}}else{const e=C(t,.001);Math.abs(a.xmin-l[0])<e&&(a.xmin=l[0]),Math.abs(a.xmax-l[1])<e&&(a.xmax=l[1])}return a}function U(e,t=!1){if(!e)return null;const n=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*n:e.wkid&&e.isGeographic?360:2*y[e.wkid]||null}function W(e,t=!1){if(e.isGeographic)return[-180,180];const n=U(e,t);return null!=n?[-n/2,n/2]:null}function V(e,t,n,i){let o=(e-t)/n;return o-Math.floor(o)!=0?o=Math.floor(o):i&&(o-=1),o}function Y(e,t=!1){const n=U(e.spatialReference);if(null==n)return 0;const i=t?0:-n/2,o=C(e.spatialReference),r=!t&&Math.abs(e.xmax-n/2)<o?n/2:e.xmax,a=!t&&Math.abs(e.xmin+n/2)<o?-n/2:e.xmin;return V(r,i,n,!0)-V(a,i,n,!1)}function q(e){const t=e.storageInfo.origin.x,n=U(e.spatialReference,!0);if(null==n)return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const i=n/2,{nativePixelSize:o,storageInfo:r,extent:a}=e,{maximumPyramidLevel:s,blockWidth:l,pyramidScalingFactor:c}=r;let f=o.x;const u=[],m=null!=e.transform&&"gcs-shift"===e.transform.type,h=t+(m?0:i),x=m?n-t:i-t;for(let e=0;e<=s;e++){const e=(a.xmax-t)/f/l,n=e-Math.floor(e)==0?e:Math.ceil(e),i=x/f/l,o=i-Math.floor(i)==0?i:Math.ceil(i),r=Math.floor(h/f/l),s=Math.round(h/f)%l,m=(l-Math.round(x/f)%l)%l;u.push({resolutionX:f,blockWidth:l,datasetColumnCount:n,worldColumnCountFromOrigin:o,leftMargin:s,rightPadding:m,originColumnOffset:r}),f*=c}return{originX:t,halfWorldWidth:i,pyramidsInfo:u,hasGCSSShiftTransform:m}}function D(e){const t=e.isAdaptive&&null==e.spacing;let n=e.spacing||[32,32],i=X(e),o={cols:i.size[0]+1,rows:i.size[1]+1};const r=i.outofBoundPointCount>0&&i.outofBoundPointCount<i.offsets.length/2;let a=i.outofBoundPointCount===i.offsets.length/2||t&&r?[0,0]:d(i.offsets,o,n,4);const s=(a[0]+a[1])/2,l=e.projectedExtent.spatialReference,f=e.srcBufferExtent.spatialReference;if(t&&(r||s>4)&&(p(l,f,e.datumTransformation)&&(l.isGeographic||L(l)),n=[4,4],i=X({...e,spacing:n}),o={cols:i.size[0]+1,rows:i.size[1]+1},a=d(i.offsets,o,n,4)),i.error=a,n[0]>1&&(i.coefficients=J(i.offsets,o,r)),e.includeGCSGrid&&!l.isGeographic&&!l.isWebMercator)if(f.isGeographic)i.gcsGrid={offsets:i.offsets,coefficients:i.coefficients,spacing:n};else{const t=L(l);if(null!=t&&!t.isEnvelope){const t=function(e){if(!e||e.isGeographic)return e;const t=String(e.wkid||e.wkt2||e.wkt);let n;return M.has(t)?n=M.get(t):(n=(e.wkid?c.P.coordsys(e.wkid):c.P.fromString(c.a.PE_TYPE_PROJCS,e.wkt2||e.wkt)).getGeogcs().getCode(),M.set(t,n)),new h.Z({wkid:n})}(l),a=Z(e.projectedExtent,t),{offsets:s}=X({...e,srcBufferExtent:a,spacing:n}),f=J(s,o,r);i.gcsGrid={offsets:s,coefficients:f,spacing:n}}}return i}function X(e){const{projectedExtent:t,srcBufferExtent:n,pixelSize:i,datumTransformation:o,rasterTransform:r}=e,a=t.spatialReference,s=n.spatialReference,l=g(a,s),{xmin:c,ymin:u,xmax:m,ymax:h}=t,x=U(s),p=null!=x&&(e.hasWrapAround||"gcs-shift"===r?.type),d=e.spacing||[32,32],y=d[0]*i.x,w=d[1]*i.y,M=1===d[0],S=Math.ceil((m-c)/y-.1/d[0])+(M?0:1),_=Math.ceil((h-u)/w-.1/d[1])+(M?0:1),b=O({cols:S,rows:_,xmin:c,ymax:h,xres:y,yres:w,inSR:a,outSR:s,datumTransformation:o,preferPE:d[0]<=4,usePixelCenter:M}),P=[];let E,T=0;const k=M?-1:NaN,{xmin:G,xmax:N,ymax:A,width:v,height:F}=n,z=C(s,R),I=null!=x&&G>0&&N>x/2;let Z=!1;if(l){const e=L(a);Z=null!=e&&e.poleLocation>0}for(let e=0;e<S;e++){const t=[];for(let n=0;n<_;n++){let i=b[e*_+n];if(p&&i[0]>N&&i[0]>x/2-z?i[0]-=x:p&&0===e&&i[0]<0&&I&&!r&&(i[0]+=x),!i||isNaN(i[0])||isNaN(i[1]))P.push(k),P.push(k),t.push(null),T++;else{if(r){const e=r.inverseTransform(new f.Z({x:i[0],y:i[1],spatialReference:s}));i=[e.x,e.y]}t.push(i),e>0&&p&&E[n]&&i[0]<E[n][0]&&(i[0]+=x,Z&&i[0]>N&&i[0]>x&&(i[0]-=x)),P.push((i[0]-G)/v),P.push((A-i[1])/F)}}E=t}return{offsets:P,error:null,coefficients:null,outofBoundPointCount:T,spacing:d,size:M?[S,_]:[S-1,_-1]}}function J(e,t,n){const{cols:i,rows:o}=t,r=new Float32Array((i-1)*(o-1)*2*6),a=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),s=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let t=0;t<i-1;t++){for(let n=0;n<o-1;n++){let l=t*o*2+2*n;const c=e[l],f=e[l+1],u=e[l+2],m=e[l+3];l+=2*o;const h=e[l],x=e[l+1],p=e[l+2],g=e[l+3];let d=0,y=12*(n*(i-1)+t);for(let e=0;e<3;e++)r[y++]=a[d++]*c+a[d++]*u+a[d++]*p;d=0;for(let e=0;e<3;e++)r[y++]=a[d++]*f+a[d++]*m+a[d++]*g;d=0;for(let e=0;e<3;e++)r[y++]=s[d++]*c+s[d++]*h+s[d++]*p;d=0;for(let e=0;e<3;e++)r[y++]=s[d++]*f+s[d++]*x+s[d++]*g}if(n)for(let e=0;e<r.length;e++)isNaN(r[e])&&(r[e]=-1)}return r}function K(e){const{spatialReference:t}=e,n=(0,x.C5)(t);if(!n)return e;const[i,o]=n.valid,r=o-i;let a=0;if(e.xmin<i){const t=i-e.xmin;a=Math.ceil(t/r)}else if(e.xmin>o){const t=e.xmin-o;a=-Math.ceil(t/r)}return new l.Z({spatialReference:e.spatialReference,xmin:e.xmin+a*r,ymin:e.ymin,xmax:e.xmax+a*r,ymax:e.ymax})}function H(e,t,n){const{storageInfo:i,pixelSize:o}=t;let r=0,a=!1;const{pyramidResolutions:l}=i,c="mixed"===i.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,i.tileInfo.dpi/96)):1,u=(e.x+e.y)/2/c;if(null!=l&&l.length){const e=l[l.length-1],i=(e.x+e.y)/2,c=(o.x+o.y)/2;if(u<=c)r=0;else if(u>=i)r=l.length,a=u/i>8;else{let e,t=c;for(let i=1;i<=l.length;i++){if(e=(l[i-1].x+l[i-1].y)/2,u<=e){u===e?r=i:"down"===n?(r=i-1,a=u/t>8):r="up"===n||u-t>e-u||u/t>2?i:i-1;break}t=e}}const m=0===r?o:l[r-1];return a&&Math.min(m.x,m.y)*(0,s.c9)(t.spatialReference)>19567&&(a=!1),{pyramidLevel:r,pyramidResolution:new f.Z({x:m.x,y:m.y,spatialReference:t.spatialReference}),excessiveReading:a}}const m=Math.log(e.x/o.x)/Math.LN2,h=Math.log(e.y/o.y)/Math.LN2,x=t.storageInfo.maximumPyramidLevel||0;r="down"===n?Math.floor(Math.min(m,h)):"up"===n?Math.ceil(Math.max(m,h)):Math.round((m+h)/2),r<0?r=0:r>x&&(a=r>x+3,r=x);const p=2**r;return{pyramidLevel:r,pyramidResolution:new f.Z({x:p*t.nativePixelSize.x,y:p*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:a}}function Q(e,t,n=!1){const{pixelSize:i,extent:o}=e,r=b(o,t,!1),a=Z(function(e,t){const n=e.clone().normalize();return 1===n.length?n[0]:I(n,t)}(o,(i.x+i.y)/16),t,r);return n||0===Y(a)?a:j(o,t,r)}function $(e,t,n){const i=n?.tileSize??512,o=n?.alignGlobalDatasetWithAGOL??!0,r=!!n?.limitToSrcResolution,{extent:a,spatialReference:s,pixelSize:l}=e,c=T(l,t,a);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const f=(c.x+c.y)/2,u=k(f,t),m=t.isGeographic?256/i*295828763.7958547:256/i*591657527.591555;let x="vector-magdir"===e.dataType||"vector-uv"===e.dataType;const p=Q(e,t,!0),g=Math.min(Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2),Math.ceil(Math.log(m/2/u)/Math.LN2));if(!x&&o&&(t.isGeographic||t.isWebMercator)){const n=U(t);if(x=Y(p)>0||null!=n&&p.width>n/4,!x&&null!=n){let t=-1;if(g<3)t=2**g*f*i;else if(e.storageInfo){const{maximumPyramidLevel:n=0,pyramidScalingFactor:o=2}=e.storageInfo;t=o**n*f*i}const o=Math.ceil(n/t);x=1===o||2===o&&n/2-p.xmax<t}}let d,y=u;const w=1.001,M=Math.min(2,Math.max(1.414,e.storageInfo?.pyramidScalingFactor||2));if(x){y=m;const n=t.isGeographic?1341104507446289e-21:.29858214164761665,i=k(n,t),o=t.isGeographic?4326:3857;d=T({x:n,y:n},s,Q(e,new h.Z({wkid:o}),!0)),d.x*=y/i,d.y*=y/i}else{d={x:l.x,y:l.y};let e=0;for(;y<m*(w/2)&&e<g;)e++,y*=M,d.x*=M,d.y*=M;Math.max(y,m)/Math.min(y,m)<=w&&(y=m)}const R=[y],S=[{x:d.x,y:d.y}],_=Math.min(70.5310735,u)/w;for(;y>=_;)y/=M,d.x/=M,d.y/=M,R.push(y),S.push({x:d.x,y:d.y});if(r){const e=.001*l.x;let t=S.findIndex((t=>t.x>=l.x-e&&t.x<=l.x+e));t>-1?(S.length=t+1,R.length=t+1):(t=S.findIndex((t=>t.x<=l.x+e)),t>0&&(S.length=t,R.length=t))}return{projectedPixelSize:c,scales:R,srcResolutions:S,isCustomTilingScheme:!x}}},10054:(e,t,n)=>{n.d(t,{Br:()=>l,Fm:()=>x,N9:()=>g,RA:()=>d,Tc:()=>f,Ue:()=>u,iC:()=>c,s9:()=>s,v:()=>p,xW:()=>h,zS:()=>m});var i=n(84164),o=n(91907),r=n(43487),a=n(80479);function s(e,t,n="nearest",i=!1){const s=!(i&&"u8"===t.pixelType),l=s?o.Br.FLOAT:o.Br.UNSIGNED_BYTE,c=null==t.pixels||0===t.pixels.length?null:s?t.getAsRGBAFloat():t.getAsRGBA(),f=e.capabilities.textureFloatLinear,u=new a.X;return u.width=t.width,u.height=t.height,u.internalFormat=s?o.lP.RGBA32F:o.VI.RGBA,u.samplingMode=!f||"bilinear"!==n&&"cubic"!==n?o.cw.NEAREST:o.cw.LINEAR,u.dataType=l,u.wrapMode=o.e8.CLAMP_TO_EDGE,new r.x(e,u,c)}function l(e,t){const{spacing:n,offsets:i,coefficients:s,size:[l,c]}=t,f=n[0]>1,u=new a.X;u.width=f?4*l:l,u.height=c,u.internalFormat=o.lP.RGBA32F,u.dataType=o.Br.FLOAT,u.samplingMode=o.cw.NEAREST,u.wrapMode=o.e8.CLAMP_TO_EDGE;const m=new Float32Array(f?l*c*16:2*i.length);if(f&&null!=s)for(let e=0,t=0;e<s.length;e++)m[t++]=s[e],e%3==2&&(m[t++]=1);else for(let e=0;e<c;e++)for(let t=0;t<l;t++){const n=4*(e*l+t),o=2*(t*c+e);m[n]=i[o],m[n+1]=i[o+1],m[n+3]=-1===i[o]?0:1}return new r.x(e,u,m)}function c(e,t){const n=new a.X;return n.internalFormat=o.VI.RGBA,n.width=t.length/4,n.height=1,n.samplingMode=o.cw.NEAREST,n.wrapMode=o.e8.CLAMP_TO_EDGE,new r.x(e,n,t)}function f(e,t,n,o=1,r=!0){return{u_flipY:r,u_applyTransform:!!e,u_opacity:o,u_transformSpacing:e?e.spacing:i.AG,u_transformGridSize:e?e.size:i.AG,u_targetImageSize:t,u_srcImageSize:n}}function u(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function m(e,t){return{u_scale:e,u_offset:t}}function h(e){return{u_bandCount:e.bandCount,u_minOutput:e.minOutput,u_maxOutput:e.maxOutput,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function x(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function p(e,t){const n=e.gl,i=t.glName,o=new Map;if(null==i)return o;const r=n.getProgramParameter(i,n.ACTIVE_UNIFORMS);let a;for(let e=0;e<r;e++)a=n.getActiveUniform(i,e),a&&o.set(a.name,{location:n.getUniformLocation(i,a.name),info:a});return o}function g(e,t,n){Object.keys(n).forEach((i=>{const r=t.get(i)||t.get(i+"[0]");r&&function(e,t,n,i){if(null===i||null==n)return!1;const{info:r}=i;switch(r.type){case o.Se.FLOAT:r.size>1?e.setUniform1fv(t,n):e.setUniform1f(t,n);break;case o.Se.FLOAT_VEC2:e.setUniform2fv(t,n);break;case o.Se.FLOAT_VEC3:e.setUniform3fv(t,n);break;case o.Se.FLOAT_VEC4:e.setUniform4fv(t,n);break;case o.Se.FLOAT_MAT3:e.setUniformMatrix3fv(t,n);break;case o.Se.FLOAT_MAT4:e.setUniformMatrix4fv(t,n);break;case o.Se.INT:r.size>1?e.setUniform1iv(t,n):e.setUniform1i(t,n);break;case o.Se.BOOL:e.setUniform1i(t,n?1:0);break;case o.Se.INT_VEC2:case o.Se.BOOL_VEC2:e.setUniform2iv(t,n);break;case o.Se.INT_VEC3:case o.Se.BOOL_VEC3:e.setUniform3iv(t,n);break;case o.Se.INT_VEC4:case o.Se.BOOL_VEC4:e.setUniform4iv(t,n);break;default:return!1}}(e,i,n[i],r)}))}function d(e,t,n,i){n.length===i.length&&(i.some((e=>null==e))||n.some((e=>null==e))||n.forEach(((n,o)=>{t.setUniform1i(n,o),e.bindTexture(i[o],o)})))}}}]);
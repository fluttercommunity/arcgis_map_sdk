"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[45224],{2790:(e,t,i)=>{i.d(t,{k:()=>R});var r=i(31355),s=i(86717),n=i(81095),o=i(56999),a=i(52721),l=i(22349),h=i(37116),c=i(92570),d=i(98196),u=i(83772),p=i(74710),_=i(468),f=i(54221),g=i(29642),v=i(24370),m=i(41942),y=i(7358),w=i(13304),b=i(21414),C=i(65392);class R extends _.i{constructor(e){super(e),this._attachmentOrigin=(0,d.T)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new r.Z,this._geometry=null,this._width=1,this._color=(0,a.al)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,a.al)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=y.yD.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new f.W({view:e.view,isDecoration:e.isDecoration}),this.applyProperties(e),this.attached=e.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:E,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)}}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:E,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,o.a)(e,this._color)||((0,o.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,o.a)(e,this._innerColor)||((0,o.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,o.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,a.d9)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=this.object3dResources.resources?.geometries;if(!e||0===e.length)return null;(0,s.i)(D,0,0,0);let t=0;for(const i of e)i.computeAttachmentOrigin(P)&&((0,s.g)(D,D,P),t++);return 0===t?null:((0,s.h)(D,D,1/t),this.view.renderCoordsHelper.fromRenderCoords(D,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){this.object3dResources.resources?.material.setParameters(this._materialParameters),this.drapedResources.resources?.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===y.yD.OccludeAndTransparentStencil?y.yD.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,i){this._createRenderGeometries(t,i);for(const t of i)e.addGeometry(t);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new C.U(this._materialParameters),i=new Array;return this._recreateGeometry(e,t,i),{material:t,geometries:i,forEach:e=>{e(t),i.forEach(e)}}}_createDrapedResources(){const e=new C.U(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:i}=this,r=i.basemapTerrain.spatialReference;return null==t||null==r?[]:(0,m.r)(t,r).lines.map((({position:t})=>{const s={overlayInfo:{spatialReference:r,renderCoordsHelper:i.renderCoordsHelper},attributeData:{position:t},removeDuplicateStartEnd:this._isClosed};return new w.z((0,v.Y)(e,s))}))}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const i of this.object3dResources.resources.geometries){const r=i.attributes.get(b.T.POSITION),s=(0,c.bg)(r.data.length);(0,l.projectBuffer)(r.data,t.spatialReference,0,s,this.view.spatialReference,0),(0,h.G1)(e,s)}return!0}_createRenderGeometries(e,t){const i=this.geometry;if(null==i)return;const r=(0,m.V)(i,this.view.elevationProvider,this.view.renderCoordsHelper,g.o.fromElevationInfo(this.elevationInfo??new p.Z({mode:(0,u.VW)(i,null)}))),s=new Array;for(const{position:i,mapPositions:n}of r.lines){const r={mapPositions:n,attributeData:{position:i},removeDuplicateStartEnd:this._isClosed};t.push((0,v.Y)(e,r)),s.push(i)}this._laserline.pathVerticalPlane=s}}function E(e){e.geometries=[]}const P=(0,n.Ue)(),D=(0,n.Ue)()},76169:(e,t,i)=>{i.d(t,{l:()=>s});i(39994);var r=i(76868);class s{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,r.YP)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const i in e)i in this&&("attached"===i?t=!!e[i]:this[i]=e[i]);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},75354:(e,t,i)=>{i.d(t,{F:()=>a});var r=i(36663),s=i(31355),n=i(81977),o=(i(39994),i(13802),i(4157),i(40266));let a=class extends s.Z.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.error=null,this.isDraped=!1}};(0,r._)([(0,n.Cb)({constructOnly:!0})],a.prototype,"graphic",void 0),(0,r._)([(0,n.Cb)()],a.prototype,"tracking",void 0),(0,r._)([(0,n.Cb)()],a.prototype,"displaying",void 0),(0,r._)([(0,n.Cb)()],a.prototype,"error",void 0),(0,r._)([(0,n.Cb)()],a.prototype,"isDraped",void 0),a=(0,r._)([(0,o.j)("esri.views.3d.layers.graphics.GraphicState")],a)},24370:(e,t,i)=>{i.d(t,{Y:()=>g,c:()=>y});var r=i(36531),s=i(84164),n=i(52721),o=i(69442),a=i(12487),l=i(92570),h=i(31725),c=i(35914),d=i(65684),u=i(85799),p=i(95399),_=i(63885),f=i(21414);function g(e,t,i=null){const s=[],g=t.mapPositions;!function(e,t){const{attributeData:{position:i},removeDuplicateStartEnd:r}=e,s=function(e){const t=e.length;return e[0]===e[t-3]&&e[1]===e[t-2]&&e[2]===e[t-1]}(i)&&r,n=i.length/3-(s?1:0),o=new Array(2*(n-1)),a=s?i.slice(0,-3):i;let l=0;for(let e=0;e<n-1;e++)o[l++]=e,o[l++]=e+1;t.push([f.T.POSITION,new u.a(a,o,3,s)])}(t,s);const y=s[0][1].data,w=s[0][1].indices.length,b=(0,c.LE)(w);return function(e,t,i){if(null!=e.attributeData.colorFeature)return;const r=e.attributeData.color;t.push([f.T.COLOR,new u.a(r??n.hq,i,4)])}(t,s,b),function(e,t,i){null==e.attributeData.sizeFeature&&t.push([f.T.SIZE,new u.a([e.attributeData.size??1],i,1,!0)])}(t,s,b),function(e,t,i){e.attributeData.normal&&t.push([f.T.NORMAL,new u.a(e.attributeData.normal,i,3)])}(t,s,b),function(e,t,i){null!=e.attributeData.colorFeature&&t.push([f.T.COLORFEATUREATTRIBUTE,new u.a([e.attributeData.colorFeature],i,1,!0)])}(t,s,b),function(e,t,i){null!=e.attributeData.sizeFeature&&t.push([f.T.SIZEFEATUREATTRIBUTE,new u.a([e.attributeData.sizeFeature],i,1,!0)])}(t,s,b),function(e,t,i){null!=e.attributeData.opacityFeature&&t.push([f.T.OPACITYFEATUREATTRIBUTE,new u.a([e.attributeData.opacityFeature],i,1,!0)])}(t,s,b),function(e,t,i){if(null==e.overlayInfo||e.overlayInfo.renderCoordsHelper.viewingMode!==d.JY.Global||!e.overlayInfo.spatialReference.isGeographic)return;const s=(0,l.bg)(i.length),n=(0,o.Iu)(e.overlayInfo.spatialReference);for(let e=0;e<s.length;e+=3)(0,a.gH)(i,e,s,e,n);const c=i.length/3,p=(0,h.xx)(c+1);let _=v,g=m,y=0,w=0;(0,r.t8)(_,s[w++],s[w++]),w++,p[0]=0;for(let e=1;e<c+1;++e)e===c&&(w=0),(0,r.t8)(g,s[w++],s[w++]),w++,y+=(0,r.TK)(_,g),p[e]=y,[_,g]=[g,_];t.push([f.T.DISTANCETOSTART,new u.a(p,t[0][1].indices,1,!0)])}(t,s,y),new _.Z(e,s,g,p.U.Line,i)}const v=(0,s.Ue)(),m=(0,s.Ue)();function y(e,t){if(null==e||0===e.length)return[];const i=[];return e.forEach((e=>{const r=e.length,s=(0,l.bg)(3*r);e.forEach(((e,t)=>{s[3*t]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const n={attributeData:{position:s,normal:t},removeDuplicateStartEnd:!1};i.push(n)})),i}},41942:(e,t,i)=>{i.d(t,{V:()=>l,r:()=>h});var r=i(22349),s=i(92570),n=i(35413),o=i(63669),a=i(26646);function l(e,t,i,r){const a="polygon"===e.type?n.ZI.CCW_IS_HOLE:n.ZI.NONE,l="polygon"===e.type?e.rings:e.paths,{position:h,outlines:d}=(0,n.Ni)(l,!!e.hasZ,a,e.spatialReference),u=(0,s.bg)(h.length),p=(0,o.rR)(h,e.spatialReference,0,u,0,h,0,h.length/3,t,i,r),_=null!=p;return{lines:_?c(d,h,u):[],projectionSuccess:_,sampledElevation:p}}function h(e,t){const i="polygon"===e.type?n.ZI.CCW_IS_HOLE:n.ZI.NONE,s="polygon"===e.type?e.rings:e.paths,{position:o,outlines:l}=(0,n.Ni)(s,!1,i),h=(0,r.projectBuffer)(o,e.spatialReference,0,o,t,0);for(let e=2;e<o.length;e+=3)o[e]=a.gi;return{lines:h?c(l,o):[],projectionSuccess:h}}function c(e,t,i=null){const r=new Array;for(const{index:n,count:o}of e){if(o<=1)continue;const e=3*n,a=3*o;r.push({position:(0,s.Rq)(t,3*n,3*o),mapPositions:null!=i?(0,s.Rq)(i,e,a):void 0})}return r}},63084:(e,t,i)=>{i.r(t),i.d(t,{ElevationProfileView3D:()=>T});var r=i(44584),s=i(61681),n=i(76868),o=i(89815),a=i(55109),l=i(67979),h=i(23148),c=i(78668),d=i(83772),u=i(13540),p=i(2790),_=i(75354),f=i(7358),g=i(42780);class v{constructor(e){this._params=e,this._highlightTask=null,this._highlightHandle=null,this._visualElementHandle=null,this._settings=new u.Z({getTheme:()=>this._params.view.effectiveTheme})}destroy(){this.remove()}remove(){this._highlightTask=(0,s.IM)(this._highlightTask),this._highlightHandle=(0,s.hw)(this._highlightHandle),this._visualElementHandle=(0,s.hw)(this._visualElementHandle)}showHighlight(e){if(this.remove(),null==e||!m(e))return;const t=e.layer;this._highlightTask=(0,l.vr)((async i=>{const r=await this._params.view.whenLayerView(t);(0,c.k_)(i),(0,g.tl)(r)&&(this._highlightHandle=r.highlight(e))}))}showReshaping(e){if(this.remove(),null==e)return;const t=this._params.view,i=new p.k({view:t,geometry:m(e)?e.geometry:null,attached:!1,elevationInfo:(0,d.RL)(e),renderOccluded:f.yD.OccludeAndTransparentStencil,isDecoration:!0}),r=new _.F({graphic:e}),s=[(0,n.YP)((()=>r.isDraped),(e=>{i.isDraped=e})),r.on("changed",(()=>{i.geometry=m(e)?e.geometry:null})),t.trackGraphicState(r),t.maskOccludee(e),(0,h.ed)(i)];this._settings.visualElements.lineObjects.outline.apply(i),i.attached=!0,this._visualElementHandle=(0,h.AL)(s)}}function m(e){return null!=e.geometry&&"polyline"===e.geometry.type}var y=i(36663),w=i(30936),b=i(74396),C=i(618),R=i(81977),E=(i(39994),i(13802),i(4157),i(40266)),P=i(52721),D=i(91792);let O=class extends b.Z{constructor(e){super(e),this._chartData=null,this._visualElements=[],this._update=e=>{const{chartData:t}=e;if(null==t)return this.remove();if(!t.refined)return;const i=this._visualElements,r=t.lines.filter((e=>e.viewVisualizationEnabled)),s=r.length;for(;i.length>s;)i.pop().destroy();const n=(0,o.iE)().profileLinesStyle3D;for(;i.length<s;){const e=new p.k({view:this.view,elevationInfo:{mode:"absolute-height",offset:0},innerWidth:n.innerWidth,innerColor:n.innerColor,width:n.width,falloff:n.falloff,renderOccluded:n.renderOccluded,isDecoration:!0});i.push(e)}const a=e.spatialReference;for(let e=0;e<s;++e){const t=i[e],n=r[s-1-e];t.geometry=(0,D.L)(n,a),t.color=(0,P.nI)(w.Z.toUnitRGBA(n.color))}}}initialize(){const e=(0,o.iE)().profileLinesUpdateThrottleMillis;let t=this._update;if(e>0){const i=(0,C.P)(this._update,e);this.addHandles(i),t=i}this.addHandles([(0,n.YP)((()=>({spatialReference:this.view.spatialReference,chartData:this._chartData})),t,n.tX)])}destroy(){this._destroyVisualElements()}remove(){this._destroyVisualElements()}update(e){this._chartData=e}_destroyVisualElements(){this._visualElements.forEach((e=>e.destroy())),this._visualElements.length=0}};(0,y._)([(0,R.Cb)()],O.prototype,"view",void 0),(0,y._)([(0,R.Cb)()],O.prototype,"_chartData",void 0),O=(0,y._)([(0,E.j)("esri.widgets.ElevationProfile.support.ProfileLines3D")],O);class T{constructor(e,t){this._handles=new r.Z,this._inputRepresentation=new v({view:e}),this._hoveredPoints=new a.l({view:e}),this._profileLines=new O({view:e}),this._handles.add([(0,n.YP)((()=>t.viewModel.hoveredPoints),(e=>this._hoveredPoints.update(e)),n.tX),(0,n.YP)((()=>{const{state:e,editable:i,highlightEnabled:r,viewModel:s}=t,n=s.input;return n&&(n.commitProperty("geometry"),n.commitProperty("layer")),{input:n,state:e,editable:i,highlightEnabled:r}}),(e=>this._updateInputRepresentation(e)),n.tX),(0,n.YP)((()=>t.viewModel.chartData),(e=>this._profileLines.update(e)),n.tX),(0,n.YP)((()=>t.viewModel.input?.geometry),(()=>{this._profileLines.remove()}),n.tX)])}destroy(){this._handles=(0,s.SC)(this._handles),this._inputRepresentation=(0,s.SC)(this._inputRepresentation),this._hoveredPoints=(0,s.SC)(this._hoveredPoints),this._profileLines=(0,s.SC)(this._profileLines)}_updateInputRepresentation({input:e,state:t,editable:i,highlightEnabled:r}){const s=this._inputRepresentation;if(!r)return s.remove();t===o.dd.Selected?s.showHighlight(e):t!==o.dd.Created||i?s.remove():s.showReshaping(e)}}},55109:(e,t,i)=>{i.d(t,{l:()=>d});var r=i(36663),s=i(74396),n=i(41831),o=i(76868),a=i(81977),l=(i(39994),i(13802),i(4157),i(40266)),h=i(89815),c=i(83097);let d=class extends s.Z{constructor(e){super(e),this._hoveredPoints=new n.Z}initialize(){this.addHandles((0,o.YP)((()=>this._hoveredPoints.toArray().map((({anchor:e,element:t})=>({screenLocation:e.screenLocation,element:t})))),(e=>{for(const{screenLocation:t,element:i}of e)t&&(i.style.transform=`translate(${t.x}px, ${t.y}px)`)}),o.tX))}destroy(){this._hoveredPoints.drain((e=>this._destroyHoveredPoint(e)))}update(e){const t=this.view,i=this._hoveredPoints,r=e.length;for(;this._hoveredPoints.length>r;)this._destroyHoveredPoint(this._hoveredPoints.pop());for(;this._hoveredPoints.length<r;){const e=this._makeHoveredPoint();i.push(e),t.surface?.appendChild(e.element)}for(let t=0;t<r;++t){const s=i.at(r-1-t),n=e[t];this._updateHoveredPoint(s,n)}}_makeHoveredPoint(){const{size:e,borderStyle:t,borderColor:i,borderWidth:r,boxShadow:s}=(0,h.iE)().hoveredPointsStyle,n=this.view,o=new c.Z({view:n,screenLocationEnabled:!0}),a=document.createElement("div"),l=a.style;return l.position="absolute",l.top="0",l.left="0",l.contain="strict",l.boxSizing="border-box",l.width=`${e}px`,l.height=`${e}px`,l.marginTop=`-${e/2}px`,l.marginLeft=`-${e/2}px`,l.border=`${t} ${r}px ${i}`,l.borderRadius=`${e}px`,l.boxShadow=s,{anchor:o,element:a}}_updateHoveredPoint({anchor:e,element:t},i){e.screenLocationEnabled=!0,e.location=i.hoveredPoint;const r=t.style;r.display="block",r.background=i.color.toCss()}_destroyHoveredPoint({anchor:e,element:t}){e.destroy(),this.view.surface?.removeChild(t)}};(0,r._)([(0,a.Cb)()],d.prototype,"view",void 0),(0,r._)([(0,a.Cb)()],d.prototype,"_hoveredPoints",void 0),d=(0,r._)([(0,l.j)("esri.widgets.ElevationProfile.support.HoveredPoints")],d)},91792:(e,t,i)=>{i.d(t,{L:()=>s});var r=i(90819);function s(e,t){const i=e.samples??[],s=i.length-1,n=[];let o=[];for(let e=0;e<=s;e++){const{x:t,y:r,z:a}=i[e];null!=a&&o.push([t,r,a]),e!==s&&null!=a||!o.length||(n.push(o),o=[])}return new r.Z({paths:n,hasZ:!0,spatialReference:t})}},83097:(e,t,i)=>{i.d(t,{Z:()=>c});var r=i(36663),s=i(31355),n=i(76868),o=i(81977),a=(i(39994),i(13802),i(4157),i(40266)),l=i(90472);let h=class extends s.Z.EventedAccessor{constructor(e){super(e),this.location=null,this.screenLocationEnabled=!1,this.view=null,this.addHandles([(0,n.gx)((()=>{const e=this.screenLocationEnabled?this.view:null;return e?[e.size,"3d"===e.type?e.camera:e.viewpoint]:null}),(()=>this.notifyChange("screenLocation"))),(0,n.YP)((()=>this.screenLocation),((e,t)=>{null!=e&&null!=t&&this.emit("view-change")}))])}destroy(){this.view=null}get screenLocation(){const{location:e,view:t,screenLocationEnabled:i}=this,r=t?.spatialReference,s=r?(0,l.projectOrLoad)(e,r).geometry:null;return i&&s&&t?.ready?t.toScreen(s):null}};(0,r._)([(0,o.Cb)()],h.prototype,"location",void 0),(0,r._)([(0,o.Cb)()],h.prototype,"screenLocation",null),(0,r._)([(0,o.Cb)()],h.prototype,"screenLocationEnabled",void 0),(0,r._)([(0,o.Cb)()],h.prototype,"view",void 0),h=(0,r._)([(0,a.j)("esri.widgets.support.AnchorElementViewModel")],h);const c=h}}]);
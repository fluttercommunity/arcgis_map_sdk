"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[75400,76386,82976],{82976:(e,t,n)=>{n.r(t),n.d(t,{EdgeInputBufferLayout:()=>r,RegularEdgeInstancesLayout:()=>d,SilhouetteEdgeInstancesLayout:()=>u,VertexLayout:()=>a,glVertexLayout:()=>c,vertexAttributeLocations:()=>l});var o=n(95397),s=n(44685),i=n(21414);const r=(0,s.U$)().vec3f(i.T.POSITION).u16(i.T.COMPONENTINDEX).freeze(),a=(0,s.U$)().vec2u8(i.T.SIDENESS).freeze(),c=(0,o.K)(a),d=(0,s.U$)().vec3f(i.T.POSITION0).vec3f(i.T.POSITION1).vec2i16(i.T.NORMALCOMPRESSED).u16(i.T.COMPONENTINDEX).u8(i.T.VARIANTOFFSET,{glNormalized:!0}).u8(i.T.VARIANTSTROKE).u8(i.T.VARIANTEXTENSION,{glNormalized:!0}).freeze(),u=(0,s.U$)().vec3f(i.T.POSITION0).vec3f(i.T.POSITION1).vec2i16(i.T.NORMALCOMPRESSED).vec2i16(i.T.NORMAL2COMPRESSED).u16(i.T.COMPONENTINDEX).u8(i.T.VARIANTOFFSET,{glNormalized:!0}).u8(i.T.VARIANTSTROKE).u8(i.T.VARIANTEXTENSION,{glNormalized:!0}).freeze(),l=new Map([[i.T.POSITION0,0],[i.T.POSITION1,1],[i.T.COMPONENTINDEX,2],[i.T.VARIANTOFFSET,3],[i.T.VARIANTSTROKE,4],[i.T.VARIANTEXTENSION,5],[i.T.NORMALCOMPRESSED,6],[i.T.NORMAL2COMPRESSED,7],[i.T.SIDENESS,8]])},68083:(e,t,n)=>{n.d(t,{D:()=>m,q:()=>I});var o=n(4157),s=n(86717),i=n(81095),r=n(95397),a=n(59633),c=n(82976);class d{updateSettings(e){this.settings=e,this._edgeHashFunction=e.reducedPrecision?f:h}write(e,t,n){N.seed=this._edgeHashFunction(n);const o=N.getIntRange(0,255),s=N.getIntRange(0,this.settings.variants-1),i=N.getFloat(),r=255*(.5*function(e,t){return Math.abs(e)**t*Math.sign(e)}(-(1-Math.min(i/.7,1))+Math.max(0,i-.7)/(1-.7),1.2)+.5);e.position0.setVec(t,n.position0),e.position1.setVec(t,n.position1),e.componentIndex.set(t,n.componentIndex),e.variantOffset.set(t,o),e.variantStroke.set(t,s),e.variantExtension.set(t,r)}}const u=new Float32Array(6),l=new Uint32Array(u.buffer),g=new Uint32Array(1);function h(e){return u[0]=e.position0[0],u[1]=e.position0[1],u[2]=e.position0[2],u[3]=e.position1[0],u[4]=e.position1[1],u[5]=e.position1[2],g[0]=31*(31*(31*(31*(31*(166811+l[0])+l[1])+l[2])+l[3])+l[4])+l[5],g[0]}function f(e){const t=u;t[0]=p(e.position0[0]),t[1]=p(e.position0[1]),t[2]=p(e.position0[2]),t[3]=p(e.position1[0]),t[4]=p(e.position1[1]),t[5]=p(e.position1[2]),g[0]=5381;for(let e=0;e<l.length;e++)g[0]=31*g[0]+l[e];return g[0]}function p(e){return Math.round(1e4*e)/1e4}class m{constructor(){this._commonWriter=new d}updateSettings(e){this._commonWriter.updateSettings(e)}allocate(e){return c.RegularEdgeInstancesLayout.createBuffer(e)}write(e,t,n){this._commonWriter.write(e,t,n),(0,s.g)(T,n.faceNormal0,n.faceNormal1),(0,s.n)(T,T);const{typedBuffer:o,typedBufferStride:i}=e.normalCompressed;(0,a.hd)(o,t,T[0],T[1],T[2],i)}}m.Layout=c.RegularEdgeInstancesLayout,m.glLayout=(0,r.K)(c.RegularEdgeInstancesLayout,1);class I{constructor(){this._commonWriter=new d}updateSettings(e){this._commonWriter.updateSettings(e)}allocate(e){return c.SilhouetteEdgeInstancesLayout.createBuffer(e)}write(e,t,n){this._commonWriter.write(e,t,n);{const{typedBuffer:o,typedBufferStride:s}=e.normalCompressed;(0,a.hd)(o,t,n.faceNormal0[0],n.faceNormal0[1],n.faceNormal0[2],s)}{const{typedBuffer:o,typedBufferStride:s}=e.normal2Compressed;(0,a.hd)(o,t,n.faceNormal1[0],n.faceNormal1[1],n.faceNormal1[2],s)}}}I.Layout=c.SilhouetteEdgeInstancesLayout,I.glLayout=(0,r.K)(c.SilhouetteEdgeInstancesLayout,1);const T=(0,i.Ue)(),N=new o.Z},31511:(e,t,n)=>{n.d(t,{n:()=>a});var o=n(19431),s=n(17135),i=n(86717),r=n(81095);function a(e,t,n){const o=e.vertices.position,s=e.vertices.componentIndex,r=f.position0,a=f.position1,u=f.faceNormal0,g=f.faceNormal1,{edges:h,normals:p}=d(e),m=h.length/4,I=t.allocate(m);let T=0;const N=m,O=n?.allocate(N);let y=0,A=0,L=0;l.length=0;for(let e=0;e<m;++e){const t=4*e;o.getVec(h.data[t],r),o.getVec(h.data[t+1],a);const n=l.pushNew();n.index=4*e,n.length=(0,i.j)(r,a)}l.sort(((e,t)=>t.length-e.length));const _=new Array,v=new Array;l.forAll((({length:e,index:d})=>{const l=h.data[d],m=h.data[d+1],N=h.data[d+2],b=h.data[d+3],C=-1===b;if(o.getVec(l,r),o.getVec(m,a),C){const e=3*N;(0,i.i)(u,p.data[e],p.data[e+1],p.data[e+2]),(0,i.c)(g,u),f.componentIndex=s.get(l),f.cosAngle=(0,i.f)(u,g)}else{let e=3*N;if((0,i.i)(u,p.data[e],p.data[e+1],p.data[e+2]),e=3*b,(0,i.i)(g,p.data[e],p.data[e+1],p.data[e+2]),f.componentIndex=s.get(l),f.cosAngle=(0,i.f)(u,g),function(e,t){return e.cosAngle>t}(f,S))return;f.cosAngle<-.9999&&(0,i.c)(g,u)}A+=e,L++,C||function(e,t){return e.cosAngle<t}(f,w)?(t.write(I,T++,f),_.push(e)):c(f,E)&&(O&&n&&n.write(O,y++,f),v.push(e))}));const b=new Float32Array(_.reverse()),C=new Float32Array(v.reverse()),P=O&&n?{instancesData:O.slice(0,y),lodInfo:{lengths:C}}:void 0;return{regular:{instancesData:I.slice(0,T),lodInfo:{lengths:b}},silhouette:P,averageEdgeLength:A/L}}function c(e,t){const n=(0,o.ZF)(e.cosAngle);return(0,i.o)(m,e.position1,e.position0),n*((0,i.f)((0,i.e)(p,e.faceNormal0,e.faceNormal1),m)>0?-1:1)>t}function d(e){const t=e.faces.length/3,n=e.faces,o=e.neighbors,s=e.vertices.position;g.length=h.length=0;for(let e=0;e<t;e++){const t=3*e,r=o[t],a=o[t+1],c=o[t+2],d=n[t],u=n[t+1],l=n[t+2];s.getVec(d,I),s.getVec(u,T),s.getVec(l,N),(0,i.d)(T,T,I),(0,i.d)(N,N,I),(0,i.e)(I,T,N),(0,i.n)(I,I),h.pushArray(I),(-1===r||d<u)&&(g.push(d),g.push(u),g.push(e),g.push(r)),(-1===a||u<l)&&(g.push(u),g.push(l),g.push(e),g.push(a)),(-1===c||l<d)&&(g.push(l),g.push(d),g.push(e),g.push(c))}return{edges:g,normals:h}}class u{constructor(){this.index=0,this.length=0}}const l=new s.Z({allocator:e=>e||new u,deallocator:null}),g=new s.Z({deallocator:null}),h=new s.Z({deallocator:null}),f=new class{constructor(){this.position0=(0,r.Ue)(),this.position1=(0,r.Ue)(),this.faceNormal0=(0,r.Ue)(),this.faceNormal1=(0,r.Ue)(),this.componentIndex=0,this.cosAngle=0}},p=(0,r.Ue)(),m=(0,r.Ue)(),I=(0,r.Ue)(),T=(0,r.Ue)(),N=(0,r.Ue)(),E=(0,o.Vl)(4),S=Math.cos(E),O=(0,o.Vl)(35),w=Math.cos(O)},76386:(e,t,n)=>{n.r(t),n.d(t,{extract:()=>u,extractComponentsEdgeLocationsLayout:()=>m,extractEdgeInformation:()=>l,extractEdgeLocationsLayout:()=>p});var o=n(67262);function s(e,t,n){const o=t/3,s=new Uint32Array(n+1),i=new Uint32Array(n+1),r=(e,t)=>{e<t?s[e+1]++:i[t+1]++};for(let t=0;t<o;t++){const n=e[3*t],o=e[3*t+1],s=e[3*t+2];r(n,o),r(o,s),r(s,n)}let a=0,c=0;for(let e=0;e<n;e++){const t=s[e+1],n=i[e+1];s[e+1]=a,i[e+1]=c,a+=t,c+=n}const d=new Uint32Array(6*o),u=s[n],l=(e,t,n)=>{if(e<t){const o=s[e+1]++;d[2*o]=t,d[2*o+1]=n}else{const o=i[t+1]++;d[2*u+2*o]=e,d[2*u+2*o+1]=n}};for(let t=0;t<o;t++){const n=e[3*t],o=e[3*t+1],s=e[3*t+2];l(n,o,t),l(o,s,t),l(s,n,t)}const g=(e,t)=>{const n=2*e,o=t-e;for(let e=1;e<o;e++){const t=d[n+2*e],o=d[n+2*e+1];let s=e-1;for(;s>=0&&d[n+2*s]>t;s--)d[n+2*s+2]=d[n+2*s],d[n+2*s+3]=d[n+2*s+1];d[n+2*s+2]=t,d[n+2*s+3]=o}};for(let e=0;e<n;e++)g(s[e],s[e+1]),g(u+i[e],u+i[e+1]);const h=new Int32Array(3*o),f=(t,n)=>t===e[3*n]?0:t===e[3*n+1]?1:t===e[3*n+2]?2:-1,p=(e,t)=>{const n=f(e,t);h[3*t+n]=-1},m=(e,t,n,o)=>{const s=f(e,t);h[3*t+s]=o;const i=f(n,o);h[3*o+i]=t};for(let e=0;e<n;e++){let t=s[e];const n=s[e+1];let o=i[e];const r=i[e+1];for(;t<n&&o<r;){const n=d[2*t],s=d[2*u+2*o];n===s?(m(e,d[2*t+1],s,d[2*u+2*o+1]),t++,o++):n<s?(p(e,d[2*t+1]),t++):(p(s,d[2*u+2*o+1]),o++)}for(;t<n;)p(e,d[2*t+1]),t++;for(;o<r;)p(d[2*u+2*o],d[2*u+2*o+1]),o++}return h}var i=n(44685),r=n(21414),a=n(82976),c=n(68083),d=n(31511);function u(e){const t=l(e.data,e.skipDeduplicate,e.indices,e.indicesLength);return h.updateSettings(e.writerSettings),f.updateSettings(e.writerSettings),(0,d.n)(t,h,f)}function l(e,t,n,i){if(t){const t=s(n,i,e.count);return new g(n,i,t,e)}const r=(0,o.d)(e.buffer,e.stride/4,{originalIndices:n,originalIndicesLength:i}),c=s(r.indices,i,r.uniqueCount);return{faces:r.indices,facesLength:r.indices.length,neighbors:c,vertices:a.EdgeInputBufferLayout.createView(r.buffer)}}class g{constructor(e,t,n,o){this.faces=e,this.facesLength=t,this.neighbors=n,this.vertices=o}}const h=new c.D,f=new c.q,p=(0,i.U$)().vec3f(r.T.POSITION0).vec3f(r.T.POSITION1),m=(0,i.U$)().vec3f(r.T.POSITION0).vec3f(r.T.POSITION1).u16(r.T.COMPONENTINDEX)},75400:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var o=n(36663),s=n(78668),i=(n(13802),n(39994),n(4157),n(70375),n(40266)),r=n(86717),a=n(81095),c=n(56215),d=n(73687),u=n(20766),l=n(76386);function g(e,t,n){const o=(0,d.c)(),s=(0,d.a)(o);return(0,r.b)(s,s,e,.5),(0,r.b)(s,s,t,.5),o[3]=(0,r.j)(s,e),(0,r.g)(s,s,n),o}let h=class{constructor(){this._idToComponent=new Map,this._components=new u.Z((e=>e.bounds)),this._edges=new u.Z((e=>e.bounds)),this._tmpLineSegment=(0,c.Ue)(),this._tmpP1=(0,a.Ue)(),this._tmpP2=(0,a.Ue)(),this._tmpP3=(0,a.Ue)(),this.remoteClient=null}async fetchCandidates(e,t){await Promise.resolve(),(0,s.k_)(t),await this._ensureEdgeLocations(e,t);const n=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,n),n.length<1e3)),e.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(e,t){const n=[];if(this._components.forEachNeighbor((e=>{if(null==e.info){const{id:t,uid:o}=e;n.push({id:t,uid:o})}return!0}),e.bounds),!n.length)return;const o={components:n},s=await this.remoteClient.invoke("fetchAllEdgeLocations",o,t??{});for(const e of s.components)this._setFetchEdgeLocations(e)}async add(e){const t=new m(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((n=>(n.component===t&&e.push(n),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const t=this._idToComponent.get(e.id);if(null==t||e.uid!==t.uid)return;const n=l.extractComponentsEdgeLocationsLayout.createView(e.locations),o=new Array(n.count),s=(0,a.Ue)(),i=(0,a.Ue)();for(let r=0;r<n.count;r++){n.position0.getVec(r,s),n.position1.getVec(r,i);const a=g(s,i,e.origin),c=new I(t,r,a);o[r]=c}this._edges.add(o);const{objectIds:r,origin:c}=e;t.info={locations:n,objectIds:r,origin:c}}_addCandidates(e,t,n){const{info:o}=t.component,{origin:s,objectIds:i}=o,a=o.locations,c=a.position0.getVec(t.index,this._tmpP1),d=a.position1.getVec(t.index,this._tmpP2);(0,r.g)(c,c,s),(0,r.g)(d,d,s);const u=i[a.componentIndex.get(t.index)];this._addEdgeCandidate(e,u,c,d,n),p(e,u,c,n),p(e,u,d,n)}_addEdgeCandidate(e,t,n,o,s){if(!e.returnEdge)return;const i=(0,d.a)(e.bounds),u=(0,c.zk)(n,o,this._tmpLineSegment),l=(0,c.nF)(u,i,this._tmpP3);(0,d.o)(e.bounds,l)&&s.push({type:"edge",objectId:t,target:(0,a.d9)(l),distance:(0,r.j)(i,l),start:(0,a.d9)(n),end:(0,a.d9)(o)})}};h=(0,o._)([(0,i.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],h);const f=h;function p(e,t,n,o){if(!e.returnVertex||!(0,d.o)(e.bounds,n))return;const s=(0,d.a)(e.bounds);o.push({type:"vertex",objectId:t,target:(0,a.d9)(n),distance:(0,r.j)(s,n)})}class m{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++m.uid}}m.uid=0;class I{constructor(e,t,n){this.component=e,this.index=t,this.bounds=n}}}}]);
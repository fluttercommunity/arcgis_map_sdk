"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[25434],{97622:(e,t,i)=>{i.d(t,{Z:()=>m});var n=i(36663),s=i(8400),r=i(41151),a=i(16068),o=i(82064),l=i(81977),c=i(69236),d=(i(39994),i(4157),i(40266)),u=i(7283),p=i(10186);let h=class extends(o.Z.JSONSupportMixin(r.Z)){constructor(e){super(e),this.type="length",this.startPoint=null,this.endPoint=null,this.measureType=s.n.Direct,this.offset=0,this.orientation=0}};(0,n._)([(0,l.Cb)({type:["length"],json:{write:{isRequired:!0}}})],h.prototype,"type",void 0),(0,n._)([(0,l.Cb)({type:p.Z,json:{write:{isRequired:!0}}})],h.prototype,"startPoint",void 0),(0,n._)([(0,l.Cb)({type:p.Z,json:{write:{isRequired:!0}}})],h.prototype,"endPoint",void 0),(0,n._)([(0,l.Cb)({type:s.V,nonNullable:!0,json:{write:{isRequired:!0}}})],h.prototype,"measureType",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],h.prototype,"offset",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,c.p)((e=>a.BV.normalize((0,u.q9)(e),0,!0)))],h.prototype,"orientation",void 0),h=(0,n._)([(0,d.j)("esri.analysis.LengthDimension")],h);const m=h},8400:(e,t,i)=>{var n;i.d(t,{V:()=>s,n:()=>n}),function(e){e.Horizontal="horizontal",e.Vertical="vertical",e.Direct="direct"}(n||(n={}));const s=[n.Horizontal,n.Vertical,n.Direct]},6415:(e,t,i)=>{i.d(t,{I:()=>y,a:()=>v,b:()=>g});var n=i(35031),s=i(5885),r=i(4731),a=i(78950),o=i(94880),l=i(32394),c=i(84614),d=i(24603),u=i(20200),p=i(15176),h=i(21414),m=i(82050),_=i(86765),f=i(9229);class v extends _.K{}function g(e){const t=new f.kG,{vertex:i,fragment:_}=t,{output:v,perspectiveInterpolation:g}=e;return(0,c.Sv)(i,e),t.include(r.w,e),t.include(o.H,e),t.fragment.include(s.f5,e),t.include(a.R,e),t.include(m.j,e),t.attributes.add(h.T.POSITION,"vec3"),t.attributes.add(h.T.UV0,"vec2"),g&&t.attributes.add(h.T.PERSPECTIVEDIVIDE,"float"),i.main.add(u.H`
    vpos = position;
    forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);
    vTexCoord = uv0;
    gl_Position = transformPosition(proj, view, vpos);
    ${(0,u.If)(g,"gl_Position *= perspectiveDivide;")}`),t.varyings.add("vpos","vec3"),t.varyings.add("vTexCoord","vec2"),_.include(l.Y),_.uniforms.add(new d.p("opacity",(e=>e.opacity)),new p.A("tex",(e=>e.texture))).main.add(u.H`
    discardBySlice(vpos);
    discardByTerrainDepth();
    ${(0,u.If)(v===n.H_.ObjectAndLayerIdColor,"fragColor = vec4(0, 0, 0, 1); return;")}
    vec4 finalColor = texture(tex, vTexCoord) * opacity;
    outputColorHighlightOID(finalColor, vpos);`),t}const y=Object.freeze(Object.defineProperty({__proto__:null,ImageMaterialPassParameters:v,build:g},Symbol.toStringTag,{value:"Module"}))},25625:(e,t,i)=>{i.d(t,{L:()=>T,b:()=>b});var n=i(6411),s=i(5885),r=i(65915),a=i(32560),o=i(27988),l=i(94880),c=i(32394),d=i(9794),u=i(84614),p=i(80670),h=i(80967),m=i(63371),_=i(49016),f=i(20200),v=i(61002),g=i(15176),y=i(21414),S=i(60997),w=i(82050),P=i(9229);function b(e){const t=new P.kG,{space:i,anchor:b,hasTip:T}=e,C=i===S.I9.World;t.include(r.U,e),t.include(o.Q,e),t.include(l.H,e);const{vertex:M,fragment:O}=t;O.include(d.n),(0,u.Sv)(M,e),t.attributes.add(y.T.POSITION,"vec3"),t.attributes.add(y.T.PREVPOSITION,"vec3"),t.attributes.add(y.T.UV0,"vec2"),t.varyings.add("vColor","vec4"),t.varyings.add("vpos","vec3"),t.varyings.add("vUV","vec2"),t.varyings.add("vSize","float"),T&&t.varyings.add("vLineWidth","float"),M.uniforms.add(new p.$("nearFar",(({camera:e})=>e.nearFar)),new h.$("viewport",(({camera:e})=>e.fullViewport))),M.code.add(f.H`vec4 projectAndScale(vec4 pos) {
vec4 posNdc = proj * pos;
posNdc.xy *= viewport.zw / posNdc.w;
return posNdc;
}`),M.code.add(f.H`void clip(vec4 pos, inout vec4 prev) {
float vnp = nearFar[0] * 0.99;
if (prev.z > -nearFar[0]) {
float interpolation = (-vnp - pos.z) / (prev.z - pos.z);
prev = mix(pos, prev, interpolation);
}
}`),C?(t.attributes.add(y.T.NORMAL,"vec3"),(0,u._8)(M),M.constants.add("tiltThreshold","float",.7),M.code.add(f.H`vec3 perpendicular(vec3 v) {
vec3 n = (viewNormal * vec4(normal.xyz, 1.0)).xyz;
vec3 n2 = cross(v, n);
vec3 forward = vec3(0.0, 0.0, 1.0);
float tiltDot = dot(forward, n);
return abs(tiltDot) < tiltThreshold ? n : n2;
}`)):M.code.add(f.H`vec2 perpendicular(vec2 v) {
return vec2(v.y, -v.x);
}`);const D=C?"vec3":"vec2";return M.code.add(f.H`
      ${D} normalizedSegment(${D} pos, ${D} prev) {
        ${D} segment = pos - prev;
        float segmentLen = length(segment);

        // normalize or zero if too short
        return (segmentLen > 0.001) ? segment / segmentLen : ${C?"vec3(0.0, 0.0, 0.0)":"vec2(0.0, 0.0)"};
      }

      ${D} displace(${D} pos, ${D} prev, float displacementLen) {
        ${D} segment = normalizedSegment(pos, prev);

        ${D} displacementDirU = perpendicular(segment);
        ${D} displacementDirV = segment;

        ${b===S.i5.Tip?"pos -= 0.5 * displacementLen * displacementDirV;":""}

        return pos + displacementLen * (uv0.x * displacementDirU + uv0.y * displacementDirV);
      }
    `),i===S.I9.Screen&&(M.uniforms.add(new v.C("inverseProjectionMatrix",(({camera:e})=>e.inverseProjectionMatrix))),M.code.add(f.H`vec3 inverseProject(vec4 posScreen) {
posScreen.xy = (posScreen.xy / viewport.zw) * posScreen.w;
return (inverseProjectionMatrix * posScreen).xyz;
}`),M.code.add(f.H`bool rayIntersectPlane(vec3 rayDir, vec3 planeOrigin, vec3 planeNormal, out vec3 intersection) {
float cos = dot(rayDir, planeNormal);
float t = dot(planeOrigin, planeNormal) / cos;
intersection = t * rayDir;
return abs(cos) > 0.001 && t > 0.0;
}`),M.uniforms.add(new _.z("perScreenPixelRatio",(({camera:e})=>e.perScreenPixelRatio))),M.code.add(f.H`
      vec4 toFront(vec4 displacedPosScreen, vec3 posLeft, vec3 posRight, vec3 prev, float lineWidth) {
        // Project displaced position back to camera space
        vec3 displacedPos = inverseProject(displacedPosScreen);

        // Calculate the plane that we want the marker to lie in. Note that this will always be an approximation since ribbon lines are generally
        // not planar and we do not know the actual position of the displaced prev vertices (they are offset in screen space, too).
        vec3 planeNormal = normalize(cross(posLeft - posRight, posLeft - prev));
        vec3 planeOrigin = posLeft;

        ${(0,f.If)(e.hasCap,"if(prev.z > posLeft.z) {\n                vec2 diff = posLeft.xy - posRight.xy;\n                planeOrigin.xy += perpendicular(diff) / 2.0;\n             }")};

        // Move the plane towards the camera by a margin dependent on the line width (approximated in world space). This tolerance corrects for the
        // non-planarity in most cases, but sharp joins can place the prev vertices at arbitrary positions so markers can still clip.
        float offset = lineWidth * perScreenPixelRatio;
        planeOrigin *= (1.0 - offset);

        // Intersect camera ray with the plane and make sure it is within clip space
        vec3 rayDir = normalize(displacedPos);
        vec3 intersection;
        if (rayIntersectPlane(rayDir, planeOrigin, planeNormal, intersection) && intersection.z < -nearFar[0] && intersection.z > -nearFar[1]) {
          return vec4(intersection.xyz, 1.0);
        }

        // Fallback: use depth of pos or prev, whichever is closer to the camera
        float minDepth = planeOrigin.z > prev.z ? length(planeOrigin) : length(prev);
        displacedPos *= minDepth / length(displacedPos);
        return vec4(displacedPos.xyz, 1.0);
      }
  `)),(0,u.ZI)(M),M.main.add(f.H`
    // Check for special value of uv0.y which is used by the Renderer when graphics
    // are removed before the VBO is recompacted. If this is the case, then we just
    // project outside of clip space.
    if (uv0.y == 0.0) {
      // Project out of clip space
      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
    }
    else {
      float lineWidth = getLineWidth();
      float screenMarkerSize = getScreenMarkerSize();

      vec4 pos  = view * vec4(position, 1.0);
      vec4 prev = view * vec4(prevPosition, 1.0);
      clip(pos, prev);

      ${C?f.H`${(0,f.If)(e.hideOnShortSegments,f.H`
                if (areWorldMarkersHidden(pos, prev)) {
                  // Project out of clip space
                  gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
                  return;
                }`)}
            pos.xyz = displace(pos.xyz, prev.xyz, getWorldMarkerSize(pos));
            vec4 displacedPosScreen = projectAndScale(pos);`:f.H`
            vec4 posScreen = projectAndScale(pos);
            vec4 prevScreen = projectAndScale(prev);
            vec4 displacedPosScreen = posScreen;

            displacedPosScreen.xy = displace(posScreen.xy, prevScreen.xy, screenMarkerSize);
            ${(0,f.If)(i===S.I9.Screen,f.H`
                vec2 displacementDirU = perpendicular(normalizedSegment(posScreen.xy, prevScreen.xy));

                // We need three points of the ribbon line in camera space to calculate the plane it lies in
                // Note that we approximate the third point, since we have no information about the join around prev
                vec3 lineRight = inverseProject(posScreen + lineWidth * vec4(displacementDirU.xy, 0.0, 0.0));
                vec3 lineLeft = pos.xyz + (pos.xyz - lineRight);

                pos = toFront(displacedPosScreen, lineLeft, lineRight, prev.xyz, lineWidth);
                displacedPosScreen = projectAndScale(pos);`)}`}
      forwardViewPosDepth(pos.xyz);
      // Convert back into NDC
      displacedPosScreen.xy = (displacedPosScreen.xy / viewport.zw) * displacedPosScreen.w;

      // Convert texture coordinate into [0,1]
      vUV = (uv0 + 1.0) / 2.0;
      ${(0,f.If)(!C,"vUV *= displacedPosScreen.w;")}
      ${(0,f.If)(T,"vLineWidth = lineWidth;")}

      vSize = screenMarkerSize;
      vColor = getColor();

      // Use camera space for slicing
      vpos = pos.xyz;

      gl_Position = displacedPosScreen;
    }`),t.fragment.include(s.f5,e),t.include(w.j,e),O.uniforms.add(new m.N("intrinsicColor",(e=>e.color)),new g.A("tex",(e=>e.markerTexture))),O.include(c.Y),O.constants.add("texelSize","float",1/n.OJ),O.code.add(f.H`float markerAlpha(vec2 samplePos) {
samplePos += vec2(0.5, -0.5) * texelSize;
float sdf = rgbaTofloat(texture(tex, samplePos)) - 0.5;
float distance = sdf * vSize;
distance -= 0.5;
return clamp(0.5 - distance, 0.0, 1.0);
}`),T&&O.constants.add("relativeMarkerSize","float",n.qO/n.OJ).constants.add("relativeTipLineWidth","float",n.zA).code.add(f.H`
    float tipAlpha(vec2 samplePos) {
      // Convert coordinates s.t. they are in pixels and relative to the tip of an arrow marker
      samplePos -= vec2(0.5, 0.5 + 0.5 * relativeMarkerSize);
      samplePos *= vSize;

      float halfMarkerSize = 0.5 * relativeMarkerSize * vSize;
      float halfTipLineWidth = 0.5 * max(1.0, relativeTipLineWidth * vLineWidth);

      ${(0,f.If)(C,"halfTipLineWidth *= fwidth(samplePos.y);")}

      float distance = max(abs(samplePos.x) - halfMarkerSize, abs(samplePos.y) - halfTipLineWidth);
      return clamp(0.5 - distance, 0.0, 1.0);
    }
  `),t.include(a.b,e),O.main.add(f.H`
    discardBySlice(vpos);
    discardByTerrainDepth();

    vec4 finalColor = intrinsicColor * vColor;

    // Cancel out perspective correct interpolation if in screen space or draped
    vec2 samplePos = vUV ${(0,f.If)(!C,"* gl_FragCoord.w")};
    finalColor.a *= ${T?"max(markerAlpha(samplePos), tipAlpha(samplePos))":"markerAlpha(samplePos)"};
    outputColorHighlightOID(finalColor, vpos);`),t}const T=Object.freeze(Object.defineProperty({__proto__:null,build:b},Symbol.toStringTag,{value:"Module"}))},39006:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ft});var n,s=i(36663),r=i(74396),a=i(23148),o=(i(39994),i(13802)),l=i(61681),c=i(76868),d=i(81977),u=(i(4157),i(40266)),p=i(60573),h=i(8400),m=i(17321),_=i(18327),f=i(19431),v=i(39405),g=i(32114),y=i(3308),S=i(86717),w=i(81095),P=i(19546),b=i(68817),T=i(98196),C=i(45043),M=i(60033),O=i(54682),D=i(92810),R=i(27493);class A{constructor(e,t,i,n,s,r){this.elevationAlignedStartPoint=e,this.elevationAlignedEndPoint=t,this.directSegment=i,this.dimensionSegment=n,this.primaryOffsetAxis=s,this.spatialReference=r}}function x(e){const{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i,dimension:{offset:n,measureType:s,orientation:r}}=e;return{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i,offset:n,measureType:s,orientation:r}}function E({elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,offset:i,measureType:n,orientation:s},r,a=null){if(null==e||null==t)return null;const o=U(a?.directSegment??new M.y,{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t},r),l=a?.primaryOffsetAxis??(0,w.Ue)();G(l,{measureType:n,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,directSegment:o,orientation:s,renderCoordsHelper:r});const c=a?.dimensionSegment??new M.y;return V({elevationAlignedStartPoint:e,elevationAlignedEndPoint:t})&&n===h.n.Vertical?((0,S.c)(c.startRenderSpace,o.startRenderSpace),(0,S.c)(c.endRenderSpace,o.endRenderSpace)):j(c,l,i,o,r),new A(e,t,o,c,l,r.spatialReference)}function I(e,t,i,s){return t===n.Start?((0,S.c)(e.startRenderSpace,i.startRenderSpace),(0,S.c)(e.endRenderSpace,s.startRenderSpace)):((0,S.c)(e.startRenderSpace,i.endRenderSpace),(0,S.c)(e.endRenderSpace,s.endRenderSpace)),e}function z(e,t,i,n){switch(t){case h.n.Direct:return U(e,i,n);case h.n.Horizontal:case h.n.Vertical:{const{elevationAlignedStartPoint:s,elevationAlignedEndPoint:r,dimension:a,geometry:o}=i;let l;a.measureType===h.n.Direct?(l=function(e,t){const i=e.directSegment.eval(.5,b.WM.get()),n=t.worldUpAtPosition(i,b.WM.get()),s=e.dimensionSegment.eval(.5,b.WM.get()),r=(0,S.a)(b.WM.get(),s,i);return!(0,S.I)(r,w.AG)&&(0,S.f)(r,n)>0}(o,n)===s.z>r.z,t===h.n.Horizontal&&(l=!l)):l=!function(e){const{startRenderSpace:t,endRenderSpace:i}=e.dimensionSegment,{startRenderSpace:n,endRenderSpace:s}=e.directSegment;return(0,S.y)(n,t)<(0,S.y)(s,i)}(o);const[c,d]=l?[s,r]:[r,s],u=(0,C.WG)(d,H);return t===h.n.Horizontal?u.z=c.z:(u.x=c.x,u.y=c.y),n.toRenderCoords(c,e.startRenderSpace),n.toRenderCoords(u,e.endRenderSpace),e}}}function U(e,t,i){return i.toRenderCoords(t.elevationAlignedStartPoint,e.startRenderSpace),i.toRenderCoords(t.elevationAlignedEndPoint,e.endRenderSpace),e}!function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(n||(n={}));const H=(0,T.T)(0,0,0,null);const k=new M.y;function G(e,t){const{measureType:i,elevationAlignedStartPoint:n,elevationAlignedEndPoint:s,directSegment:{startRenderSpace:r,endRenderSpace:a},directSegment:o,renderCoordsHelper:l}=t,c=o.eval(.5,b.WM.get()),d=l.worldUpAtPosition(c,b.WM.get()),u=l.worldBasisAtPosition(c,P.R.Y,b.WM.get());switch(i){case h.n.Horizontal:(0,S.c)(e,d);break;case h.n.Vertical:(0,S.f)(r,d)<(0,S.f)(a,d)?(0,S.a)(e,a,r):(0,S.a)(e,r,a),(0,S.e)(e,e,d),(0,S.e)(e,e,d);break;case h.n.Direct:{const i=t.orientation??0;if(V({elevationAlignedStartPoint:n,elevationAlignedEndPoint:s}))(0,g.Us)(L,-(0,f.Vl)(i),d),(0,S.t)(e,u,L);else{const t=(0,S.a)(b.WM.get(),a,r),n=(0,S.e)(b.WM.get(),t,d);(0,S.e)(n,n,t),(0,g.Us)(L,(0,f.Vl)(i),t),(0,S.t)(e,n,L)}break}}return(0,S.I)(e,w.AG)?(0,S.c)(e,u):(0,S.n)(e,e)}const L=(0,y.Ue)();function V({elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}){return null!=e&&null!=t&&e.x===t.x&&e.y===t.y}function j(e,t,i,n,s){const{startRenderSpace:r,endRenderSpace:a}=n,o=i/s.unitInMeters,[l,c]=function(e,t,i,n=0){const s=(0,S.f)(t,i),r=(0,S.f)(e,i),a=Math.abs(s-r)+n;return s>r?[a,n]:[n,a]}(r,a,t,o);return(0,S.b)(e.startRenderSpace,n.startRenderSpace,t,l),(0,S.b)(e.endRenderSpace,n.endRenderSpace,t,c),e}function N(e,t,i){const n=t.directSegment.eval(.5,b.WM.get());return i.worldUpAtPosition(n,e)}function W(e,t){const{startRenderSpace:i,endRenderSpace:n}=t.directSegment;return(0,S.a)(e,n,i)}function F(e,t,i={invert:!1}){const{startRenderSpace:n,endRenderSpace:s}=t.dimensionSegment;return i.invert?(0,S.a)(e,n,s):(0,S.a)(e,s,n)}function Z(e,t){const i=e.directSegment.eval(.5,b.WM.get());return t.headingAtPosition(i,e.primaryOffsetAxis)}const B=(0,w.Ue)();function $(e){const{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i}=e;if(null==t||null==i)return!1;const n=(0,D.Z1)(t,i);return null!=n&&(0,v.nn)(n,"meters").value>R.Yo}function q(e){return null!=e.geometry}let Y=class extends r.Z{constructor(e){super(e)}initialize(){const e=(0,c.mapCollection)((()=>this.analysisViewData.computations),(({computation:e})=>this._watchComputation(e)));this.addHandles((0,a.ed)(e))}get analysis(){return this.analysisViewData.analysis}get _defaultUnit(){return(0,_.R)(this.view)}_watchComputation(e){return(0,c.watch)((()=>x(e)),(t=>{const{measureType:i}=t;if($(t)&&i!==h.n.Direct){const t=Math.round((0,m.En)(R.Yo,"meters","kilometers"));return o.Z.getLogger(this).warnOnce(`A ${i} dimension in the analysis (id: '${this.analysis.id}') will not display, because only direct dimensions can measure lengths greater than ${t} km. Update the measureType of the affected dimension to "direct" to display it.`),void(e.geometry=null)}const n=E(t,this.view.renderCoordsHelper,e.geometry);e.geometry=n,e.result.length=function(e,t,i){if(null==e)return null;let n;if(t===h.n.Horizontal)n=(0,O.Qw)(e.elevationAlignedStartPoint,e.elevationAlignedEndPoint);else{const{startRenderSpace:t,endRenderSpace:i}=e.dimensionSegment;n=(0,D.FN)(t,i,e.spatialReference)}if(null==n)return null;const s=t===h.n.Vertical?(0,m.yv)(n.value,n.unit,i):(0,m.wd)(n.value,n.unit,i);return(0,v.nn)(n,s)}(n,i,this._defaultUnit)}),c.syncAndInitial)}};(0,s._)([(0,d.Cb)({constructOnly:!0})],Y.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],Y.prototype,"view",void 0),(0,s._)([(0,d.Cb)()],Y.prototype,"analysis",null),(0,s._)([(0,d.Cb)()],Y.prototype,"_defaultUnit",null),Y=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.DimensionController")],Y);var Q=i(18234),X=i(10186),J=i(30936),K=i(16068),ee=i(95550),te=i(52721),ie=i(69430),ne=i(39043);function se(e){return(0,ne.G)(e.accentColor,.5)}const re=new J.Z([127,127,127,.5]);var ae=i(46707),oe=i(74390),le=i(88698),ce=i(81536),de=i(6411),ue=i(85799),pe=i(63885),he=i(6087),me=i(7358),_e=i(21414),fe=i(90834),ve=i(65392),ge=i(76478),ye=i(91258);class Se{constructor(e){this.start=e.start,this.end=e.end,this.offset=e.offset,this.heading=e.heading,this.rotation=e.rotation,this.direct=e.direct,this.horizontal=e.horizontal,this.vertical=e.vertical}manipulatorName(e){return Object.keys(this).find((t=>this.hasOwnProperty(t)&&e===this[t]))}values(){return[this.start,this.end,this.offset,this.heading,this.rotation,this.direct,this.horizontal,this.vertical]}forEachMeasureTypeManipulator(e){for(const t of h.V)e(this.manipulatorForMeasureType(t),t)}manipulatorForMeasureType(e){switch(e){case h.n.Direct:return this.direct;case h.n.Horizontal:return this.horizontal;case h.n.Vertical:return this.vertical}}}class we extends ae.Z{constructor(e,t){const i=(0,oe.EA)(J.Z.toUnitRGBA(se(e.effectiveTheme))),n=[new le.r((0,he.PI)(i,1,32,32),Ge)];super({view:e,renderObjects:n,metadata:t.metadata,available:!1,grabCursor:"crosshair",radius:5,collisionPriority:1}),this._themeHandle=(0,c.watch)((()=>({color:J.Z.toUnitRGBA(se(e.effectiveTheme))})),(e=>i.setParameters(e)))}destroy(){this._themeHandle.remove(),super.destroy()}}class Pe extends ae.Z{constructor(e,{lineSizePt:t,material:i,metadata:n}){super({view:e,autoScaleRenderObjects:!1,collisionPriority:1,metadata:n}),this._options={calloutColor:(0,te.Ue)(),lineSizePt:t,material:i},this._themeHandle=(0,c.watch)((()=>J.Z.toUnitRGBA(se(e.effectiveTheme))),(e=>{this._options.calloutColor=e,ke(this,be({...this._options,metadata:this.metadata}))}),c.initial)}update({lineSizePt:e,material:t}){this._options.lineSizePt=e,this._options.material=t,ke(this,be({...this._options,metadata:this.metadata}))}destroy(){this._themeHandle.remove(),super.destroy()}}function be({calloutColor:e,lineSizePt:t,material:i,metadata:n}){return{calloutLength:.25*de.M_*.8*(0,ee.F2)(t)+18,calloutColor:e,calloutWidth:2,customStateMask:Ge,discScale:.3,focusMultiplier:2,material:i,metadata:n}}function Te(e,{computation:t,view:i}){return[(0,ge.Xd)(e,((e,n,s)=>{Ce({cancel:s,computation:t,settingHeading:!1,steps:n,view:i})})),e.events.on("immediate-click",(e=>{!function(e,t,i){const{dimension:n,geometry:s}=t;if(90===n.orientation||270===n.orientation)return n.orientation=0,void e.stopPropagation();if(null==s)return;const{renderCoordsHelper:r}=i,a=E({...x(t),orientation:90},r),o=E({...x(t),orientation:270},r);if(null==a||null==o)return;const l=Z(a,r),c=Z(o,r),d=De(s,i),u=K.BV.shortestSignedDiff(d,l),p=K.BV.shortestSignedDiff(d,c);n.orientation=Math.abs(u)<Math.abs(p)?90:270,e.stopPropagation()}(e,t,i)}))]}function Ce(e){const{cancel:t,computation:i,settingHeading:n,steps:s,view:r}=e;if(!q(i))return;const{renderCoordsHelper:a}=r,{dimension:o,geometry:l}=i,c=(0,w.Ue)(),d=Ee((0,w.Ue)(),l,l.directSegment,a),u=Ie(b.WM.get(),{forHeading:n,geometry:l,renderCoordsHelper:a}),p=(0,ie.Yq)(d,u,(0,ie.Ue)()),h=n?o.orientation??Z(l,r.renderCoordsHelper):o.orientation??0;s.next((0,ce._N)(r,p)).next((e=>{"start"===e.action&&(0,S.c)(c,e.renderStart);const t=(0,ie.st)(p),i=(0,oe.Gd)(c,e.renderEnd,d,t);let s=h-(0,f.BV)(i);n||(s=function(e){const t=K.BV.normalize(e)%90;return t<5?e-t:90-t<5?e+(90-t):e}(s)),o.orientation=s})),t.next((0,ge.di)(o,["orientation"]))}function Me(e,{computation:t,manipulatorMeasureType:i,view:n}){let s=h.n.Direct,r=0,a=0;return[e.events.on("grab-changed",(o=>{if("start"!==o.action||!q(t))return;const{dimension:l,geometry:c}=t;s=l.measureType,r=l.offset,a=l.orientation;const d=(0,S.c)(b.WM.get(),e.renderLocation);l.measureType=i,l.offset=function(e,t,i,n){const{directSegment:s}=i,r=G(b.WM.get(),{measureType:t,directSegment:s,renderCoordsHelper:n}),a=j(k,r,0,s,n).eval(.5,b.WM.get()),o=(0,S.a)(b.WM.get(),e,a);return(0,S.f)(o,r)*n.unitInMeters}(d,i,c,n.renderCoordsHelper),l.orientation=0})),(0,ge.Xd)(e,((e,o,l)=>{if(!q(t))return;const{geometry:c,dimension:d}=t,{renderCoordsHelper:u}=n,p=z(Ne,i,t,u),h=G(b.WM.get(),{measureType:i,directSegment:c.directSegment,renderCoordsHelper:u}),m=(0,ce.J4)(e);o.next(m).next(Oe(n,d,p,h)),l.next(m).next((e=>(d.measureType=s,d.offset=r,d.orientation=a,e)))}))]}function Oe(e,t,i,n){const s=(0,S.d)(b.WM.get(),i.endRenderSpace,i.startRenderSpace);(0,S.e)(s,s,n);const r=(0,ie.Yq)(i.startRenderSpace,s,(0,ie.Ue)()),a=(0,ie.Yq)(i.startRenderSpace,n,(0,ie.Ue)()),o=t.offset;let l,c=0;const d=new ge.hM;return d.next((0,ce._N)(e,r)).next((i=>{"start"===i.action&&(c=(0,ie.jH)(a,i.renderStart));const n=((0,ie.jH)(a,i.renderEnd)-c)*e.renderCoordsHelper.unitInMeters;t.offset=o+n,l=i})),e=>(d.execute(e),l)}function De(e,t){const{directSegment:i}=e,{renderCoordsHelper:n}=t,s=N(b.WM.get(),e,n),r=W(b.WM.get(),e),a=(0,S.e)(b.WM.get(),r,s),{viewForward:o}=t.state.camera;(0,S.f)(a,o)>0&&(0,S.h)(a,a,-1);const l=i.eval(.5,b.WM.get());return n.headingAtPosition(l,a)}function Re(e,t,i,{forHeading:n}){const{dimension:s,geometry:r}=t,{primaryOffsetAxis:a}=r,o=(0,S.h)(Ae,a,s.offset>=0?1:-1),l=Ie(xe,{forHeading:n,geometry:r,renderCoordsHelper:i});(0,S.e)(l,l,o);const c=(0,oe.Aq)(o,l,w.AG,je);e.modelTransform=c,e.renderLocation=Ee(Le,r,r.dimensionSegment,i)}const Ae=(0,w.Ue)(),xe=(0,w.Ue)();function Ee(e,t,i,n){const{startRenderSpace:s,endRenderSpace:r}=i,a=function(e,t){const i=W(ze,e),n=N(Ue,e,t);return(0,S.f)(i,n)>0}(t,n)?s:r;return(0,S.c)(e,a)}function Ie(e,{forHeading:t,geometry:i,renderCoordsHelper:n}){return t?N(e,i,n):F(e,i,{invert:!0})}const ze=(0,w.Ue)(),Ue=(0,w.Ue)();function He(e){return(0,ee.F2)(e)+6}function ke(e,t){const i=t.material??new fe.j({writeDepth:!1,textureId:t.texture?.id,renderOccluded:me.yD.Opaque,isDecoration:!0}),n=t.focusMultiplier??oe.vQ.focusMultiplier,s=t.calloutLength??oe.vQ.calloutLength,r=oe.vQ.discRadius*(t.discScale??1),a=r*n,o=(e,t)=>{const i=[0,1,2,2,3,0];return new pe.Z(t,[[_e.T.POSITION,new ue.a([s-e,-e,0,s+e,-e,0,s+e,e,0,s-e,e,0],i,3,!0)],[_e.T.UV0,new ue.a([0,0,1,0,1,1,0,1],i,2,!0)]])},l=t.calloutWidth??oe.vQ.calloutWidth,c=new ve.U({width:l,color:t.calloutColor,renderOccluded:me.yD.OccludeAndTransparent,isDecoration:!0}),d=(0,he.rh)(c,[[0,0,0],[s-r,0,0]]),u=(0,he.rh)(c,[[0,0,0],[s-a,0,0]]),p=t.customStateMask??ye.jg.None;e.collisionType={type:"disc",direction:[0,0,1],offset:[s,0,0]},e.focusMultiplier=n,e.metadata=t.metadata,e.radius=r,e.renderObjects=[new le.r(o(r,i),ye.Q9.Unfocused|p),new le.r(d,ye.Q9.Unfocused|p),new le.r(o(a,i),ye.Q9.Focused|p),new le.r(u,ye.Q9.Focused|p)]}const Ge=ye.jg.Custom1,Le=(0,w.Ue)(),Ve=(0,w.Ue)(),je=(0,y.Ue)(),Ne=new M.y;var We,Fe=i(97622),Ze=i(44584),Be=i(67134),$e=i(81506),qe=i(78668),Ye=i(98940);function Qe(e,t,i){const{constraint:n,elevationAlignedStartPoint:s,elevationAlignedEndPoint:r,unconstrainedGeometry:a,view:o}=i,{dimension:l,previousConstraint:c,preConstraintProperties:d}=e;if(null==s||null==r)return;const u=()=>{"startPoint"in t?l.startPoint=t.startPoint:"endPoint"in t&&(l.endPoint=t.endPoint)};if(null==n)u(),null!=c&&null!=d&&(l.measureType=d.measureType,l.orientation=d.orientation);else switch(l.measureType=h.n.Direct,n){case We.Horizontal:if(n!==c&&(l.orientation=0),"startPoint"in t){const e=t.startPoint;null!=e&&(e.z=r.z),l.startPoint=e}else if("endPoint"in t){const e=t.endPoint;null!=e&&(e.z=s.z),l.endPoint=e}break;case We.Vertical:if(n!==c&&(l.orientation=De(a,o)),"startPoint"in t){const e=t.startPoint;null!=e&&(e.x=r.x,e.y=r.y),l.startPoint=e}else if("endPoint"in t){const e=t.endPoint;null!=e&&(e.x=s.x,e.y=s.y),l.endPoint=e}break;case We.Direct:n!==c&&null!=d&&(l.orientation=d.orientation),u()}e.previousConstraint=n,e.unconstrainedGeometry=a}!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Direct=2]="Direct"}(We||(We={}));var Xe=i(95275),Je=i(56264),Ke=i(37926),et=i(92144),tt=i(66962),it=i(64594),nt=i(4703),st=i(4708),rt=i(73080),at=i(73464),ot=i(91084),lt=i(98028),ct=i(22519);let dt=class extends r.Z{constructor(e){super(e),this._stagedDimension=null,this._computationManipulators=new Map,this._computationHandles=new Ze.Z,this._orientationManipulatorTexture=null,this._updatingHandles=new Ye.R,this._getSnappingContext=(0,$e.H)((e=>new rt.N({elevationInfo:{mode:"absolute-height",offset:0},pointer:e,editGeometryOperations:new st.c(new nt.XE("point",(0,it.Y6)(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new Je._})));const{view:t}=e;this._snappingManagerResult=(0,ot.u)(t),this.addHandles(this._snappingManagerResult),this._unfocusedOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._focusedOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._thinOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._thinOffsetManipulatorMaterial.setParameters({stipplePattern:(0,tt.z5)(2)}),this._constraintSnappingIndicator=new Ke.r({view:t,attached:!0,width:1,renderOccluded:me.yD.OccludeAndTransparent,stipplePattern:(0,tt.z5)(5),isDecoration:!0});const i=J.Z.toUnitRGBA(re);this._stagedStartIndicator=new et.j({view:t,attached:!1,elevationInfo:{mode:"absolute-height",offset:0},spatialReference:e.view.renderCoordsHelper.spatialReference,color:i,size:10,outlineSize:0,renderOccluded:me.yD.OccludeAndTransparent,isDecoration:!0})}initialize(){const{view:e}=this;this._snappingOperation=new lt.y({view:e});const t=!e._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this._orientationManipulatorMaterial=new fe.j({writeDepth:!1,renderOccluded:me.yD.Opaque,isDecoration:!0}),this.addHandles((0,c.watch)((()=>{return{accentColor:se(e.effectiveTheme),contrastColor:(t=e.effectiveTheme,(0,ne.mj)(t.accentColor))};var t}),(({accentColor:i,contrastColor:n})=>{const s=this._orientationManipulatorTexture,r=(0,Xe.O)(e.textures,{accentColor:i,contrastColor:n,preMultiplyAlpha:t});this._orientationManipulatorMaterial.setParameters({textureId:r.texture.id}),this._orientationManipulatorTexture=r,s?.release();const a=J.Z.toUnitRGBA(i);this._unfocusedOffsetManipulatorMaterial.setParameters({color:a}),this._focusedOffsetManipulatorMaterial.setParameters({color:a}),this._thinOffsetManipulatorMaterial.setParameters({color:a}),this._constraintSnappingIndicator.color=a}),c.initial));const i=(0,c.mapCollection)((()=>this.analysisViewData.computations),(({computation:e})=>this._createManipulators(e)));this.addHandles((0,a.ed)(i)),this.addHandles([(0,c.watch)((()=>({stagedPoint:this._snappingOperation.stagedPoint,stagedComputation:this._stagedComputation})),(({stagedPoint:e,stagedComputation:t})=>{if(null==t||null==e)return;const i=(0,C.WG)(e,new X.Z);this._applyPointUpdate(t,{endPoint:i})}),c.sync),(0,c.watch)((()=>({stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator})),((e,t)=>{const{stagedDimension:i,selectedComputation:n,firstGrabbedManipulator:s}=e;if(i===t?.stagedDimension&&s===t?.firstGrabbedManipulator){for(const i of[n,t?.selectedComputation])if(null!=i){const t=this._computationManipulators.get(i);null!=t&&this._updateManipulators(i,t,e)}}else for(const[t,i]of this._computationManipulators)this._updateManipulators(t,i,e)}),c.syncAndInitial),(0,c.watch)((()=>this.analysis.style.lineSize),(e=>{this._updateManipulatorStyle(e)}),c.initial),(0,c.watch)((()=>this.view.state.camera),(()=>{null!=this._stagedComputation&&this._updateStagedDimensionOffset(this._stagedComputation)})),(0,c.watch)((()=>{const e=this._stagedComputation;if(!e)return null;const t=e.elevationAlignedStartPoint,i=(0,w.Ue)();return null!=t&&this.view.renderCoordsHelper.toRenderCoords(t,i)?i:null}),(e=>{null!=e?(this._stagedStartIndicator.vertices=[e],this._stagedStartIndicator.attached=!0):this._stagedStartIndicator.attached=!1}))]),this.addHandles(this._constraintHandles),this.addHandles(this._snappingIndicatorHandles),(0,ct.Ob)(this,(()=>{const e=this._activeComputation,t=this._stagedComputation;if(null==e||null!=t){const e=this.view.inputManager.latestPointerType??"mouse",t=this._getSnappingContext(e);this._updatingHandles.addPromise((0,qe.R8)(this._snappingOperation.snapAgainNearPreviousMapPoint(this._snappingManager,t)))}if(null!=e){const{start:t,end:i}=this._computationManipulators.get(e);if(t.grabbing||i.grabbing){!function(e,t,{constraint:i,view:n}){const{unconstrainedGeometry:s}=e;if(null==s)return;const{renderCoordsHelper:r,spatialReference:a}=n,{startRenderSpace:o,endRenderSpace:l}=s.directSegment,c=r.fromRenderCoords(o,new X.Z({spatialReference:a})),d=r.fromRenderCoords(l,new X.Z({spatialReference:a}));let u;u="start"===t?{startPoint:c}:{endPoint:d},Qe(e,u,{constraint:i,elevationAlignedStartPoint:e.elevationAlignedStartPoint,elevationAlignedEndPoint:e.elevationAlignedEndPoint,unconstrainedGeometry:s,view:n})}(e,t.grabbing?"start":"end",{constraint:this._computeConstraint(e),view:this.view})}}}))}destroy(){this._snappingOperation=(0,l.SC)(this._snappingOperation),this._computationHandles.destroy(),this._constraintSnappingIndicator.destroy(),this._stagedStartIndicator.destroy(),this._orientationManipulatorTexture?.release()}get updating(){return this._updatingHandles.updating||this._snappingManager.updating}get firstGrabbedManipulator(){return this.parentTool.firstGrabbedManipulator}get hasGrabbedManipulators(){return this.parentTool.hasGrabbedManipulators}get snappingOptions(){return this._snappingManager.options}get _snappingManager(){return this._snappingManagerResult.snappingManager}get _activeComputation(){if(null!=this._stagedComputation)return this._stagedComputation;const{selectedComputation:e}=this.analysisViewData;return this.hasGrabbedManipulators&&null!=e?e:null}get _stagedComputation(){const e=this._stagedDimension,t=this.analysisViewData.computations.at(-1)?.computation;return null==e||null==t||t.dimension!==e?null:t}get _constraintHandles(){return[(0,c.when)((()=>this.analysisViewData.selectedComputation),(e=>{e.previousConstraint=this._computeConstraint(e)}),{...c.syncAndInitial,equals:Be.fS}),(0,c.watch)((()=>{const e=this._activeComputation;if(null==e)return null;const{measureType:t,orientation:i}=e.dimension;return{measureType:t,orientation:i,computation:e}}),((e,t)=>{if(null!=e&&null==t){const{measureType:t,orientation:i,computation:n}=e;switch(n.previousConstraint){case We.Horizontal:n.preConstraintProperties={measureType:h.n.Horizontal,orientation:0};break;case We.Vertical:n.preConstraintProperties={measureType:h.n.Vertical,orientation:0};break;case We.Direct:n.preConstraintProperties={measureType:h.n.Direct,orientation:i};break;default:n.preConstraintProperties={measureType:t,orientation:i}}}null==e&&null!=t&&(t.computation.preConstraintProperties=null)}),c.sync)]}get _snappingIndicatorHandles(){const e="snapping-indicator-event-handles";return[(0,c.watch)((()=>({stagedComputation:this._stagedComputation,activeComputation:this._activeComputation})),(({stagedComputation:t,activeComputation:i})=>{const n=this._constraintSnappingIndicator;if(this.removeHandles(e),null!=i)if(i===t)n.attached=!0;else{const{start:t,end:s}=this._computationManipulators.get(i),r=()=>{n.attached=t.grabbing||s.grabbing};r(),this.addHandles([t.events.on("grab-changed",r),s.events.on("grab-changed",r)],e)}else n.attached=!1})),(0,c.watch)((()=>{const e=this._activeComputation;return null!=e?{geometry:e.geometry,constraint:e.previousConstraint}:{}}),(({geometry:e,constraint:t})=>{const i=this._constraintSnappingIndicator;null!=e&&null!=t&&t!==We.Direct?(i.visible=!0,i.setGeometryFromSegment(e.directSegment)):i.visible=!1}))]}removeStaged(){return null!=this._stagedDimension&&(this.analysis.dimensions.remove(this._stagedDimension),this._stagedDimension=null,!0)}onDeactivate(){this.removeStaged(),this._resetSnappingState()}onClick(e){const{_stagedDimension:t}=this;if(null==t){const t=this._onUnstagedClick(e);return this.analysis.dimensions.add(t),null}return this._onStagedClick(e),t}onPointerMove({mapPoint:e,pointerType:t}){if("touch"===t)return;const i=this._getSnappingContext(t);this._updatingHandles.addPromise((0,qe.R8)(this._snappingOperation.snap({point:e},this._snappingManager,i)))}onManipulatorSelectionChanged(){null!=this.analysisViewData.selectedComputation&&(this._computationManipulators.get(this.analysisViewData.selectedComputation).offset.selected||(this.analysisViewData.selectedDimension=null))}_onUnstagedClick({mapPoint:e,pointerType:t}){let i=e;if("mouse"===t){const n=this._getSnappingContext(t);i=this._snappingManager.update({point:e,context:n})}const n=new Fe.Z({startPoint:(0,C.WG)(i,new X.Z),endPoint:null,measureType:h.n.Horizontal});return this._stagedDimension=n,this._resetSnappingState(),n}_onStagedClick({mapPoint:e,pointerType:t}){const i=this._stagedComputation;if(null==i)return;let n=e;if("mouse"===t){const i=this._getSnappingContext(t);n=this._snappingManager.update({point:e,context:i})}const s=(0,C.WG)(n,new X.Z);this._applyPointUpdate(i,{endPoint:s}),this._stagedDimension=null,this._resetSnappingState()}_resetSnappingState(){this._snappingManager.doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}_createManipulators(e){const t=this._setupPointManipulator(e,{isStart:!0}),i=this._setupPointManipulator(e,{isStart:!1}),n=this._setupOffsetManipulator(e),s=this._setupHeadingManipulator(e),r=this._setupRotationManipulator(e),a=this._setupMeasureTypeManipulator(e,h.n.Direct),o=this._setupMeasureTypeManipulator(e,h.n.Horizontal),l=this._setupMeasureTypeManipulator(e,h.n.Vertical),c=new Se({start:t,end:i,offset:n,heading:s,rotation:r,direct:a,horizontal:o,vertical:l});return this._setupComputationToManipulatorsSync(e,c),this._computationManipulators.set(e,c),this.manipulators.addMany(c.values()),{manipulators:c,remove:()=>{this._computationHandles.remove(e),this._computationManipulators.delete(e);for(const e of c.values())this.manipulators.remove(e)}}}_setupComputationToManipulatorsSync(e,t){this._computationHandles.add([(0,c.watch)((()=>e.geometry),(()=>this._updateManipulators(e,t)),{...c.syncAndInitial,equals:Be.fS})],e)}_setupPointManipulator(e,t){const{view:i}=this,{dimension:n}=e,s=new we(i,{metadata:n}),r=function(e,{isStart:t,createSnappingPipelineStep:i,dimension:n,onUpdate:s,view:r}){const a=t?"startPoint":"endPoint",o=(0,ge.Xd)(e,((e,t,o,l)=>{const c=(0,ce.J4)(e),{snappingStep:d,cancelSnapping:u}=i(l);o=o.next(c).next((0,ge.di)(n,[a,"measureType","orientation"])).next(u),t.next(c).next((0,ce.gv)(r)).next(...d).next((e=>{const t=(0,C.WG)(e.mapEnd,new X.Z);s("startPoint"===a?{startPoint:t}:{endPoint:t})}))}));return[o]}(s,{isStart:t.isStart,createSnappingPipelineStep:e=>(0,at.W)({snappingContext:this._getSnappingContext(e),snappingManager:this._snappingManager,updatingHandles:this._updatingHandles}),dimension:n,onUpdate:t=>this._applyPointUpdate(e,t),view:i});return this._computationHandles.add(r,e),s}_setupOffsetManipulator(e){const{view:t}=this,i=function(e,t){const i=[(0,w.al)(-.5,0,0),(0,w.al)(.5,0,0)],n=(0,he.rh)(t.unfocusedMaterial,i.map((e=>(0,S.h)((0,w.Ue)(),e,.5)))),s=n.instantiate({material:t.focusedMaterial});return new ae.Z({view:e,renderObjects:[new le.r(n,ye.Q9.Unfocused|ye.Q9.Selected|Ge),new le.r(s,ye.Q9.Focused|Ge)],collisionType:{type:"line",paths:[i]},radius:He(t.lineSizePt)/2,metadata:t.metadata,available:!1,...oe.X9})}(t,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,metadata:e.dimension}),n=function(e,{computation:t,view:i}){return[(0,ge.Xd)(e,((e,n,s)=>{if(!q(t)||!e.selected)return;const{geometry:r,dimension:a}=t,o=(0,ce.J4)(e);n.next(o).next(Oe(i,a,r.dimensionSegment,r.primaryOffsetAxis)),s.next(o).next((0,ge.di)(a,["offset"]))}))]}(i,{computation:e,view:t});return this._computationHandles.add(n,e),i}_setupHeadingManipulator(e){const{view:t}=this,i=new Pe(t,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:e.dimension}),n=function(e,{computation:t,view:i}){return[(0,ge.Xd)(e,((e,n,s)=>{Ce({cancel:s,computation:t,settingHeading:!0,steps:n,view:i})}))]}(i,{computation:e,view:t});return this._computationHandles.add(n,e),i}_setupRotationManipulator(e){const{view:t}=this,i=new Pe(t,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:e.dimension}),n=Te(i,{computation:e,view:t});return this._computationHandles.add(n,e),i}_setupMeasureTypeManipulator(e,t){const{view:i}=this,n=function(e,t){const i=[(0,w.al)(-.5,0,0),(0,w.al)(.5,0,0)],n=(0,he.rh)(t.thinOffsetManipulatorMaterial,i),s=(0,he.rh)(t.unfocusedMaterial,i.map((e=>(0,S.h)((0,w.Ue)(),e,.5)))),r=s.instantiate({material:t.focusedMaterial});return new ae.Z({view:e,renderObjects:[new le.r(s,ye.Q9.Unfocused|Ge),new le.r(r,ye.Q9.Focused|Ge),new le.r(n,Ge)],collisionType:{type:"line",paths:[i]},radius:He(t.lineSizePt)/2,available:!1,metadata:t.metadata,...oe.X9})}(i,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,thinOffsetManipulatorMaterial:this._thinOffsetManipulatorMaterial,metadata:e.dimension}),s=Me(n,{computation:e,manipulatorMeasureType:t,view:i});return this._computationHandles.add(s,e),n}_updateManipulators(e,t,i={stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator}){const{stagedDimension:n,selectedComputation:s,firstGrabbedManipulator:r}=i,{start:a,end:o,offset:l,heading:c,rotation:d}=t,u=s===e,p=q(e),{dimension:m}=e;for(const e of t.values()){const t=p&&null==n&&(null==r||e===r);e===l?(e.available=t,e.selected=u):e.available=t&&u}if(!p)return;null!=this._computeConstraint(e)?t.forEachMeasureTypeManipulator((e=>e.available=!1)):t.manipulatorForMeasureType(m.measureType).available=!1;for(const e of[c,d])m.measureType===h.n.Direct&&0!==m.offset||(e.available=!1);V(e)?d.available=!1:c.available=!1;const{geometry:_}=e;a.renderLocation=_.directSegment.startRenderSpace,o.renderLocation=_.directSegment.endRenderSpace;const{renderCoordsHelper:f}=this.view;(function(e,t,i){const{dimensionSegment:n,primaryOffsetAxis:s}=t,r=F(Le,t),a=(0,S.p)(r,w.AG)?(0,g.yR)(je):(0,oe.Aq)(r,s,w.AG,je),o=Math.max((0,S.l)(r),.1/i.unitInMeters);(0,g.bA)(a,a,(0,S.i)(Le,o,o,o)),e.modelTransform=a,e.renderLocation=n.eval(.5,Le)})(l,_,f),c.available&&function(e,t,i){Re(e,t,i,{forHeading:!0})}(c,e,f),d.available&&function(e,t,i){Re(e,t,i,{forHeading:!1})}(d,e,f),t.forEachMeasureTypeManipulator(((t,i)=>{t.available&&function(e,t,i,n){const{geometry:s}=t,r=z(Ne,i,t,n),a=G(Le,{measureType:i,directSegment:s.directSegment,renderCoordsHelper:n}),o=(0,S.a)(Ve,r.endRenderSpace,r.startRenderSpace),l=(0,oe.Aq)(o,a,w.AG,je),c=(0,S.l)(o);(0,g.bA)(l,l,(0,S.i)(Ve,c,c,c)),e.modelTransform=l,e.renderLocation=r.eval(.5,Ve)}(t,e,i,f)}))}_updateManipulatorStyle(e){const t=function(e){return(0,ee.F2)(e)+4}(e),i=He(e),n={lineSizePt:e,material:this._orientationManipulatorMaterial};for(const{offset:e,heading:t,rotation:s}of this._computationManipulators.values())e.radius=i/2,t.update(n),s.update(n);this._unfocusedOffsetManipulatorMaterial.setParameters({width:t}),this._focusedOffsetManipulatorMaterial.setParameters({width:i})}_applyPointUpdate(e,t){const{view:i}=this,n=x(e);"startPoint"in t&&(n.elevationAlignedStartPoint=t.startPoint),"endPoint"in t&&(n.elevationAlignedEndPoint=t.endPoint);const s=E(n,i.renderCoordsHelper);if(null==s)return;const r=this._computeConstraint({...n,geometry:s});Qe(e,t,{...n,constraint:r,unconstrainedGeometry:s,view:i}),e===this._stagedComputation&&this._updateStagedDimensionOffset(e)}_updateStagedDimensionOffset(e){if(null==e.geometry)return;e.geometry.directSegment.eval(.5,ut);const{state:t,renderCoordsHelper:i}=this.view,n=t.camera.computeScreenPixelSizeAt(ut);e.dimension.offset=50*n*i.unitInMeters}_computeConstraint(e){return function(e,t){if($(e))return We.Direct;if(!e.enabled)return null;const{geometry:i}=e;if(null==i||(0,S.p)(i.directSegment.startRenderSpace,i.directSegment.endRenderSpace))return null;const{camera:n}=t.state,s=N(b.WM.get(),i,t.renderCoordsHelper),r=W(b.WM.get(),i),a=(0,S.h)(b.WM.get(),s,(0,S.f)(r,s)),o=(0,S.d)(b.WM.get(),r,a),l=(0,S.k)(o),c=(0,S.k)(a),{startRenderSpace:d,endRenderSpace:u}=i.directSegment,p=Math.max(10*n.computeScreenPixelSizeAt(d),10*n.computeScreenPixelSizeAt(u))**2;return l<p?We.Vertical:c<p?We.Horizontal:null}(function(e,t){return{enabled:t.effectiveFeatureEnabled,elevationAlignedStartPoint:e.elevationAlignedStartPoint,elevationAlignedEndPoint:e.elevationAlignedEndPoint,geometry:e.geometry}}(e,this._snappingManager.options),this.view)}_createOffsetManipulatorMaterial(){return new ve.U({width:1,renderOccluded:me.yD.OccludeAndTransparent,writeDepth:!1,hasPolygonOffset:!0,isDecoration:!0})}get testInfo(){}};(0,s._)([(0,d.Cb)({constructOnly:!0})],dt.prototype,"analysis",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],dt.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],dt.prototype,"manipulators",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],dt.prototype,"parentTool",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],dt.prototype,"view",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],dt.prototype,"updating",null),(0,s._)([(0,d.Cb)()],dt.prototype,"firstGrabbedManipulator",null),(0,s._)([(0,d.Cb)()],dt.prototype,"hasGrabbedManipulators",null),(0,s._)([(0,d.Cb)()],dt.prototype,"snappingOptions",null),(0,s._)([(0,d.Cb)()],dt.prototype,"_stagedDimension",void 0),(0,s._)([(0,d.Cb)()],dt.prototype,"_activeComputation",null),(0,s._)([(0,d.Cb)()],dt.prototype,"_stagedComputation",null),dt=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.LengthDimensionSubTool")],dt);const ut=(0,w.Ue)();var pt,ht=i(2523),mt=i(41775),_t=i(77877),ft=i(38114);!function(e){e.Ready="ready",e.Creating="creating",e.Created="created"}(pt||(pt={}));let vt=class extends ht.f{constructor(e){super(e),this.automaticManipulatorSelection=!1,this.removeIncompleteOnCancel=!1,this._pointerMoveTimerMs=2500,this._prevPointerMoveTimeout=null}initialize(){this._intersector=(0,_t.w)(this.view.state.viewingMode),this._lengthDimensionSubTool=new dt({analysis:this.analysis,analysisViewData:this.analysisViewData,manipulators:this.manipulators,parentTool:this,view:this.view}),this.addHandles([(0,a.ed)(this._lengthDimensionSubTool),(0,a.kB)((()=>this._clearPointerMoveTimeout())),(0,c.watch)((()=>this.state),(e=>{e===pt.Created&&this.finishToolCreation()}),c.syncAndInitial),(0,c.when)((()=>this.firstGrabbedManipulator),(e=>{this.selectedDimension=e.metadata}),c.syncAndInitial),(0,c.watch)((()=>this.selectedDimension),(()=>this._resetPointerMoveTimeout()),c.syncAndInitial)])}get state(){return this.analysis.dimensions.some((e=>"length"===e.type))?null!=this._activeSubTool?pt.Creating:pt.Created:pt.Ready}get updating(){return this._lengthDimensionSubTool.updating}get cursor(){return this.active?"crosshair":null}get selectedDimension(){return this.analysisViewData.selectedDimension}set selectedDimension(e){this.analysisViewData.selectedDimension=e}onInputEvent(e){switch(e.type){case"immediate-click":this._clickHandler(e);break;case"immediate-double-click":this._doubleClickHandler(e);break;case"pointer-move":this._pointerMoveHandler(e);break;case"key-down":if(mt.Sn.cancel===e.key){if(null!=this._activeSubTool&&this._activeSubTool.removeStaged())return void e.stopPropagation();this.active||(this.selectedDimension=null)}else mt.Sn.delete.includes(e.key)&&this._deleteKeyHandler()}}onActivate(){this._activeSubTool=this._lengthDimensionSubTool}onDeactivate(){null!=this._activeSubTool&&(this._activeSubTool.onDeactivate(),this._activeSubTool=null)}onShow(){this._resetPointerMoveTimeout()}onManipulatorSelectionChanged(){this._lengthDimensionSubTool.onManipulatorSelectionChanged()}onHide(){this.selectedDimension=null}_clickHandler(e){if(this.hasFocusedManipulators)return void e.stopPropagation();if(null==this._activeSubTool)return;const t=this._intersectScreen(e);null!=t&&(this.selectedDimension=this._activeSubTool.onClick({mapPoint:t,pointerType:e.pointerType}),e.stopPropagation())}_doubleClickHandler(e){this.active&&(this.view.activeTool=null,e.stopPropagation())}_pointerMoveHandler(e){if(this._resetPointerMoveTimeout(),null==this._activeSubTool)return;if(this.hasFocusedManipulators)return;const t=this._intersectScreen(e);null!=t&&this._activeSubTool.onPointerMove({mapPoint:t,pointerType:e.pointerType})}_deleteKeyHandler(){null!=this._activeSubTool&&this._activeSubTool.removeStaged(),this._removeSelected()}_intersectScreen(e){const t=(0,ft.Sj)(e);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector);const i=this._intersector.results.min,n=b.WM.get();return i.getIntersectionPoint(n)?this.view.renderCoordsHelper.fromRenderCoords(n,new X.Z({spatialReference:this.view.spatialReference})):null}_removeSelected(){null!=this.selectedDimension&&(this.analysis.dimensions.remove(this.selectedDimension),this.selectedDimension=null)}_clearPointerMoveTimeout(){this._prevPointerMoveTimeout=(0,l.hw)(this._prevPointerMoveTimeout)}_resetPointerMoveTimeout(){this._clearPointerMoveTimeout(),this.manipulators.forEach((e=>e.manipulator.state|=Ge)),this._prevPointerMoveTimeout=Q.m.setTimeout((()=>{this.manipulators.forEach((e=>e.manipulator.state&=~Ge))}),this._pointerMoveTimerMs)}get testInfo(){}};(0,s._)([(0,d.Cb)({constructOnly:!0})],vt.prototype,"view",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],vt.prototype,"analysis",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],vt.prototype,"state",null),(0,s._)([(0,d.Cb)({readOnly:!0})],vt.prototype,"updating",null),(0,s._)([(0,d.Cb)({readOnly:!0})],vt.prototype,"cursor",null),(0,s._)([(0,d.Cb)({constructOnly:!0})],vt.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)()],vt.prototype,"selectedDimension",null),(0,s._)([(0,d.Cb)()],vt.prototype,"automaticManipulatorSelection",void 0),(0,s._)([(0,d.Cb)()],vt.prototype,"_activeSubTool",void 0),(0,s._)([(0,d.Cb)()],vt.prototype,"_lengthDimensionSubTool",void 0),vt=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.DimensionTool")],vt);i(87090);var gt=i(10145),yt=i(21961),St=i(55939),wt=i(10449),Pt=i(24370),bt=i(84982);class Tt extends wt._{constructor(e,t){super(e),this._hasExternalMaterial=!1,this._renderOccluded=me.yD.OccludeAndTransparent,this._width=1,this._color=(0,St.al)(1,0,1,1),this._placement="end",this._markerPrimitive="arrow",this._material=t,this._hasExternalMaterial=null!=t,this.applyProperties(e)}setGeometryFromSegment(e,t){const i=e.endRenderSpace;this.transform=(0,g.vc)(Ct,i),this._normal=t;const{points:n}=e.createRenderGeometry(i,this.view.renderCoordsHelper);this.geometry=[n]}get renderOccluded(){return null!=this._material?this._material.parameters.renderOccluded:this._renderOccluded}set renderOccluded(e){this._renderOccluded=e,null!=this._material&&this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get normal(){return this._normal}set normal(e){this._normal=e,this.recreateGeometry()}get width(){return null!=this._material?this._material.parameters.width:this._width}set width(e){this._width=e,null!=this._material&&this._material.setParameters({width:e})}get color(){return null!=this._material?this._material.parameters.color:this._color}set color(e){this._color=(0,St.d9)(e),null!=this._material&&this._material.setParameters({color:this._color})}get placement(){return null!=this._material?this._material.parameters.placement:this._placement}set placement(e){this._placement=e,null!=this._material&&this._material.setParameters({placement:this._placement})}get markerPrimitive(){return this._material?.parameters.markerPrimitive??this._markerPrimitive}set markerPrimitive(e){this._markerPrimitive=e,null!=this._material&&this._material.setParameters({markerPrimitive:e})}createExternalResources(){this._hasExternalMaterial||(this._material=new bt.X({width:this._width,color:this._color,placement:this._placement,renderOccluded:this._renderOccluded,markerPrimitive:this._markerPrimitive,isDecoration:this.isDecoration}))}destroyExternalResources(){this._hasExternalMaterial||(this._material=null)}createGeometries(e){for(const t of(0,Pt.c)(this.geometry,this.normal)){const i=(0,Pt.Y)(this._material,t);e.addGeometry(i)}}forEachExternalMaterial(e){this._hasExternalMaterial||e(this._material)}}const Ct=(0,y.Ue)();class Mt{set visible(e){for(const t of this._visualElements.values())t.attached=e}constructor(e){this.destroyed=!1,this._handles=new Ze.Z,this._messages=null,this._labelSegment=new M.y;const{analysis:t,computation:i,view:n,messages:s,isDecoration:r}=e;this.analysis=t,this.computation=i,this.view=n,this._messages=s;const a=e.visible,o={view:n,attached:a,isDecoration:r},{fontSize:l,textColor:d,textBackgroundColor:u}=t.style;this._visualElements=new At({marker:new Tt(o,e.markerMaterial),dimension:new Ke.r(o,e.dimensionLineMaterial),startOffset:new Ke.r(o,e.offsetLineMaterial),endOffset:new Ke.r(o,e.offsetLineMaterial),dimensionSmall:new Ke.r(o,e.smallDimensionLineMaterial),startOffsetSmall:new Ke.r(o,e.smallOffsetLineMaterial),endOffsetSmall:new Ke.r(o,e.smallOffsetLineMaterial),label:new yt.K({view:n,attached:a,distance:0,geometry:{type:"segment",sampleLocation:"center",segment:this._labelSegment,callout:!1},fontSize:(0,ee.F2)(l),textColor:d.clone(),backgroundColor:u.clone(),isDecoration:r})}),this._handles.add([(0,c.watch)((()=>i.geometry),(e=>{this.updateCameraDependentElements(n.state.camera,e,t.style),null!=i.geometry&&this._updateLines(i.geometry)}),{...c.initial,equals:Be.fS}),(0,c.watch)((()=>i.length),(e=>this._updateLabelContent(e)),c.initial)])}destroy(){this.destroyed=!0,this._handles=(0,l.SC)(this._handles);for(const e of this._visualElements.values())e.destroy()}get testInfo(){}_updateLines(e){const t=I(Ot,n.Start,e.directSegment,e.dimensionSegment),i=I(Dt,n.End,e.directSegment,e.dimensionSegment),s=this._visualElements;s.marker.setGeometryFromSegment(e.dimensionSegment,e.primaryOffsetAxis),s.dimension.setGeometryFromSegment(e.dimensionSegment),s.startOffset.setGeometryFromSegment(t),s.endOffset.setGeometryFromSegment(i),s.dimensionSmall.setGeometryFromSegment(e.dimensionSegment),s.startOffsetSmall.setGeometryFromSegment(t),s.endOffsetSmall.setGeometryFromSegment(i)}updateCameraDependentElements(e,t,i){const n=this._visualElements;if(null==t){for(const e of n.values())e.visible=!1;return}const s=e.computeScreenPixelSizeAt(t.dimensionSegment.eval(.5,Rt)),r=function(e,t){return(0,S.k)(F(B,e))/t**2}(t,s),a=r<(2*(0,ee.F2)(i.lineSize))**2,o=!a;n.marker.visible=o,n.dimension.visible=o,n.startOffset.visible=o,n.endOffset.visible=o,n.dimensionSmall.visible=a,n.startOffsetSmall.visible=a,n.endOffsetSmall.visible=a;const l=5*(0,ee.F2)(i.fontSize),{label:c}=n;if(c.visible=r>=l**2,!c.visible)return;const{dimensionSegment:d,primaryOffsetAxis:u}=t,{offset:p}=this.computation.dimension,h=(Math.sign(p)>=0?1:-1)*function(e){return 1.5*(0,ee.F2)(e.fontSize)+20+(0,ee.F2)(e.lineSize/2)}(i)*s;(function(e,t,i,n){(0,S.b)(e.startRenderSpace,t.startRenderSpace,i,n),(0,S.b)(e.endRenderSpace,t.endRenderSpace,i,n)})(this._labelSegment,d,u,h),c.updateLabelPosition()}updateLabelStyle(e){const{label:t}=this._visualElements;t.fontSize=(0,ee.F2)(e.fontSize),t.textColor=e.textColor,t.backgroundColor=e.textBackgroundColor}updateUnitsMessages(e){this._messages=e;const{length:t}=this.computation;this._updateLabelContent(t)}_updateLabelContent(e){const{label:t}=this._visualElements;null!=e&&null!=this._messages?t.text=(0,gt.VG)(this._messages,e,e.unit):t.text=""}}const Ot=new M.y,Dt=new M.y,Rt=(0,w.Ue)();class At{constructor(e){this.marker=e.marker,this.dimension=e.dimension,this.startOffset=e.startOffset,this.endOffset=e.endOffset,this.dimensionSmall=e.dimensionSmall,this.startOffsetSmall=e.startOffsetSmall,this.endOffsetSmall=e.endOffsetSmall,this.label=e.label}values(){return[this.marker,this.dimension,this.startOffset,this.endOffset,this.dimensionSmall,this.startOffsetSmall,this.endOffsetSmall,this.label]}}var xt=i(60997),Et=i(8108),It=i(60720);let zt=class extends r.Z{get analysis(){return this.analysisViewData.analysis}get visible(){return this.analysisViewData.visible}constructor(e){super(e),this.loadingMessages=!1,this._messages=null}initialize(){const e=this.isDecoration;this._markerMaterial=new bt.X({width:1,anchor:xt.i5.Tip,color:te.AG,placement:"begin-end",worldSpace:!0,hideOnShortSegments:!0,hasTip:!0,renderOccluded:me.yD.OccludeAndTransparent,markerPrimitive:"triangle",isDecoration:e}),this._dimensionLineMaterial=new ve.U({width:1,color:te.AG,renderOccluded:me.yD.OccludeAndTransparent,markerParameters:this._markerMaterial.parameters,isDecoration:e}),this._offsetLineMaterial=new ve.U({width:1,color:te.AG,renderOccluded:me.yD.OccludeAndTransparent,stipplePattern:(0,tt.z5)(5),isDecoration:e}),this._smallDimensionLineMaterial=new ve.U({width:1,color:te.AG,renderOccluded:me.yD.OccludeAndTransparent,isDecoration:e}),this._smallOffsetLineMaterial=new ve.U({width:1,color:te.AG,renderOccluded:me.yD.OccludeAndTransparent,stipplePattern:(0,tt.z5)(5),isDecoration:e});for(const e of this._lineMaterials())this.view._stage.add(e),this.addHandles((0,a.kB)((()=>{this.view._stage?.remove(e)})));const t=(0,c.mapCollection)((()=>this.analysisViewData.computations),(({computation:e})=>this._createVisualization(e)));this._dimensionVisualizations=t,this.addHandles([(0,a.ed)(t),(0,c.watch)((()=>J.Z.toUnitRGBA(this.analysis.style.color)),(e=>{for(const t of this._lineMaterials())t.setParameters({color:e})}),c.syncAndInitial),(0,c.watch)((()=>this.analysis.style.lineSize),(e=>{const t=(0,ee.F2)(e);this._markerMaterial.setParameters({width:.8*t}),this._dimensionLineMaterial.setParameters({width:t,markerParameters:this._markerMaterial.parameters});const i=Math.max(.25*t,1);this._offsetLineMaterial.setParameters({width:i})}),c.syncAndInitial),(0,c.watch)((()=>({camera:this.view.state.camera,style:Ut(this.analysis)})),(({camera:e,style:t})=>{for(const{visualization:i}of this._dimensionVisualizations)i.updateCameraDependentElements(e,i.computation.geometry,t),i.updateLabelStyle(t)})),(0,c.watch)((()=>this.visible),(e=>{for(const{visualization:t}of this._dimensionVisualizations)t.visible=e}))]),this.addHandles([(0,Et.qe)((()=>this._updateMessageBundle())),(0,c.when)((()=>!this.loadingMessages),(()=>{for(const{visualization:e}of this._dimensionVisualizations)e.updateUnitsMessages(this._messages)}),c.sync)]),this._updateMessageBundle()}get testInfo(){}_createVisualization(e){const t=new Mt({analysis:this.analysis,computation:e,view:this.view,visible:this.visible,markerMaterial:this._markerMaterial,dimensionLineMaterial:this._dimensionLineMaterial,offsetLineMaterial:this._offsetLineMaterial,smallDimensionLineMaterial:this._smallDimensionLineMaterial,smallOffsetLineMaterial:this._smallOffsetLineMaterial,messages:this._messages,isDecoration:this.isDecoration});return{visualization:t,remove:()=>t.destroy()}}_lineMaterials(){return[this._markerMaterial,this._dimensionLineMaterial,this._offsetLineMaterial,this._smallDimensionLineMaterial,this._smallOffsetLineMaterial]}async _updateMessageBundle(){this.loadingMessages=!0;try{this._messages=await(0,It.ME)("esri/core/t9n/Units")}finally{this.loadingMessages=!1}}};function Ut(e){const{fontSize:t,lineSize:i,textColor:n,textBackgroundColor:s}=e.style;return{fontSize:t,lineSize:i,textBackgroundColor:s.clone(),textColor:n.clone()}}(0,s._)([(0,d.Cb)({constructOnly:!0})],zt.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],zt.prototype,"view",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],zt.prototype,"isDecoration",void 0),(0,s._)([(0,d.Cb)()],zt.prototype,"analysis",null),(0,s._)([(0,d.Cb)()],zt.prototype,"visible",null),(0,s._)([(0,d.Cb)()],zt.prototype,"loadingMessages",void 0),zt=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.DimensionVisualization")],zt);let Ht=class extends r.Z{constructor(e){super(e),this.dimension=null,this.length=null}};(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Ht.prototype,"dimension",void 0),(0,s._)([(0,d.Cb)()],Ht.prototype,"length",void 0),Ht=(0,s._)([(0,u.j)("esri.views.analysis.LengthDimensionResult")],Ht);const kt=Ht;let Gt=class extends r.Z{constructor(e){super(e),this.geometry=null,this.unconstrainedGeometry=null,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}normalizeCtorArgs(e){const{dimension:t,...i}=e;return{result:new kt({dimension:t}),...i}}initialize(){this.addHandles([(0,c.watch)((()=>this.dimension.startPoint),(e=>this.elevationAlignedStartPoint=this.projectAndAlignPoint(e)),c.syncAndInitial),(0,c.watch)((()=>this.dimension.endPoint),(e=>this.elevationAlignedEndPoint=this.projectAndAlignPoint(e)),c.syncAndInitial)])}get dimension(){return this.result.dimension}get length(){return this.result.length}};(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Gt.prototype,"result",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Gt.prototype,"projectAndAlignPoint",void 0),(0,s._)([(0,d.Cb)()],Gt.prototype,"dimension",null),(0,s._)([(0,d.Cb)()],Gt.prototype,"length",null),(0,s._)([(0,d.Cb)()],Gt.prototype,"geometry",void 0),(0,s._)([(0,d.Cb)()],Gt.prototype,"unconstrainedGeometry",void 0),(0,s._)([(0,d.Cb)()],Gt.prototype,"elevationAlignedStartPoint",void 0),(0,s._)([(0,d.Cb)()],Gt.prototype,"elevationAlignedEndPoint",void 0),(0,s._)([(0,d.Cb)()],Gt.prototype,"preConstraintProperties",void 0),(0,s._)([(0,d.Cb)()],Gt.prototype,"previousConstraint",void 0),Gt=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.LengthDimensionComputation")],Gt);var Lt=i(28376),Vt=i(76497),jt=i(41831);const Nt=e=>{let t=class extends e{constructor(...e){super(...e),this.analysis=null,this.tool=null,this.selectedDimension=null,this.interactive=!1,this.visible=null}get results(){return new jt.Z}createLengthDimensions(e){throw new Error("Method not implemented.")}};return(0,s._)([(0,d.Cb)({constructOnly:!0})],t.prototype,"view",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],t.prototype,"analysis",void 0),(0,s._)([(0,d.Cb)()],t.prototype,"tool",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],t.prototype,"results",null),(0,s._)([(0,d.Cb)()],t.prototype,"selectedDimension",void 0),(0,s._)([(0,d.Cb)()],t.prototype,"interactive",void 0),(0,s._)([(0,d.Cb)()],t.prototype,"visible",void 0),t=(0,s._)([(0,u.j)("esri.views.analysis.DimensionAnalysisView")],t),t};let Wt=class extends(Nt((0,p.p)(r.Z))){constructor(e){super(e),this.type="dimension-view-3d",this.tool=null,this.selectedDimension=null,this._dimensionsToComputations=new Map,this._placementTask=null,this._projectAndAlignPoint=null}initialize(){this._projectAndAlignPoint=e=>{if(null==e)return null;const{spatialReference:t,elevationProvider:i}=this.view,n=(0,Lt.G)(e,t,i);return null==n&&(0,Lt.e)(this.analysis,e.spatialReference,o.Z.getLogger(this)),n};const e=(0,c.mapCollection)((()=>this.analysis.dimensions),(e=>this._createComputation(e)));this.computations=e,this.addHandles([(0,Vt.Lp)(this,vt),(0,a.ed)(e)]),this._analysisVisualization=new zt({analysisViewData:this,view:this.view,isDecoration:!this.parent}),this._analysisController=new Y({analysisViewData:this,view:this.view})}destroy(){this._placementTask=(0,l.IM)(this._placementTask),this._analysisVisualization=(0,l.SC)(this._analysisVisualization),(0,Vt.Yq)(this)}get updating(){return this._analysisVisualization?.loadingMessages??!1}get results(){return this.analysis.dimensions.map((e=>this._dimensionsToComputations.get(e).result))}get selectedComputation(){const{selectedDimension:e}=this;return null==e?null:this._dimensionsToComputations.get(e)}get testInfo(){}async createLengthDimensions(e){return this.selectedDimension=null,this._placementTask=(0,l.IM)(this._placementTask),this._placementTask=(0,Vt.Er)(this,e),this._placementTask.promise}_createComputation(e){const{_dimensionsToComputations:t}=this,i=new Gt({dimension:e,projectAndAlignPoint:this._projectAndAlignPoint});return t.set(e,i),{computation:i,remove:()=>this._removeComputation(i)}}_removeComputation(e){const{dimension:t}=e;t===this.selectedDimension&&(this.selectedDimension=null),this._dimensionsToComputations.delete(t),e.destroy()}};(0,s._)([(0,d.Cb)({readOnly:!0})],Wt.prototype,"type",void 0),(0,s._)([(0,d.Cb)()],Wt.prototype,"tool",void 0),(0,s._)([(0,d.Cb)()],Wt.prototype,"updating",null),(0,s._)([(0,d.Cb)({readOnly:!0})],Wt.prototype,"results",null),(0,s._)([(0,d.Cb)()],Wt.prototype,"computations",void 0),(0,s._)([(0,d.Cb)()],Wt.prototype,"selectedDimension",void 0),(0,s._)([(0,d.Cb)()],Wt.prototype,"selectedComputation",null),(0,s._)([(0,d.Cb)()],Wt.prototype,"_analysisVisualization",void 0),(0,s._)([(0,d.Cb)()],Wt.prototype,"_analysisController",void 0),(0,s._)([(0,d.Cb)()],Wt.prototype,"_dimensionsToComputations",void 0),(0,s._)([(0,d.Cb)()],Wt.prototype,"_placementTask",void 0),Wt=(0,s._)([(0,u.j)("esri.views.3d.analysis.DimensionAnalysisView3D")],Wt);const Ft=Wt},468:(e,t,i)=>{i.d(t,{i:()=>y});var n=i(36663),s=i(74396),r=i(86618),a=i(81977),o=(i(39994),i(13802),i(4157),i(40266)),l=i(43977),c=i(79341),d=i(53448);class u{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.eZ.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=this._resources?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new p({view:this._resourceFactory.view,renderGroup:this._renderGroup}),i=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new p({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},i&&(this._resources.drapeSourceRenderer=i.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!0))}}let p=class extends(r.Z.IdentifiableMixin(s.Z)){constructor(e){super(e),this.drapeSourceType=l.Lw.Features,this.updatePolicy=d.j.SYNC,this.renderGroup=l.eZ.Outline}};(0,n._)([(0,a.Cb)({constructOnly:!0})],p.prototype,"view",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],p.prototype,"drapeSourceType",void 0),(0,n._)([(0,a.Cb)()],p.prototype,"renderGroup",void 0),p=(0,n._)([(0,o.j)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],p);var h=i(76169),m=i(76868),_=i(95399),f=i(49394),v=i(26982);class g{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const t=this._resources.object;this._resources.external.forEach((t=>{t.type!==_.U.Mesh&&t.type!==_.U.Line&&t.type!==_.U.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((t=>{t.type!==_.U.Mesh&&t.type!==_.U.Line&&t.type!==_.U.Point||e.add(t)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,i=t._stage;if(!i)return;const n=new v.F(i,{pickable:!1,updatePolicy:d.j.SYNC}),s=new f.T({castShadow:!1}),r=e.createResources(s,n);r.forEach((e=>{i.add(e),e.type===_.U.Texture&&e.load(i.renderView.renderingContext)})),i.add(s),n.add(s);const a=e.cameraChanged,o=a?(0,m.watch)((()=>t.state.camera),(e=>a(e)),m.initial):null;this._resources={layer:n,object:s,external:r,cameraHandle:o},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((t=>{e.remove(t),t.type===_.U.Texture&&t.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class y extends h.l{constructor(e){super(e),this._isDraped=!1,this.object3dResources=new g(this.createObject3DResourceFactory(e.view)),this.drapedResources=new u(this.createDrapedResourceFactory(e.view)),this.isDraped=e.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},56885:(e,t,i)=>{i.d(t,{V:()=>y,n:()=>C});i(39994);var n=i(86717),s=i(81095),r=i(56999),a=i(52721),o=i(70740),l=i(59934),c=i(56215),d=i(97537),u=i(468),p=i(54221),h=i(26646),m=i(6087),_=i(7358),f=i(13304),v=i(21414),g=i(65392);class y extends u.i{constructor(e){super(e),this._ray=(0,d.Ue)(),this._isWorldDown=!1,this._start=(0,s.Ue)(),this._end=(0,s.al)(1,0,0),this._width=1,this._color=(0,a.al)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,a.al)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=C.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=_.yD.OccludeAndTransparent,this._fadedExtensions=D,this._laserline=new p.W({view:this.view,isDecoration:e.isDecoration}),this.applyProperties(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:S,recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:S,recreateGeometry:e=>this._recreateDrapedGeometry(e)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,(0,n.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,n.d)(this._end,e,this._end),(0,d.zk)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(e){this._isWorldDown=!1,(0,n.p)(this._start,e)||((0,n.c)(this._start,e),(0,d.zk)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(e){this._isWorldDown=!1,(0,n.p)(this._end,e)||((0,n.c)(this._end,e),(0,d.zk)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,r.a)(e,this._color)||((0,r.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,r.a)(e,this._innerColor)||((0,r.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){null!=e&&null!=this._stippleOffColor&&(0,r.a)(e,this._stippleOffColor)||(this._stippleOffColor=null!=e?(0,a.d9)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===_.yD.OccludeAndTransparentStencil?_.yD.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=e??D,this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new g.U(this.materialParameters),i=new Array;return this._createObject3DGeometry(t,e,i),{material:t,geometries:i,forEach:e=>{e(t),i.forEach(e)}}}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,i){const n=this._createGeometry(e);i.push(n),t.addGeometry(n),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new g.U(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);return this._updateVerticesDraped(t),new f.z(t)}_createGeometry(e){const t=this.extensionType===C.FADED,i=t?[(0,s.Ue)(),(0,s.Ue)(),(0,s.Ue)(),(0,s.Ue)()]:[(0,s.Ue)(),(0,s.Ue)()];return(0,m.rh)(e,i,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===C.FADED?this._updateLineSegmentFinite(T):this._updateLineSegmentInfinite(this._extensionType,T)}_updateLineSegmentFinite(e){return(0,c.zk)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const i=this.view.state.camera;switch((0,o.iL)(this._ray,w),e){case C.LINE:w.c0=-Number.MAX_VALUE;break;case C.RAY:case C.GROUND_RAY:{const e=this._ray.origin,t=this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground")??0,i=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&i<t&&(0,n.v)(w.ray.direction,w.ray.direction),this._extensionType===C.GROUND_RAY&&null!=t&&(w.c1=Math.abs(i-t));break}}if(!(0,l.zq)(i.frustum,w))return this._updateLineSegmentFinite(t);const s=(0,o.Ws)(w,P),r=(0,o.S$)(w,b);return(0,c.zk)(s,r,t)}_updateVertexAttributesObject3D(e,t){const i=e.geometries[0].getMutableAttribute(v.T.POSITION)?.data;if(!i)return;let n=0;for(const e of this._lineVertices(t))i[n++]=e[0],i[n++]=e[1],i[n++]=e[2];e.geometryVertexAttributeUpdated(e.geometries[0],v.T.POSITION)}_updateVertexAttributesDraped(e,t){const i=e.getMutableAttribute(v.T.POSITION)?.data;if(!i)return;let n=0;for(const e of this._lineVertices(t))i[n++]=e[0],i[n++]=e[1],i[n++]=h.gi;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===C.FADED?(yield(0,c.KU)(e,-this.fadedExtensions.start,P),yield(0,c.KU)(e,0,P),yield(0,c.KU)(e,1,P),yield(0,c.KU)(e,1+this.fadedExtensions.end,P)):(yield(0,c.KU)(e,0,P),yield(0,c.KU)(e,1,P))}}function S(e){e.geometries=[]}const w=(0,o.Ue)(),P=(0,s.Ue)(),b=(0,s.Ue)(),T=(0,c.Ue)();var C,M;(M=C||(C={}))[M.LINE=0]="LINE",M[M.RAY=1]="RAY",M[M.GROUND_RAY=2]="GROUND_RAY",M[M.FADED=3]="FADED";const O=1/3,D={start:O,end:O}},85266:(e,t,i)=>{i.d(t,{IM:()=>o,W1:()=>a,lV:()=>l,wp:()=>r});var n=i(44685),s=i(21414);const r=(0,n.U$)().vec3f(s.T.POSITION),a=(0,n.U$)().vec3f(s.T.POSITION).vec2f(s.T.UV0),o=(0,n.U$)().vec3f(s.T.POSITION).vec4u8(s.T.COLOR),l=(0,n.U$)().vec3f(s.T.POSITION).vec2f(s.T.UV0).vec4u8(s.T.OBJECTANDLAYERIDCOLOR)},90834:(e,t,i)=>{i.d(t,{j:()=>A});var n=i(81936),s=i(35031),r=i(70984),a=i(80776),o=i(7358),l=i(12045),c=i(46378),d=i(15095),u=i(21414),p=i(79601),h=i(85266),m=i(10056),_=i(21123),f=i(9969),v=i(62575),g=i(97994),y=i(79040),S=i(6415),w=i(17346);class P extends v.A{constructor(e,t){super(e,t,new f.J(S.I,(()=>i.e(47204).then(i.bind(i,47204)))),b)}_getPipelineState(e,t){const{oitPass:i,output:n,hasOccludees:r,enableOffset:a,cullFace:o}=e,c=i===g.M.NONE,d=i===g.M.FrontFace;return(0,w.sm)({blending:(0,s.c1)(n)?c?w.xW:(0,l.j7)(i):null,culling:(0,w.zp)(o),depthTest:{func:(0,l.Bh)(i)},depthWrite:(0,l.W$)(e),drawBuffers:(0,l.u_)(i,n),colorWrite:w.gf,stencilWrite:r?y.s3:null,stencilTest:r?t?y.eD:y.RY:null,polygonOffset:c||d?null:(0,l.je)(a)})}initializePipeline(e){return this._occludeePipeline=this._getPipelineState(e,!0),this._getPipelineState(e,!1)}getPipeline(e){return e?this._occludeePipeline:super.getPipeline()}}const b=new Map([[u.T.POSITION,0],[u.T.UV0,2],[u.T.PERSPECTIVEDIVIDE,3]]);var T=i(36663),C=i(82082),M=i(57583),O=i(12907),D=i(22957);class R extends D.W{constructor(){super(...arguments),this.cullFace=r.Vr.None,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.perspectiveInterpolation=!0,this.textureCoordinateType=C.I.None,this.emissionSource=M.jo.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}}(0,T._)([(0,O.o)({count:r.Vr.COUNT})],R.prototype,"cullFace",void 0),(0,T._)([(0,O.o)()],R.prototype,"enableOffset",void 0),(0,T._)([(0,O.o)()],R.prototype,"writeDepth",void 0),(0,T._)([(0,O.o)()],R.prototype,"hasOccludees",void 0),(0,T._)([(0,O.o)()],R.prototype,"terrainDepthTest",void 0),(0,T._)([(0,O.o)()],R.prototype,"cullAboveTerrain",void 0),(0,T._)([(0,O.o)()],R.prototype,"perspectiveInterpolation",void 0);class A extends m.c{constructor(e){super(e,I),this._configuration=new R,this.vertexAttributeLocations=b,this.supportsEdges=!0,this.produces=new Map([[c.r.OPAQUE_MATERIAL,e=>(0,s.Gy)(e)],[c.r.TRANSPARENT_MATERIAL,e=>(0,s.D5)(e)&&this.parameters.writeDepth],[c.r.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>(0,s.D5)(e)&&!this.parameters.writeDepth],[c.r.DRAPED_MATERIAL,e=>(0,s.D5)(e)||(0,s.Gy)(e)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<l.ve,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}get visible(){return!0}createGLMaterial(e){return new x(e)}createBufferWriter(){const e=h.W1.clone();return this.parameters.perspectiveInterpolation&&e.f32(u.T.PERSPECTIVEDIVIDE),new E(e)}}class x extends a.Fj{constructor(e){super({...e,...e.material.parameters})}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.getTechnique(P,e)}}class E extends p.G{write(e,t,i,s,r,a){for(const s of this.vertexBufferLayout.fields.keys()){const o=i.get(s);if(o)if(s===u.T.PERSPECTIVEDIVIDE){(0,d.hu)(1===o.size);const e=r.getField(s,n.ly);e&&(0,_.XW)(o,e,a)}else(0,_.i9)(s,o,e,t,r,a)}}}class I extends o.Mt{constructor(e){super(),this.textureId=e,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=r.Vr.None,this.opacity=1,this.perspectiveInterpolation=!1}}},84982:(e,t,i)=>{i.d(t,{X:()=>T});var n=i(86717),s=i(81095),r=i(44685),a=i(35031),o=i(80776),l=i(7358),c=i(46378),d=i(21414),u=i(67874),p=i(9969),h=i(62575),m=i(12045),_=i(79040),f=i(25625),v=i(60997),g=i(91907),y=i(17346);class S extends h.A{constructor(e,t){super(e,t,new p.J(f.L,(()=>i.e(15465).then(i.bind(i,15465)))),w)}_makePipelineState(e,t){const{output:i,oitPass:n,space:s,hasOccludees:r}=e;return(0,y.sm)({blending:(0,a.c1)(i)?(0,m.Wo)(n):null,depthTest:s===v.I9.Draped?null:{func:(0,m.Bh)(n)},depthWrite:(0,m.W$)(e),drawBuffers:i===a.H_.Depth?{buffers:[g.Xg.NONE]}:(0,m.u_)(n,i),colorWrite:y.gf,stencilWrite:r?_.s3:null,stencilTest:r?t?_.eD:_.RY:null,polygonOffset:{factor:0,units:-10}})}initializePipeline(e){return e.occluder?(this._occluderPipelineTransparent=(0,y.sm)({blending:y.Dh,depthTest:_.zV,depthWrite:null,colorWrite:y.gf,stencilWrite:null,stencilTest:_.YD}),this._occluderPipelineOpaque=(0,y.sm)({blending:y.Dh,depthTest:_.zV,depthWrite:null,colorWrite:y.gf,stencilWrite:_.P7,stencilTest:_.ii}),this._occluderPipelineMaskWrite=(0,y.sm)({blending:null,depthTest:_.JN,depthWrite:null,colorWrite:null,stencilWrite:_.s3,stencilTest:_.eD})):this._occluderPipelineTransparent=this._occluderPipelineOpaque=this._occluderPipelineMaskWrite=null,this._occludeePipelineState=this._makePipelineState(e,!0),this._makePipelineState(e,!1)}getPipeline(e,t){return e?this._occludeePipelineState:t===c.r.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent??super.getPipeline():t===c.r.OCCLUDER_MATERIAL?this._occluderPipelineOpaque??super.getPipeline():this._occluderPipelineMaskWrite??super.getPipeline()}}const w=new Map([[d.T.POSITION,0],[d.T.PREVPOSITION,1],[d.T.UV0,2],[d.T.NORMAL,3],[d.T.COLOR,4],[d.T.COLORFEATUREATTRIBUTE,4],[d.T.SIZE,5],[d.T.SIZEFEATUREATTRIBUTE,5],[d.T.OPACITYFEATUREATTRIBUTE,6]]);var P=i(26531),b=i(5226);class T extends l.F5{constructor(e){super(e,M),this._configuration=new v.PI,this.vertexAttributeLocations=w,this.produces=new Map([[c.r.OPAQUE_MATERIAL,e=>e===a.H_.Highlight||(0,a.D5)(e)&&this.parameters.renderOccluded===l.yD.OccludeAndTransparentStencil],[c.r.OPAQUE_MATERIAL_WITHOUT_NORMALS,e=>(0,a.BX)(e)],[c.r.OCCLUDER_MATERIAL,e=>(0,a.Xo)(e)&&this.parameters.renderOccluded===l.yD.OccludeAndTransparentStencil],[c.r.TRANSPARENT_OCCLUDER_MATERIAL,e=>(0,a.Xo)(e)&&this.parameters.renderOccluded===l.yD.OccludeAndTransparentStencil],[c.r.TRANSPARENT_MATERIAL,e=>(0,a.D5)(e)&&this.parameters.writeDepth],[c.r.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>(0,a.D5)(e)&&!this.parameters.writeDepth],[c.r.DRAPED_MATERIAL,e=>(0,a.c1)(e)||e===a.H_.Highlight]]),this._layout=this.createLayout()}getConfiguration(e,t){return this._configuration.output=e,this._configuration.space=t.slot===c.r.DRAPED_MATERIAL?v.I9.Draped:this.parameters.worldSpace?v.I9.World:v.I9.Screen,this._configuration.hideOnShortSegments=this.parameters.hideOnShortSegments,this._configuration.hasCap=this.parameters.cap!==P.R.BUTT,this._configuration.anchor=this.parameters.anchor,this._configuration.hasTip=this.parameters.hasTip,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=t.hasOccludees,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvSize=!!this.parameters.vvSize,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.vvOpacity=!!this.parameters.vvOpacity,this._configuration.occluder=this.parameters.renderOccluded===l.yD.OccludeAndTransparentStencil,this._configuration.oitPass=t.oitPass,this._configuration.terrainDepthTest=t.terrainDepthTest&&(0,a.c1)(e),this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration}get visible(){return this.parameters.color[3]>=b.e}intersect(){}createLayout(){const e=(0,r.U$)().vec3f(d.T.POSITION).vec3f(d.T.PREVPOSITION).vec2f(d.T.UV0);return this.parameters.worldSpace&&e.vec3f(d.T.NORMAL),this.parameters.vvSize?e.f32(d.T.SIZEFEATUREATTRIBUTE):e.f32(d.T.SIZE),this.parameters.vvColor?e.f32(d.T.COLORFEATUREATTRIBUTE):e.vec4f(d.T.COLOR),this.parameters.vvOpacity&&e.f32(d.T.OPACITYFEATUREATTRIBUTE),e}createBufferWriter(){return new O(this._layout,this.parameters)}createGLMaterial(e){return new C(e)}}class C extends o.Fj{constructor(){super(...arguments),this._markerPrimitive=null}dispose(){super.dispose(),this._markerTextures.release(this._markerPrimitive),this._markerPrimitive=null}beginSlot(e){const t=this._material.parameters.markerPrimitive;return t!==this._markerPrimitive&&(this._material.setParameters({markerTexture:this._markerTextures.swap(t,this._markerPrimitive)}),this._markerPrimitive=t),this._material.setParameters(this.textureBindParameters),this.getTechnique(S,e)}}class M extends u.n{constructor(){super(...arguments),this.width=0,this.color=[1,1,1,1],this.markerPrimitive="arrow",this.placement="end",this.cap=P.R.BUTT,this.anchor=v.i5.Center,this.hasTip=!1,this.worldSpace=!1,this.hideOnShortSegments=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.markerTexture=null}}class O{constructor(e,t){this.vertexBufferLayout=e,this._parameters=t}elementCount(){return"begin-end"===this._parameters.placement?12:6}write(e,t,i,s,r,a){const o=i.get(d.T.POSITION).data,l=o.length/3;let c=[1,0,0];const u=i.get(d.T.NORMAL);this._parameters.worldSpace&&null!=u&&(c=u.data);let p=1,h=0;this._parameters.vvSize?h=i.get(d.T.SIZEFEATUREATTRIBUTE).data[0]:i.has(d.T.SIZE)&&(p=i.get(d.T.SIZE).data[0]);let m=[1,1,1,1],_=0;this._parameters.vvColor?_=i.get(d.T.COLORFEATUREATTRIBUTE).data[0]:i.has(d.T.COLOR)&&(m=i.get(d.T.COLOR).data);let f=0;this._parameters.vvOpacity&&(f=i.get(d.T.OPACITYFEATUREATTRIBUTE).data[0]);const v=new Float32Array(r.buffer);let g=a*(this.vertexBufferLayout.stride/4);const y=(e,t,i,n)=>{if(v[g++]=e[0],v[g++]=e[1],v[g++]=e[2],v[g++]=t[0],v[g++]=t[1],v[g++]=t[2],v[g++]=i[0],v[g++]=i[1],this._parameters.worldSpace&&(v[g++]=c[0],v[g++]=c[1],v[g++]=c[2]),this._parameters.vvSize?v[g++]=h:v[g++]=p,this._parameters.vvColor)v[g++]=_;else{const e=Math.min(4*n,m.length-4);v[g++]=m[e],v[g++]=m[e+1],v[g++]=m[e+2],v[g++]=m[e+3]}this._parameters.vvOpacity&&(v[g++]=f)};let S;var w;(w=S||(S={}))[w.ASCENDING=1]="ASCENDING",w[w.DESCENDING=-1]="DESCENDING";const P=(t,i)=>{const s=(0,n.i)(D,o[3*t],o[3*t+1],o[3*t+2]),r=R;let a=t+i;do{(0,n.i)(r,o[3*a],o[3*a+1],o[3*a+2]),a+=i}while((0,n.I)(s,r)&&a>=0&&a<l);e&&((0,n.t)(s,s,e),(0,n.t)(r,r,e)),y(s,r,[-1,-1],t),y(s,r,[1,-1],t),y(s,r,[1,1],t),y(s,r,[-1,-1],t),y(s,r,[1,1],t),y(s,r,[-1,1],t)},b=this._parameters.placement;"begin"!==b&&"begin-end"!==b||P(0,S.ASCENDING),"end"!==b&&"begin-end"!==b||P(l-1,S.DESCENDING)}}const D=(0,s.Ue)(),R=(0,s.Ue)()},76497:(e,t,i)=>{i.d(t,{Er:()=>o,Lp:()=>l,Yq:()=>c});var n=i(67979),s=i(61681),r=i(78668),a=i(76868);function o(e,t){e.interactive=!0;const{tool:i,view:o}=e;o.activeTool=i;let l=(0,r.fu)(t,(()=>{o.activeTool===i&&(o.activeTool=null)}));return(0,n.vr)((async e=>{await(0,a.whenOnce)((()=>null==i||!i.active),e),l=(0,s.hw)(l)}),t)}function l(e,t){return(0,a.watch)((()=>e.interactive),(()=>function(e,t){e.interactive?function(e,t){c(e);const{view:i,analysis:n}=e,s=new t({view:i,analysis:n,analysisViewData:e});e.tool=s,i.tools.add(s)}(e,t):c(e)}(e,t)),a.syncAndInitial)}function c(e){const{view:t,tool:i}=e;null!=i&&(t.tools.remove(i),e.tool=null)}},2523:(e,t,i)=>{i.d(t,{f:()=>o});var n=i(36663),s=i(76868),r=(i(13802),i(39994),i(4157),i(70375),i(40266)),a=i(68610);let o=class extends a.m{constructor(e){super(e)}initialize(){this.addHandles((0,s.watch)((()=>this.analysisViewData.visible),(e=>this.visible=e),s.syncAndInitial))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};o=(0,n._)([(0,r.j)("esri.views.interactive.AnalysisToolBase")],o)},77877:(e,t,i)=>{i.d(t,{w:()=>r});var n=i(8927),s=i(20757);function r(e){const t=(0,n.Z8)(e);return t.options.store=s.eC.MIN,t.options.excludeLabels=!0,t}},73080:(e,t,i)=>{i.d(t,{N:()=>n});class n{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.feature=e.feature,this.visualizer=e.visualizer,this.selfSnappingZ=e.selfSnappingZ,this.drawConstraints=e.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}},73464:(e,t,i)=>{i.d(t,{W:()=>p});var n=i(61681),s=i(78668),r=i(76868),a=i(41109),o=i(45043),l=i(83772),c=i(76478),d=i(73080),u=i(22167);function p({predicate:e=(()=>!0),snappingManager:t,snappingContext:i,updatingHandles:o,useZ:p=!0}){const v=new c.hM;if(null==t)return{snappingStep:[f,v],cancelSnapping:f};let g,y=null,S=null,w=null;const P=()=>{y=(0,n.IM)(y),t.doneSnapping(),S?.frameTask.remove(),S=null,g=(0,n.hw)(g),w=null},b=(T=t,C=p,M=v,(0,s.Ds)((async({frameTask:e,point:t,scenePoint:i,context:n,event:s,delta:r,getLastState:o},l)=>{const c=await e.schedule((()=>T.snap({point:t,scenePoint:i,context:n,signal:l})),l);if(c.valid){let i=await e.schedule((()=>c.apply()),l);const d=o();null!=d.point&&t!==d.point&&(i=T.update({point:d.point,scenePoint:d.scenePoint,context:n})),null!=d.updatePoint&&(0,a.kg)(i,d.updatePoint)||(_(s.mapEnd,i,r,C),M.execute(s))}})));var T,C,M;let O=null,D=null,R=null;return{snappingStep:[n=>{if(!e(n))return n;const{action:a}=n;if("start"===a){const{info:e}=n,s=function(e){return"3d"===e.type?e.resourceController.scheduler.registerTask(u.T8.SNAPPING):u.sq}(t.view);if(S=function(e,t,i){return{context:new d.N({editGeometryOperations:e.editGeometryOperations,elevationInfo:e.elevationInfo,pointer:e.pointer,vertexHandle:null!=t.info?t.info.handle:null,excludeFeature:e.excludeFeature,feature:e.feature,visualizer:e.visualizer}),originalPos:null!=t.snapOrigin?e.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:null!=t.scenePoints?t.scenePoints.sceneStart:null,frameTask:i}}(i,n,s),S.context.selfSnappingZ=null,!p&&null!=e){const t=function(e,t){if(!e.hasZ())return null;const i=t.vertices;let n=null;for(const t of i){const i=e.getZ(t.pos);if(null!=n&&null!=i&&Math.abs(i-n)>1e-6)return null;null==n&&(n=i)}return n}(i.coordinateHelper,e.handle.component);null!=t&&(S.context.selfSnappingZ={value:t,elevationInfo:i.elevationInfo??l.jG})}}if(null!=S){const{context:e,originalScenePos:i,originalPos:l}=S,{mapEnd:c,mapStart:d,scenePoints:u}=n,f=h(l,m(c,d)),v=m(d,l),P={...n,action:"update"},T=S.context,C=function(e,t){return null==e||null==t?null:h(e,m(t.sceneEnd,t.sceneStart))}(i,u),M=t.update({point:f,scenePoint:C,context:e});if(R=M,_(c,M,v,p),O=f,D=C,"end"!==a){const{frameTask:e}=S;null==y&&(y=new AbortController),w=t=>{o.addPromise((0,s.R8)(b({frameTask:e,event:P,context:T,point:f,scenePoint:C,delta:v,getLastState:()=>({point:O,scenePoint:D,updatePoint:t.forceUpdate?null:R})},y.signal)))},w({forceUpdate:!1}),null==g&&(g=(0,r.watch)((()=>t.options.effectiveEnabled),(()=>w?.({forceUpdate:!0}))))}}return"end"===a&&P(),n},v],cancelSnapping:e=>(P(),e)}}function h(e,[t,i,n]){const s=(0,o.WG)(e);return s.x+=t,s.y+=i,s.hasZ&&(s.z+=n),s}function m(e,t){const i=e.hasZ&&t.hasZ?e.z-t.z:0;return[e.x-t.x,e.y-t.y,i]}function _(e,t,[i,n,s],r){e.x=t.x+i,e.y=t.y+n,r&&e.hasZ&&t.hasZ&&(e.z=t.z+s)}function f(e){return e}},91084:(e,t,i)=>{i.d(t,{u:()=>p});var n=i(23148),s=i(66581),r=i(41831),a=i(76868),o=i(88878),l=i(50639),c=i(8593);var d=i(97682);const u=new Map;function p(e){if(!u.has(e)){const t=function(e,t){const i=new c.Z({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:t?.distance??l.c.distance,touchSensitivityMultiplier:t?.touchSensitivityMultiplier??l.c.touchSensitivityMultiplier});return{...(0,a.watch)((()=>e.map?.allLayers?.toArray()??[]),(e=>{i.featureSources=new r.Z(e).map((e=>new o.Z({layer:e})))}),a.syncAndInitial),options:i}}(e,{distance:10}),i=function(e,t){return new d.N({view:e,options:t})}(e,t.options);u.set(e,{referenceCount:0,snappingManager:i,remove:()=>{t.remove(),i.destroy()}})}const t=u.get(e);t.referenceCount++;const i=(0,n.kB)((()=>{return i=e,(n=t).referenceCount--,void(n.referenceCount>0||(0,s.Y)((()=>{0===n.referenceCount&&(n.remove(),u.delete(i))})));var i,n}));return{snappingManager:t.snappingManager,...i}}},98028:(e,t,i)=>{i.d(t,{y:()=>d});var n=i(36663),s=i(74396),r=i(61681),a=i(78668),o=i(81977),l=(i(39994),i(13802),i(4157),i(40266)),c=i(22167);let d=class extends s.Z{constructor(e){super(e),this.constrainResult=e=>e,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=(0,a.Ds)((async(e,t,i,n)=>{const s=this._frameTask;if(null==s)return;const r=await s.schedule((()=>t.snap({...e,context:i,signal:n})),n);r.valid&&await s.schedule((()=>{this.stagedPoint=r.apply(),e!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=t.update({...this._snapPoints,context:i}))}),n)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(e){this._stagedPoint=this.constrainResult(e)}initialize(){const e="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=e?e.registerTask(c.T8.SNAPPING):c.sq}destroy(){this._abortController=(0,r.IM)(this._abortController),this._frameTask=(0,r.hw)(this._frameTask)}update(e,t,i){this._snapPoints=e;const{point:n,scenePoint:s}=e,r=t.update({point:n,scenePoint:s,context:i});return this.stagedPoint=r,r}async snap(e,t,i){const{point:n,scenePoint:s}=e;return this.stagedPoint=t.update({point:n,scenePoint:s,context:i}),this._snapPoints=e,null==this._abortController&&(this._abortController=new AbortController),this._snap(e,t,i,this._abortController.signal)}async snapAgainNearPreviousMapPoint(e,t){null!=this._snapPoints&&await this.snap(this._snapPoints,e,t)}abort(){this._abortController=(0,r.IM)(this._abortController),this._snapPoints=null}};(0,n._)([(0,o.Cb)({constructOnly:!0})],d.prototype,"view",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"stagedPoint",null),(0,n._)([(0,o.Cb)()],d.prototype,"constrainResult",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"_stagedPoint",void 0),d=(0,n._)([(0,l.j)("esri.views.interactive.snapping.SnappingOperation")],d)},4371:(e,t,i)=>{i.d(t,{a:()=>c});var n=i(23148),s=i(59282),r=i(65453),a=i(23688),o=i(82366),l=i(31367);class c{draw(e,t){const i=function(e){const t=[];for(const i of e){let e=!0;for(const n of t)if(i.equals(n)){e=!1;break}e&&t.push(i)}return t}(e),c=this.sortUniqueHints(i),d=[];for(const e of c)e instanceof s.w&&d.push(this.visualizeIntersectionPoint(e,t)),e instanceof r.w&&d.push(this.visualizeLine(e,t)),e instanceof a.L&&d.push(this.visualizeParallelSign(e,t)),e instanceof l.y&&d.push(this.visualizeRightAngleQuad(e,t)),e instanceof o.n&&d.push(this.visualizePoint(e,t));return(0,n.AL)(d)}sortUniqueHints(e){return e}}},82366:(e,t,i)=>{i.d(t,{n:()=>r});var n=i(86717),s=i(9650);class r extends s.r{constructor(e,t,i){super(t,i),this.point=e}equals(e){return e instanceof r&&(0,n.p)(this.point,e.point)}}},54682:(e,t,i)=>{i.d(t,{C_:()=>a,Qw:()=>o,x:()=>l});var n=i(81095),s=i(92810),r=i(956);function a(e){return(0,r.kQ)(e)??(0,s.Sx)(e)}function o(e,t){return(0,r.RT)(e,t)??(0,s.xI)(e,t)}function l(e,t,i){return c[0]=e[0],c[1]=e[1],c[2]=3===e.length?e[2]:0,d[0]=t[0],d[1]=t[1],d[2]=3===t.length?t[2]:0,(0,r.FB)(c,d,i)??(0,s.qj)(c,d,i)}const c=(0,n.Ue)(),d=(0,n.Ue)()}}]);
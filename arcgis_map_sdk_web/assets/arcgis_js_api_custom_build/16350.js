"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[16350],{55431:(e,t,i)=>{i.d(t,{h:()=>s});i(7753),i(67134);var a=i(807),n=i(49684);i(96726),i(25242);function s(e,t,i){if(null==e?.timeInfo)return null;const{datesInUnknownTimezone:s=!1,timeOffset:r,useViewTime:l}=e;let d=e.timeExtent;s&&(d=function(e){if(!e)return e;const{start:t,end:i}=e;return new n.Z({start:null!=t?(0,a.Nm)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,a.Nm)(i,i.getTimezoneOffset(),"minutes"):i})}(d));let o=l?t&&d?t.intersection(d):t||d:d;return!o||o.isEmpty||o.isAllTime?o:(r&&(o=o.offset(-r.value,r.unit)),s&&(o=function(e){if(!e)return e;const{start:t,end:i}=e;return new n.Z({start:null!=t?(0,a.Nm)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,a.Nm)(i,-i.getTimezoneOffset(),"minutes"):i})}(o)),o.equals(i)?i:o)}},25242:(e,t,i)=>{i.d(t,{x:()=>a});const a=Symbol("WebScene")},84766:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var a=i(36663),n=i(78668),s=i(76868),r=i(81977),l=(i(39994),i(13802),i(4157),i(40266)),d=i(78306),o=i(29151);let u=class extends((0,o.Z)(d.Z)){constructor(){super(...arguments),this.type="imagery-3d",this.redrawDebounced=(0,n.Ds)((async e=>{this.redraw(((e,t)=>this._redrawImage(e,t)),e)}),2e3)}get highlightOptions(){return null}get pixelData(){return null}initialize(){this.addHandles([(0,s.when)((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on("redraw",(()=>this._updatingHandles.addPromise(this.redrawDebounced())))]),this._updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.layer?.renderer),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.timeExtent),(()=>this._updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,t,i){t.imageOrCanvasElement?e.image=t.imageOrCanvasElement:(e.image=document.createElement("canvas"),e.pixelData=t.pixelData,await this._redrawImage(e,i))}async _redrawImage(e,t){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const i=e.image,a=i.getContext("2d"),n=await this.layer.applyRenderer(e.pixelData,{signal:t}),s=this.layer.applyFilter(n).pixelBlock;if(null==s)throw new Error;i.width=s.width,i.height=s.height;const r=a.createImageData(s.width,s.height);r.data.set(s.getAsRGBA()),a.putImageData(r,0,0)}highlight(e){throw new Error("Not implemented")}};(0,a._)([(0,r.Cb)()],u.prototype,"highlightOptions",null),(0,a._)([(0,r.Cb)()],u.prototype,"pixelData",null),u=(0,a._)([(0,l.j)("esri.views.3d.layers.ImageryLayerView3D")],u);const h=u}}]);
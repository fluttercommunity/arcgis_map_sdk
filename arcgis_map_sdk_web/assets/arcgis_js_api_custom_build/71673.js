"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[71673],{71673:(t,e,n)=>{n.r(e),n.d(e,{getContrastingBackgroundTheme:()=>z,getRenderSymbolParameters:()=>k,previewSymbol2D:()=>S});var i=n(30936),a=n(39043),o=n(70375),l=n(69079),s=n(95550),h=n(7505),r=n(89298),c=n(83773),u=n(5840),p=n(63659);const m="picture-fill",d=c.b_.size,g=c.b_.maxSize,f=c.b_.maxOutlineSize,y=c.b_.lineWidth,w=document.createElement("canvas");function x(t,e,n){if("polygon"===t.type){const i=t.extent,a=0===i.width?1:i.width,o=0===i.height?1:i.height;t=(0,h.Kq)({originPosition:"upperLeft",scale:[a/e,o/n],translate:[i.xmin,i.ymax]},{},t);let l="";for(let e=0;e<t.rings.length;e++){const n=t.rings[e];for(let t=0;t<n.length;t++){const e=n[t][0],i=n[t][1];let a="";0===t?(a=`M${e.toString()} ${i.toString()}`,""!==l&&(a=` ${a}`),l+=a):t===n.length-1?(a=`l${e.toString()} ${i.toString()} Z`,""!==l&&(a=` ${a}`),l+=a):(a=`l${e.toString()} ${i.toString()}`,""!==l&&(a=` ${a}`),l+=a)}}return l}if("polyline"===t.type){const i=t.extent,a=0===i.width?1:i.width,o=0===i.height?1:i.height;t=(0,h.s9)({originPosition:"upperLeft",scale:[a/e,o/n],translate:[i.xmin,i.ymax]},{},t);let l="";for(let e=0;e<t.paths.length;e++){const n=t.paths[e];for(let t=0;t<n.length;t++){const e=n[t][0],i=n[t][1];let a="";0===t?(a=`M${e.toString()} ${i.toString()}`,""!==l&&(a=` ${a}`),l+=a):(a=`l${e.toString()} ${i.toString()}`,""!==l&&(a=` ${a}`),l+=a)}}return l}return""}function b(t,e){const n=w.getContext("2d"),i=[];e&&(e.weight&&i.push(e.weight),e.size&&i.push(e.size+"px"),e.family&&i.push(e.family)),n.font=i.join(" ");const{width:a,actualBoundingBoxLeft:o,actualBoundingBoxRight:l,actualBoundingBoxAscent:s,actualBoundingBoxDescent:h}=n.measureText(t);return{width:Math.ceil(Math.max(a,o+l)),height:Math.ceil(s+h),x:Math.floor(o),y:Math.floor((s-h)/2)}}function M(t){const e=t?.size;return{width:null!=e&&"object"==typeof e&&"width"in e?(0,s.F2)(e.width):null,height:null!=e&&"object"==typeof e&&"height"in e?(0,s.F2)(e.height):null}}function v(t,e){return t>e?"dark":"light"}function k(t,e){const n="number"==typeof e?.size?e?.size:null,i=null!=n?(0,s.F2)(n):null,a=null!=e?.maxSize?(0,s.F2)(e.maxSize):null;let o="angle"in t?t.angle:null;null!=e?.rotation&&(o=(o??0)+e.rotation);const l=(0,r._M)(t);let h=(0,r.mx)(t);"dark"!==z(t,245)||e?.ignoreWhiteSymbols||(h={width:.75,...h,color:"#bdc3c7"});let u=null;const p={shape:null,fill:l,stroke:h,offset:[0,0]};h?.width&&(h.width=Math.min(h.width,f));const w=h?.width||0;let v=null!=e?.size&&(null==e?.scale||e?.scale),k=0,S=0,L=!1;switch(t.type){case"simple-marker":{const n=t.style,{width:l,height:h}=M(e);let r=l===h&&null!=l?l:null!=i?i:Math.min((0,s.F2)(t.size),a||g);if(!0===e?.useMarkerSymbolSize&&null!==l&&null!==h){const e=Math.min((0,s.F2)(t.size),a||g);r=e>l&&e>h?Math.min(l,h):e}switch(k=r,S=r,n){case"circle":p.shape={type:"circle",cx:0,cy:0,r:.5*r},v||(k+=w,S+=w);break;case"cross":p.shape={type:"path",path:[{command:"M",values:[0,.5*S]},{command:"L",values:[k,.5*S]},{command:"M",values:[.5*k,0]},{command:"L",values:[.5*k,S]}]};break;case"diamond":p.shape={type:"path",path:[{command:"M",values:[0,.5*S]},{command:"L",values:[.5*k,0]},{command:"L",values:[k,.5*S]},{command:"L",values:[.5*k,S]},{command:"Z",values:[]}]},v||(k+=w,S+=w);break;case"square":p.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,0]},{command:"L",values:[k,S]},{command:"L",values:[0,S]},{command:"Z",values:[]}]},v||(k+=w,S+=w),o&&(L=!0);break;case"triangle":p.shape={type:"path",path:[{command:"M",values:[.5*k,0]},{command:"L",values:[k,S]},{command:"L",values:[0,S]},{command:"Z",values:[]}]},v||(k+=w,S+=w),o&&(L=!0);break;case"x":p.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,S]},{command:"M",values:[k,0]},{command:"L",values:[0,S]}]},o&&(L=!0);break;case"path":p.shape={type:"path",path:t.path||""},v||(k+=w,S+=w),o&&(L=!0),v=!0}break}case"simple-line":{const{width:t,height:n}=M(e),a=(0,r.iI)(h).reduce(((t,e)=>t+e),0),o=a&&Math.ceil(y/a),l=n??i??w,s=t??(a*o||y);if(v=!0,"polyline"===e?.geometry?.type&&e?.geometry?.extent){k=s,S=n??k;const t=1e3,i=.15*t;u=[k,S],S=u[0]>u[1]?t*u[1]/u[0]:t,k=u[0]>u[1]?t:t*u[0]/u[1],h?.width&&(h.width=h.width*t/(u[1]>u[0]?u[1]:u[0]),h.width>i&&(h.width=i)),p.shape={type:"path",path:x(e.geometry,k,S)}}else k=null!=e?.maxSize?Math.min(s,e.maxSize):s,S=l,h&&(h.width=l),p.shape={type:"path",path:[{command:"M",values:[l/2,S/2]},{command:"L",values:[k-l/2,S/2]}]};break}case m:case"simple-fill":{const t="object"==typeof e?.symbolConfig&&!!e?.symbolConfig?.isSquareFill,{width:n,height:a}=M(e);k=!t&&n!==a||null==n?null!=i?i:d:n,S=!t&&n!==a||null==a?k:a,v||(k+=w,S+=w),v=!0,e?.geometry?.extent&&"polygon"===e?.geometry?.type?(u=[k,S],S=u[0]>u[1]?1e3*u[1]/u[0]:1e3,k=u[0]>u[1]?1e3:1e3*u[0]/u[1],p.shape={type:"path",path:x(e.geometry,k,S)}):p.shape=t?{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,0]},{command:"L",values:[k,S]},{command:"L",values:[0,S]},{command:"L",values:[0,0]},{command:"Z",values:[]}]}:c.JZ.fill[0];break}case"picture-marker":{const n=Math.min((0,s.F2)(t.width),a||g),l=Math.min((0,s.F2)(t.height),a||g),{width:h,height:r}=M(e),c=h===r&&null!=h?h:null!=i?i:Math.max(n,l),u=t.width/t.height;k=u<=1?Math.ceil(c*u):c,S=u<=1?c:Math.ceil(c/u),p.shape={type:"image",x:-Math.round(k/2),y:-Math.round(S/2),width:k,height:S,src:t.url||""},o&&(L=!0);break}case"text":{const n=t,o=e?.overrideText||n.text||"Aa",l=n.font,{width:h,height:r}=M(e),c=null!=r?r:null!=i?i:Math.min((0,s.F2)(l.size),a||g),{width:u,height:m}=b(o,{weight:l.weight,size:c,family:l.family}),d=/[\uE600-\uE6FF]/.test(o);k=h??(d?c:u),S=d?c:m;let f=.5*(d?c:m);d&&(f+=5),p.shape={type:"text",text:o,x:n.xoffset||0,y:n.yoffset||f,align:"middle",alignBaseline:n.verticalAlignment,decoration:l&&l.decoration,rotated:n.rotated,kerning:n.kerning},p.font=l&&{size:c,style:l.style,decoration:l.decoration,weight:l.weight,family:l.family};break}}return{shapeDescriptor:p,size:[k,S],outputSize:u,renderOptions:{node:e?.node,scale:v,opacity:e?.opacity,rotations:[o],useRotationSize:L,effectView:e?.effectView,ariaLabel:e?.ariaLabel}}}async function S(t,e){const{shapeDescriptor:n,size:i,renderOptions:a,outputSize:h}=k(t,e);if(!n.shape)throw new o.Z("symbolPreview: renderPreviewHTML2D","symbol not supported.");await async function(t,e){const n=e.fill,i=t.color;if("pattern"===n?.type&&i&&t.type!==m){const t=await(0,r.Od)(n.src,i.toCss(!0));n.src=t,e.fill=n}}(t,n),await async function(t,e,n,i){if(!("font"in t)||!t.font||"text"!==e.shape.type)return;try{await(0,l.mx)(t.font)}catch{}const{width:a,height:o}=M(i);if(!/[\uE600-\uE6FF]/.test(e.shape.text)){const{width:l,height:s,x:h,y:r}=b(e.shape.text,{weight:e.font?.weight,size:e.font?.size,family:e.font?.family});n[0]=a??l,n[1]=o??s,e.shape.x=h,e.shape.y=r;let c="angle"in t?t.angle:null;if(null!=i?.rotation&&(c=(c??0)+i.rotation),c){const t=c*(Math.PI/180),e=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t));n[1]=n[0]*e+n[1]*i}}}(t,n,i,e);const d=[[n]];if("object"==typeof e?.symbolConfig&&e?.symbolConfig?.applyColorModulation){const t=.6*i[0];d.unshift([{...n,offset:[-t,0],fill:(0,c.dc)(n.fill,-.3)}]),d.push([{...n,offset:[t,0],fill:(0,c.dc)(n.fill,.3)}]),i[0]+=2*t,a.scale=!1}"text"===t.type&&function(t,e,n,i,a){if(null!=t.haloColor&&null!=t.haloSize){a.masking??=n.map((()=>[]));const o=(0,s.F2)(t.haloSize);i[0]+=o,i[1]+=o,n.unshift([{...e,fill:null,stroke:{color:t.haloColor,width:2*o,join:"round",cap:"round"}}]),a.masking.unshift([{shape:{type:"rect",x:0,y:0,width:i[0]+2*p.c9,height:i[1]+2*p.c9},fill:[255,255,255],stroke:null},{...e,fill:[0,0,0,0],stroke:null}])}null==t.backgroundColor&&null==t.borderLineColor||(i[0]+=2*p.c9,i[1]+=2*p.c9,n.unshift([{shape:{type:"rect",x:0,y:0,width:i[0],height:i[1]},fill:t.backgroundColor,stroke:{color:t.borderLineColor,width:(0,s.F2)(t.borderLineSize)}}]),a.masking?.unshift([]))}(t,n,d,i,a);const g=(0,u.wh)(d,i,a);if(h&&g){const t="img"===g.nodeName.toLowerCase()?g:g.firstChild;"svg"===t.nodeName.toLowerCase()&&t.setAttribute("viewBox",`0 0 ${i[0].toString()} ${i[1].toString()}`),t.setAttribute("width",h[0].toString()),t.setAttribute("height",h[1].toString()),h.length>2&&(t.style.setProperty("padding-left",h[2]?.toString()+"px"),t.style.setProperty("padding-right",h[2]?.toString()+"px"),t.style.setProperty("padding-top",h[3]?.toString()+"px"),t.style.setProperty("padding-bottom",h[3]?.toString()+"px"),t.style.setProperty("box-sizing","border-box"))}return g}function z(t,e=225){const n=(0,r._M)(t),o=(0,r.mx)(t),l=!n||"type"in n?null:new i.Z(n),s=o?.color?new i.Z(o?.color):null,h=l?v((0,a.EX)(l),e):null,c=s?v((0,a.EX)(s),e):null;return c?h?h===c?h:e>=225?"light":"dark":c:h}}}]);